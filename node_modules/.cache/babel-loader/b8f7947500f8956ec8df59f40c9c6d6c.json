{"ast":null,"code":"import Config from'../Config';// import { get_UDid } from '../ALL_localstorage'\n// import { servicesVersion } from 'typescript';\nexport var serverRequest={clientServiceRequest:clientServiceRequest};var API_URL=Config.key.OP_API_URL;//const API_URL ='https://dev1.app.olivertest.com/api/';\nfunction clientServiceRequest(requestType,requestUrl,postParameter){var version=arguments.length>3&&arguments[3]!==undefined?arguments[3]:1;try{//console.log(\"postParameter\",postParameter)\nif(requestType=='POST'){var requestOptions={method:requestType,headers:{\"access-control-allow-origin\":\"*\",\"access-control-allow-credentials\":\"true\",'Accept':'application/json','Content-Type':'application/json','Authorization':'Basic '+btoa(sessionStorage.getItem(\"AUTH_KEY\"))},mode:'cors',body:JSON.stringify(postParameter)};}if(requestType=='GET'){var requestOptions={method:requestType,headers:{\"access-control-allow-origin\":\"*\",\"access-control-allow-credentials\":\"true\",'Accept':'application/json','Content-Type':'application/json','Authorization':'Basic '+btoa(sessionStorage.getItem(\"AUTH_KEY\"))},mode:'cors'};}if(localStorage.getItem('demoUser')=='true'&&localStorage.getItem('DemoGuid')){requestOptions.headers['demoauth']=localStorage.getItem('DemoGuid')&&localStorage.getItem('DemoGuid');}return fetch(\"\".concat(API_URL,\"v\").concat(version).concat(requestUrl),requestOptions).then(handleResponse).then(function(servericeResponse){// console.log('--------common-service-Res--', servericeResponse);\nreturn servericeResponse;});}catch(error){return error.message;}}function handleResponse(response){return response.text().then(function(text){var data=text&&JSON.parse(text);if(!response.ok){if(response.status===401){// auto logout if 401 response returned from api\n// logout();\n// location.reload(true);\n}var error=data&&data.message||response.statusText;return Promise.reject(error);}return data;});}function logout(){// remove user from local storage to log user out\nlocalStorage.removeItem('user');}","map":{"version":3,"names":["Config","serverRequest","clientServiceRequest","API_URL","key","OP_API_URL","requestType","requestUrl","postParameter","version","requestOptions","method","headers","btoa","sessionStorage","getItem","mode","body","JSON","stringify","localStorage","fetch","then","handleResponse","servericeResponse","error","message","response","text","data","parse","ok","status","statusText","Promise","reject","logout","removeItem"],"sources":["D:/OliverPOS/OliverPOS3.0/src/CommonServiceRequest/serverRequest.js"],"sourcesContent":["import Config from '../Config'\r\n// import { get_UDid } from '../ALL_localstorage'\r\n// import { servicesVersion } from 'typescript';\r\n\r\nexport const serverRequest = {\r\n    clientServiceRequest\r\n};\r\n\r\nconst API_URL = Config.key.OP_API_URL\r\n\r\n//const API_URL ='https://dev1.app.olivertest.com/api/';\r\nfunction clientServiceRequest(requestType, requestUrl, postParameter,version=1) {\r\ntry {\r\n    \r\n    //console.log(\"postParameter\",postParameter)\r\n    if (requestType == 'POST') {\r\n        var requestOptions = {\r\n            method: requestType,\r\n            headers: {\r\n                \"access-control-allow-origin\": \"*\",\r\n                \"access-control-allow-credentials\": \"true\",\r\n                'Accept': 'application/json',\r\n                'Content-Type': 'application/json',\r\n                'Authorization': 'Basic ' + btoa(sessionStorage.getItem(\"AUTH_KEY\")),\r\n            }\r\n            , mode: 'cors',\r\n            body: JSON.stringify(postParameter)\r\n        };\r\n    }\r\n    if (requestType == 'GET') {\r\n        var requestOptions = {\r\n            method: requestType,\r\n            headers: {\r\n                \"access-control-allow-origin\": \"*\",\r\n                \"access-control-allow-credentials\": \"true\",\r\n                'Accept': 'application/json',\r\n                'Content-Type': 'application/json',\r\n                'Authorization': 'Basic ' + btoa(sessionStorage.getItem(\"AUTH_KEY\")),\r\n            }\r\n            , mode: 'cors',\r\n        };\r\n    }\r\n    if (localStorage.getItem('demoUser') == 'true' && localStorage.getItem('DemoGuid')) {\r\n        requestOptions.headers['demoauth'] = localStorage.getItem('DemoGuid') && localStorage.getItem('DemoGuid')\r\n    }\r\n    \r\n    return  fetch(`${API_URL}v${version}${requestUrl}`, requestOptions).then(handleResponse)\r\n        .then(servericeResponse => {\r\n           // console.log('--------common-service-Res--', servericeResponse);\r\n            return servericeResponse;\r\n        })\r\n\r\n    } catch (error) {\r\n    return error.message;\r\n    }\r\n}\r\nfunction handleResponse(response) {\r\n    return response.text().then(text => {\r\n        const data = text && JSON.parse(text);\r\n        if (!response.ok) {\r\n            if (response.status === 401) {\r\n                // auto logout if 401 response returned from api\r\n                // logout();\r\n               // location.reload(true);\r\n            }\r\n            const error = (data && data.message) || response.statusText;\r\n            return Promise.reject(error);\r\n        }\r\n        return data;\r\n    });\r\n}\r\n\r\nfunction logout() {\r\n    // remove user from local storage to log user out\r\n    localStorage.removeItem('user');\r\n}\r\n"],"mappings":"AAAA,MAAOA,OAAP,KAAmB,WAAnB,CACA;AACA;AAEA,MAAO,IAAMC,cAAa,CAAG,CACzBC,oBAAoB,CAApBA,oBADyB,CAAtB,CAIP,GAAMC,QAAO,CAAGH,MAAM,CAACI,GAAP,CAAWC,UAA3B,CAEA;AACA,QAASH,qBAAT,CAA8BI,WAA9B,CAA2CC,UAA3C,CAAuDC,aAAvD,CAAgF,IAAXC,QAAW,2DAAH,CAAG,CAChF,GAAI,CAEA;AACA,GAAIH,WAAW,EAAI,MAAnB,CAA2B,CACvB,GAAII,eAAc,CAAG,CACjBC,MAAM,CAAEL,WADS,CAEjBM,OAAO,CAAE,CACL,8BAA+B,GAD1B,CAEL,mCAAoC,MAF/B,CAGL,SAAU,kBAHL,CAIL,eAAgB,kBAJX,CAKL,gBAAiB,SAAWC,IAAI,CAACC,cAAc,CAACC,OAAf,CAAuB,UAAvB,CAAD,CAL3B,CAFQ,CASfC,IAAI,CAAE,MATS,CAUjBC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAeX,aAAf,CAVW,CAArB,CAYH,CACD,GAAIF,WAAW,EAAI,KAAnB,CAA0B,CACtB,GAAII,eAAc,CAAG,CACjBC,MAAM,CAAEL,WADS,CAEjBM,OAAO,CAAE,CACL,8BAA+B,GAD1B,CAEL,mCAAoC,MAF/B,CAGL,SAAU,kBAHL,CAIL,eAAgB,kBAJX,CAKL,gBAAiB,SAAWC,IAAI,CAACC,cAAc,CAACC,OAAf,CAAuB,UAAvB,CAAD,CAL3B,CAFQ,CASfC,IAAI,CAAE,MATS,CAArB,CAWH,CACD,GAAII,YAAY,CAACL,OAAb,CAAqB,UAArB,GAAoC,MAApC,EAA8CK,YAAY,CAACL,OAAb,CAAqB,UAArB,CAAlD,CAAoF,CAChFL,cAAc,CAACE,OAAf,CAAuB,UAAvB,EAAqCQ,YAAY,CAACL,OAAb,CAAqB,UAArB,GAAoCK,YAAY,CAACL,OAAb,CAAqB,UAArB,CAAzE,CACH,CAED,MAAQM,MAAK,WAAIlB,OAAJ,aAAeM,OAAf,SAAyBF,UAAzB,EAAuCG,cAAvC,CAAL,CAA4DY,IAA5D,CAAiEC,cAAjE,EACHD,IADG,CACE,SAAAE,iBAAiB,CAAI,CACxB;AACC,MAAOA,kBAAP,CACH,CAJG,CAAR,CAMC,CAAC,MAAOC,KAAP,CAAc,CAChB,MAAOA,MAAK,CAACC,OAAb,CACC,CACJ,CACD,QAASH,eAAT,CAAwBI,QAAxB,CAAkC,CAC9B,MAAOA,SAAQ,CAACC,IAAT,GAAgBN,IAAhB,CAAqB,SAAAM,IAAI,CAAI,CAChC,GAAMC,KAAI,CAAGD,IAAI,EAAIV,IAAI,CAACY,KAAL,CAAWF,IAAX,CAArB,CACA,GAAI,CAACD,QAAQ,CAACI,EAAd,CAAkB,CACd,GAAIJ,QAAQ,CAACK,MAAT,GAAoB,GAAxB,CAA6B,CACzB;AACA;AACD;AACF,CACD,GAAMP,MAAK,CAAII,IAAI,EAAIA,IAAI,CAACH,OAAd,EAA0BC,QAAQ,CAACM,UAAjD,CACA,MAAOC,QAAO,CAACC,MAAR,CAAeV,KAAf,CAAP,CACH,CACD,MAAOI,KAAP,CACH,CAZM,CAAP,CAaH,CAED,QAASO,OAAT,EAAkB,CACd;AACAhB,YAAY,CAACiB,UAAb,CAAwB,MAAxB,EACH"},"metadata":{},"sourceType":"module"}