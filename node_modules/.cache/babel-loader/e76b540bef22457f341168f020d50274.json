{"ast":null,"code":"/**\r\n * Created By   : Shakuntala Jatav\r\n * Created Date : on March\r\n * Description  : calculate which type of tax apply in product and cart and checkout section include exclusive and inclusive.\r\n * \r\n * Updated By   : Shakuntala Jatav\r\n * Updated Date : 06-06-2019,13-06-2019,19-06-2019\r\n * Description : 1. when update tax rate(changeTaxRate). \r\n                 2. when tax satus is none so no one tax aaply. \r\n                 3. update multiple tax.\r\n*/\n// var RoundAmount = (val) => {\n//     //return Math.round(val * 100) / 100;\n//     var decimals = 2;\n//     return Number(Math.round(val + 'e' + decimals) + 'e-' + decimals);\n// }\nexport const getInclusiveTax = (price, taxclass) => {\n  //console.log(\"getInclusiveTax\", price, taxclass)\n  var deafult_tax = localStorage.getItem('APPLY_DEFAULT_TAX') ? JSON.parse(localStorage.getItem(\"APPLY_DEFAULT_TAX\")) : null;\n  var selected_tax = localStorage.getItem('TAXT_RATE_LIST') ? JSON.parse(localStorage.getItem(\"TAXT_RATE_LIST\")) : null;\n  var apply_defult_tax = localStorage.getItem('DEFAULT_TAX_STATUS') ? localStorage.getItem('DEFAULT_TAX_STATUS').toString() : null;\n  var TaxRate = apply_defult_tax == \"true\" ? deafult_tax : selected_tax; // var Price = RoundAmount(price);\n\n  var Price = parseFloat(price);\n  var tax_rate = 0;\n\n  if (TaxRate && TaxRate.length > 0) {\n    TaxRate.map(addTax => {\n      if (addTax.check_is == true) {\n        if (taxclass == addTax.TaxClass && apply_defult_tax == \"true\") {\n          tax_rate += parseFloat(addTax.TaxRate);\n        }\n\n        if (apply_defult_tax == \"false\") {\n          tax_rate += parseFloat(addTax.TaxRate);\n        }\n      }\n    });\n  } //check the product having diffrent tax class which is not match with standered class  \n\n\n  if (tax_rate == 0 && apply_defult_tax == \"true\") {\n    selected_tax && Array.isArray(selected_tax) == true && selected_tax.map(addTax => {\n      if (taxclass == addTax.TaxClass) {\n        tax_rate += parseFloat(addTax.TaxRate);\n      }\n    });\n  }\n\n  var actual_price = 0;\n  var inclusiveTax = 0;\n  actual_price = parseFloat(Price) / (tax_rate / 100 + 1);\n  inclusiveTax = Price - actual_price;\n  return inclusiveTax;\n};\nexport const getExclusiveTax = (price, taxclass) => {\n  var deafult_tax = localStorage.getItem('APPLY_DEFAULT_TAX') ? JSON.parse(localStorage.getItem(\"APPLY_DEFAULT_TAX\")) : null;\n  var selected_tax = localStorage.getItem('TAXT_RATE_LIST') ? JSON.parse(localStorage.getItem(\"TAXT_RATE_LIST\")) : null;\n  var apply_defult_tax = localStorage.getItem('DEFAULT_TAX_STATUS') ? localStorage.getItem('DEFAULT_TAX_STATUS') : null;\n  var TaxRate = apply_defult_tax == \"true\" ? deafult_tax : selected_tax;\n  var Price = RoundAmount(price);\n  var tax_rate = 0;\n\n  if (TaxRate && TaxRate.length > 0) {\n    TaxRate.map(addTax => {\n      if (addTax.check_is == true) {\n        if (taxclass == addTax.TaxClass && apply_defult_tax == \"true\") {\n          tax_rate += parseFloat(addTax.TaxRate);\n        }\n\n        if (apply_defult_tax == \"false\") {\n          tax_rate += parseFloat(addTax.TaxRate);\n        }\n      }\n    });\n  } //check the product having diffrent tax class which is not match with standered class  \n\n\n  if (tax_rate == 0 && apply_defult_tax == \"true\") {\n    selected_tax && Array.isArray(selected_tax) == true && selected_tax.map(addTax => {\n      if (taxclass == addTax.TaxClass) {\n        tax_rate += parseFloat(addTax.TaxRate);\n      }\n    });\n  }\n\n  var exclusiveTax = 0;\n  exclusiveTax = parseFloat(Price * tax_rate / 100);\n  return exclusiveTax;\n};\n/**\r\n * Created By   : Shakuntala Jatav\r\n * Created Date : 17-06-2019\r\n * Description  : provide array of tax prodcut wise in inclusive case .\r\n * \r\n * Updated By   :\r\n * Updated Date :\r\n * Description :    \r\n*/\n\nexport const getInclusiveTaxForTotal = (price, taxclass) => {\n  //console.log(\"getInclusiveTaxForTotal\")\n  var deafult_tax = localStorage.getItem('APPLY_DEFAULT_TAX') ? JSON.parse(localStorage.getItem(\"APPLY_DEFAULT_TAX\")) : null;\n  var selected_tax = localStorage.getItem('TAXT_RATE_LIST') ? JSON.parse(localStorage.getItem(\"TAXT_RATE_LIST\")) : null;\n  var apply_defult_tax = localStorage.getItem('DEFAULT_TAX_STATUS') ? localStorage.getItem('DEFAULT_TAX_STATUS').toString() : null;\n  var TaxRate = apply_defult_tax == \"true\" ? deafult_tax : selected_tax;\n  var tax_rate = 0;\n  var tax_rate_count = 0;\n  ;\n  var actual_price = 0;\n  var inclusiveTax = [];\n  var TaxId = 0;\n  var Price = parseFloat(price);\n  var price_is = 0;\n\n  if (TaxRate && TaxRate.length > 0) {\n    TaxRate.map(addTax => {\n      if (addTax.check_is == true) {\n        if (taxclass == addTax.TaxClass && apply_defult_tax == \"true\") {\n          tax_rate = parseFloat(addTax.TaxRate);\n          tax_rate_count += 1;\n          TaxId = addTax.TaxId; // console.log(\"actual_price\", actual_price, tax_rate)\n          // actual_price = Price / ((tax_rate / 100) + 1);\n          // price_is = Price - actual_price;\n\n          price_is = Price * tax_rate / 100;\n          inclusiveTax.push({\n            id: TaxId,\n            price: price_is\n          });\n        }\n\n        if (apply_defult_tax == \"false\") {\n          tax_rate = parseFloat(addTax.TaxRate);\n          tax_rate_count += 1;\n          TaxId = addTax.TaxId; //  actual_price = Price / ((tax_rate / 100) + 1);\n          //  price_is = Price - actual_price;\n\n          price_is = Price * tax_rate / 100;\n          inclusiveTax.push({\n            id: TaxId,\n            price: price_is\n          });\n        }\n      }\n    });\n\n    if (tax_rate_count == 0 && tax_rate == 0 && apply_defult_tax == \"true\") {\n      selected_tax && Array.isArray(selected_tax) == true && selected_tax.map(addTax => {\n        if (taxclass == addTax.TaxClass) {\n          tax_rate = parseFloat(addTax.TaxRate);\n          TaxId = addTax.TaxId;\n          actual_price = Price / (tax_rate / 100 + 1);\n          price_is = Price - actual_price; // price_is= (Price * tax_rate)/100;\n\n          inclusiveTax.push({\n            id: TaxId,\n            price: price_is\n          }); // tax_rate = parseFloat(addTax.TaxRate);\n        }\n      });\n    }\n  }\n\n  return inclusiveTax;\n};\n/**\r\n * Created By   : Shakuntala Jatav\r\n * Created Date : 17-06-2019\r\n * Description  : provide array of tax prodcut wise in Exclusive case .\r\n * \r\n * Updated By   :\r\n * Updated Date :\r\n * Description :    \r\n*/\n\nexport const getExclusiveTaxForTotal = (price, taxclass) => {\n  //console.log(\"getExclusiveTaxForTotal\", price)\n  var deafult_tax = localStorage.getItem('APPLY_DEFAULT_TAX') ? JSON.parse(localStorage.getItem(\"APPLY_DEFAULT_TAX\")) : null;\n  var selected_tax = localStorage.getItem('TAXT_RATE_LIST') ? JSON.parse(localStorage.getItem(\"TAXT_RATE_LIST\")) : null;\n  var apply_defult_tax = localStorage.getItem('DEFAULT_TAX_STATUS') ? localStorage.getItem('DEFAULT_TAX_STATUS') : null;\n  var TaxRate = apply_defult_tax == \"true\" ? deafult_tax : selected_tax;\n  var tax_rate = 0;\n  var exclusiveTax = [];\n  var Price = parseFloat(price);\n  var TaxId = 0;\n  var price_is = 0;\n\n  if (TaxRate && TaxRate.length > 0) {\n    TaxRate.map(addTax => {\n      if (addTax.check_is == true) {\n        if (taxclass == addTax.TaxClass && apply_defult_tax == \"true\") {\n          tax_rate = parseFloat(addTax.TaxRate);\n          TaxId = addTax.TaxId;\n          price_is = parseFloat(Price * tax_rate / 100);\n          exclusiveTax.push({\n            id: TaxId,\n            price: price_is\n          });\n        }\n\n        if (apply_defult_tax == \"false\") {\n          tax_rate = parseFloat(addTax.TaxRate);\n          TaxId = addTax.TaxId;\n          price_is = parseFloat(Price * tax_rate / 100);\n          exclusiveTax.push({\n            id: TaxId,\n            price: price_is\n          });\n        }\n      }\n    });\n  } ///--- for default tax and have other then standerd class\n\n\n  if (tax_rate == 0 && apply_defult_tax == \"true\") {\n    if (selected_tax && Array.isArray(selected_tax) == true && selected_tax.length > 0) {\n      selected_tax.map(addTax => {\n        if (taxclass == addTax.TaxClass) {\n          tax_rate = parseFloat(addTax.TaxRate);\n          TaxId = addTax.TaxId;\n          price_is = parseFloat(Price * tax_rate / 100);\n          exclusiveTax.push({\n            id: TaxId,\n            price: price_is\n          });\n        }\n      });\n    }\n  } //--------------------------------------------------------\n\n\n  return exclusiveTax;\n};\nexport const setListActivityToCheckout = products => {\n  products.map(item => {\n    var totalTaxArray = item.Taxes && JSON.parse(item.Taxes) && JSON.parse(item.Taxes).total;\n    var subtotalTaxArray = item.Taxes && JSON.parse(item.Taxes) && JSON.parse(item.Taxes).subtotal;\n\n    if (item && !item.subtotal) {\n      var pArr = [];\n      pArr.push(item);\n      getCheckoutList(pArr);\n    }\n\n    item['subtotal'] = item.subtotal;\n    item['total'] = item.total ? item.total : item.totalPrice ? item.totalPrice : 0;\n    item['total_tax'] = item.total_tax ? item.total_tax : totalTaxArray ? Object.entries(totalTaxArray).map(item => ({\n      [item[0]]: item[1]\n    })) : item.totaltax;\n    item['subtotal_tax'] = item.subtotal_tax ? item.subtotal_tax : subtotalTaxArray ? Object.entries(subtotalTaxArray).map(item => ({\n      [item[0]]: item[1]\n    })) : item.subtotaltax;\n  });\n};\nexport const getExtensionCheckoutList = products => {\n  var TAX_CASE = getSettingCase();\n  var price = 0;\n  var tax = 0;\n  products.map(item => {\n    price = item.discount_amount !== 0 ? item.after_discount * item.quantity - getInclusiveTax(item.after_discount, item.TaxClass) : (item.old_price - getInclusiveTax(item.old_price)) * item.quantity;\n    var taxes = [];\n    var update_discount_tax = null;\n    var priceIs = price / item.quantity;\n    var discountTaxes = [];\n    var update_Ex_tax = null;\n\n    if (item.TaxStatus !== 'none') {\n      if (item.discount_amount !== 0) {\n        if (TAX_CASE == 1 || TAX_CASE == 2 || TAX_CASE == 3 || TAX_CASE == 4) {\n          update_discount_tax = getInclusiveTaxForTotal(priceIs, item.TaxClass);\n        } else {\n          update_discount_tax = getExclusiveTaxForTotal(priceIs, item.TaxClass);\n        }\n      }\n\n      if (TAX_CASE == 1 || TAX_CASE == 2 || TAX_CASE == 3 || TAX_CASE == 4) {\n        update_Ex_tax = getInclusiveTaxForTotal(item.old_price, item.TaxClass);\n      } else {\n        update_Ex_tax = getExclusiveTaxForTotal(item.old_price, item.TaxClass);\n      } // console.log(\"update_Ex_tax\", update_Ex_tax, \"update_discount_tax\", update_discount_tax)\n\n\n      if (update_Ex_tax && update_Ex_tax.length > 0) {\n        taxes.push({\n          [update_Ex_tax[0].id]: parseFloat(item.incl_tax) + parseFloat(item.excl_tax)\n        });\n      }\n\n      if (update_discount_tax && update_discount_tax.length > 0) {\n        discountTaxes.push({\n          [update_discount_tax[0].id]: parseFloat(item.incl_tax) + parseFloat(item.excl_tax)\n        });\n      }\n    } //console.log(\"taxes\", taxes, \"discountTaxes\", discountTaxes)\n\n\n    tax = item.discount_amount !== 0 ? discountTaxes : taxes;\n    item['subtotal'] = item.Price;\n    item['total'] = item.Price;\n    item['total_tax'] = tax;\n    item['subtotal_tax'] = taxes;\n  });\n};\n/**\r\n * Created By   : Shakuntala Jatav\r\n * Created Date : 17-06-2019\r\n * Description  : update checkout list for call function and update tax list use before call api.\r\n * \r\n * Updated By   :\r\n * Updated Date :\r\n * Description :    \r\n*/\n\nexport const getCheckoutList = products => {\n  var TAX_CASE = getSettingCase(); //     console.log(\"TAX_CASE\", TAX_CASE)\n  //    console.log(\"products\", products)\n\n  var all_products = [];\n  var price = 0;\n  var tax = 0;\n\n  switch (TAX_CASE) {\n    //  case 1  \n    case 1:\n      products.map(item => {\n        // price = (item.discount_amount !== 0) ? (item.after_discount * item.quantity) - getInclusiveTax(item.after_discount, item.TaxClass) : (item.old_price - getInclusiveTax(item.old_price)) * item.quantity;\n        var includesiveTax = item.incl_tax; //item.isTaxable==false?0: getInclusiveTax(item.old_price, item.TaxClass);\n        // price = price-incl_tax;\n\n        var afterDiscount = item.after_discount !== 0 ? item.after_discount : item.product_after_discount * item.quantity;\n\n        if (item.discount_type == 'Percentage') {\n          //var productDiscount=percentWiseDiscount(item.old_price-includesiveTax, item.new_product_discount_amount);\n          price = afterDiscount; //price =  (item.old_price - includesiveTax) * item.quantity;\n        } else {\n          price = item.discount_amount !== 0 ? afterDiscount : item.old_price * item.quantity - includesiveTax;\n        } //price = (item.discount_amount !== 0) ? item.after_discount : (item.old_price - getInclusiveTax(item.old_price)) * item.quantity;\n\n\n        var taxes = [];\n        var update_discount_tax = null; //var priceIs = price / item.quantity;\n\n        var priceIs = item.discount_amount !== 0 ? item.after_discount : item.old_price * item.quantity;\n        var discountTaxes = [];\n        var singleTaxAmount = item.incl_tax > 0 ? item.incl_tax : 0;\n\n        if (item.isTaxable == true && item.TaxStatus !== 'none') {\n          if (item.discount_amount !== 0) {\n            //update_discount_tax = singleTaxAmount;\n            update_discount_tax = getInclusiveTaxForTotal(priceIs, item.TaxClass); //test\n            //getInclusiveTaxForTotal(priceIs-singleTaxAmount, item.TaxClass);\n          }\n\n          var update_Ex_tax = getInclusiveTaxForTotal(item.old_price * item.quantity - includesiveTax, item.TaxClass);\n          update_Ex_tax.map(taxIs => {\n            taxes.push({\n              [taxIs.id]: taxIs.price\n            }); //* item.quantity\n          });\n          update_discount_tax && update_discount_tax.length > 0 && update_discount_tax.map(taxDis => {\n            discountTaxes.push({\n              [taxDis.id]: taxDis.price\n            });\n          });\n        }\n\n        tax = item.discount_amount !== 0 ? discountTaxes : taxes; // tax =  taxes;\n        //console.log(\"singleTaxAmount\", singleTaxAmount)\n\n        var _total = 0; //_total=price-incl_tax - productDiscount;          \n        // if( item.discount_amount !== 0)   \n        //     {_total=item.after_discount ;      \n        //     //_total=(( item.old_price - includesiveTax) * item.quantity)-item.discount_amount;\n        //     }\n        //  else\n\n        _total = item.old_price * item.quantity - includesiveTax; //var _total=(calculatedPrice - getInclusiveTax( calculatedPrice, item.TaxClass)) * item.quantity\n\n        item['subtotal'] = _total;\n        item['total'] = price;\n        item['total_tax'] = tax;\n        item['subtotal_tax'] = tax;\n      });\n      all_products = products;\n      break;\n    // case 2\n\n    case 2:\n      products.map(item => {\n        var includesiveTax = item.incl_tax;\n        price = item.discount_amount !== 0 ? item.after_discount : (item.old_price - getInclusiveTax(item.old_price, item.TaxClass)) * item.quantity;\n        var taxes = [];\n        var update_discount_tax = null;\n        var priceIs = item.discount_amount !== 0 ? item.after_discount : item.old_price * item.quantity - includesiveTax;\n        var discountTaxes = [];\n        var singleTaxAmount = item.excl_tax > 0 ? item.excl_tax : 0;\n\n        if (item.TaxStatus !== 'none') {\n          if (item.discount_amount !== 0) {\n            update_discount_tax = getExclusiveTaxForTotal(priceIs, item.TaxClass);\n          } // var update_Ex_tax = getInclusiveTaxForTotal(item.old_price, item.TaxClass);\n          // update_Ex_tax.map(taxIs => {\n          //     taxes.push({ [taxIs.id]: taxIs.price * item.quantity })\n          // })\n          // var update_Ex_tax = getInclusiveTaxForTotal((item.old_price*item.quantity)-includesiveTax, item.TaxClass);\n\n\n          var update_Ex_tax = getInclusiveTaxForTotal(price - includesiveTax, item.TaxClass); // TAX CASE-2 18/08/2022\n\n          update_Ex_tax.map(taxIs => {\n            taxes.push({\n              [taxIs.id]: taxIs.price\n            }); //* item.quantity\n          });\n          update_discount_tax && update_discount_tax.length > 0 && update_discount_tax.map(taxDis => {\n            discountTaxes.push({\n              [taxDis.id]: taxDis.price\n            });\n          });\n        }\n\n        tax = item.discount_amount !== 0 ? discountTaxes : taxes; //console.log(\"tax\", tax)\n        // var _total=( (item.old_price* item.quantity) - includesiveTax  ) ;\n\n        item['subtotal'] = (item.old_price - getInclusiveTax(item.old_price, item.TaxClass)) * item.quantity; // item['subtotal'] = _total;\n\n        item['total'] = price;\n        item['total_tax'] = tax;\n        item['subtotal_tax'] = tax;\n      });\n      all_products = products;\n      break;\n    // case 3\n\n    case 3:\n      products.map(item => {\n        price = item.discount_amount !== 0 ? item.after_discount * item.quantity - getInclusiveTax(item.after_discount, item.TaxClass) : (item.old_price - getInclusiveTax(item.old_price, item.TaxClass)) * item.quantity;\n        var taxes = [];\n        var update_discount_tax = null;\n        var priceIs = item.discount_amount !== 0 ? item.after_discount : item.old_price * item.quantity;\n        var discountTaxes = [];\n        var singleTaxAmount = item.incl_tax > 0 ? item.incl_tax : 0;\n\n        if (item.TaxStatus !== 'none') {\n          if (item.discount_amount !== 0) {\n            update_discount_tax = getInclusiveTaxForTotal(priceIs, item.TaxClass);\n          }\n\n          var update_Ex_tax = getInclusiveTaxForTotal(item.old_price, item.TaxClass);\n          update_Ex_tax.map(taxIs => {\n            taxes.push({\n              [taxIs.id]: taxIs.price * item.quantity\n            });\n          });\n          update_discount_tax && update_discount_tax.length > 0 && update_discount_tax.map(taxDis => {\n            discountTaxes.push({\n              [taxDis.id]: taxDis.price\n            });\n          });\n        }\n\n        tax = item.discount_amount !== 0 ? discountTaxes : taxes;\n        item['subtotal'] = (item.old_price - getInclusiveTax(item.old_price, item.TaxClass)) * item.quantity;\n        item['total'] = price;\n        item['total_tax'] = tax;\n        item['subtotal_tax'] = tax;\n      });\n      all_products = products;\n      break;\n    // case 4\n\n    case 4:\n      products.map(item => {\n        price = item.discount_amount !== 0 ? item.after_discount : (item.old_price - getInclusiveTax(item.old_price, item.TaxClass)) * item.quantity;\n        var taxes = [];\n        var update_discount_tax = null;\n        var priceIs = item.discount_amount !== 0 ? item.after_discount : item.old_price * item.quantity;\n        var discountTaxes = [];\n        var singleTaxAmount = item.excl_tax > 0 ? item.excl_tax : 0; //console.log(\"price\", price)\n        // console.log(\"singleTaxAmount\", singleTaxAmount);\n\n        if (item.TaxStatus !== 'none') {\n          if (item.discount_amount !== 0) {\n            update_discount_tax = getExclusiveTaxForTotal(priceIs, item.TaxClass);\n          }\n\n          var update_Ex_tax = getInclusiveTaxForTotal(item.old_price, item.TaxClass);\n          update_Ex_tax.map(taxIs => {\n            taxes.push({\n              [taxIs.id]: taxIs.price * item.quantity\n            });\n          });\n          update_discount_tax && update_discount_tax.length > 0 && update_discount_tax.map(taxDis => {\n            discountTaxes.push({\n              [taxDis.id]: taxDis.price\n            });\n          });\n        }\n\n        tax = item.discount_amount !== 0 ? discountTaxes : taxes;\n        item['subtotal'] = (item.old_price - getInclusiveTax(item.old_price, item.TaxClass)) * item.quantity;\n        item['total'] = price;\n        item['total_tax'] = tax;\n        item['subtotal_tax'] = tax;\n      });\n      break;\n\n    case 6:\n    case 8:\n      products.map(item => {\n        price = item.discount_amount !== 0 ? item.old_price * item.quantity - item.discount_amount : item.old_price * item.quantity;\n        var taxes = [];\n        var update_discount_tax = null;\n        var priceIs = item.discount_amount !== 0 ? item.after_discount : item.old_price * item.quantity;\n        var discountTaxes = [];\n\n        if (item.TaxStatus !== 'none') {\n          if (item.discount_amount !== 0 && item.incl_tax == 0) {\n            update_discount_tax = getExclusiveTaxForTotal(priceIs, item.TaxClass);\n          }\n\n          var update_Ex_tax = getExclusiveTaxForTotal(item.old_price, item.TaxClass);\n          update_Ex_tax.map(taxIs => {\n            taxes.push({\n              [taxIs.id]: taxIs.price * item.quantity\n            });\n          });\n          update_discount_tax && update_discount_tax.length > 0 && update_discount_tax.map(taxDis => {\n            discountTaxes.push({\n              [taxDis.id]: taxDis.price\n            });\n          });\n        }\n\n        tax = item.discount_amount !== 0 ? item.incl_tax !== 0 ? item.incl_tax : discountTaxes : taxes;\n        item['subtotal'] = item.old_price * item.quantity;\n        item['total'] = price;\n        item['total_tax'] = tax;\n        item['subtotal_tax'] = tax;\n      });\n      break;\n\n    default:\n      products.map(item => {\n        price = item.discount_amount !== 0 ? item.old_price * item.quantity - exclusiveDiscount(item.after_discount, item.discount_amount, item.old_price * item.quantity) : item.old_price * item.quantity;\n        var taxes = [];\n        var update_discount_tax = null;\n        var priceIs = (item.discount_amount !== 0 ? item.after_discount : item.old_price) * item.quantity;\n        var discountTaxes = [];\n\n        if (item.TaxStatus !== 'none') {\n          if (item.discount_amount !== 0 && item.incl_tax !== 0) {\n            update_discount_tax = getInclusiveTaxForTotal(priceIs, item.TaxClass);\n          }\n\n          var update_Ex_tax = getExclusiveTaxForTotal(item.old_price, item.TaxClass);\n          update_Ex_tax.map(taxIs => {\n            taxes.push({\n              [taxIs.id]: taxIs.price * item.quantity\n            });\n          });\n          update_discount_tax && update_discount_tax.length > 0 && update_discount_tax.map(taxDis => {\n            discountTaxes.push({\n              [taxDis.id]: taxDis.price\n            });\n          });\n        }\n\n        tax = item.discount_amount !== 0 ? item.incl_tax !== 0 ? discountTaxes : item.excl_tax : taxes;\n        item['subtotal'] = item.old_price * item.quantity;\n        item['total'] = price;\n        item['total_tax'] = tax;\n        item['subtotal_tax'] = tax;\n      });\n      all_products = products;\n      break;\n  }\n\n  return all_products;\n};\nexport const productPriceWithTax = (price, condition, taxclass) => {\n  var deafult_tax = localStorage.getItem('APPLY_DEFAULT_TAX') ? JSON.parse(localStorage.getItem(\"APPLY_DEFAULT_TAX\")) : null;\n  var selected_tax = localStorage.getItem('TAXT_RATE_LIST') ? JSON.parse(localStorage.getItem(\"TAXT_RATE_LIST\")) : null;\n  var apply_defult_tax = localStorage.getItem('DEFAULT_TAX_STATUS') ? localStorage.getItem('DEFAULT_TAX_STATUS') : null;\n  var TaxRate = apply_defult_tax == \"true\" ? deafult_tax : selected_tax;\n  var tax_rate = 0;\n  var actual_price = 0;\n\n  if (TaxRate && TaxRate.length > 0) {\n    TaxRate.map(addTax => {\n      if (addTax.check_is == true) {\n        if (taxclass == addTax.TaxClass && apply_defult_tax == \"true\") {\n          tax_rate += parseFloat(addTax.TaxRate);\n        }\n\n        if (apply_defult_tax == \"false\") {\n          tax_rate += parseFloat(addTax.TaxRate);\n        }\n      }\n    });\n  }\n\n  if (condition == '3' || condition == '4') return actual_price = parseFloat(price) / (tax_rate / 100 + 1);else return actual_price = parseFloat(parseFloat(price) * tax_rate / 100) + parseFloat(price);\n};\nexport const typeOfTax = () => {\n  var TAX_CASE = getSettingCase();\n  var TAX_IS = \"Tax\";\n\n  switch (TAX_CASE) {\n    case 1:\n    case 3:\n    case 5:\n    case 7:\n      TAX_IS = \"incl\";\n      break;\n\n    default:\n      TAX_IS = \"Tax\";\n      break;\n  }\n\n  return TAX_IS;\n}; // Apply tax when show product list on shop \n\nexport const getTaxAllProduct = products => {\n  var all_products = [];\n  var price = 0;\n  var TAX_CASE = getSettingCase(); //console.log(\"TAX_CASE\", TAX_CASE)\n\n  switch (TAX_CASE) {\n    //  case 1  \n    case 1:\n    case 2:\n    case 7:\n    case 8:\n      if (products && products !== null && products !== undefined) {\n        products.map(item => {\n          item['old_price'] = item.Price;\n        });\n      }\n\n      all_products = products;\n      break;\n\n    case 3:\n    case 4:\n    case 5:\n    case 6:\n      products && products.map(item => {\n        item['old_price'] = item.Price;\n\n        if (item.TaxStatus !== \"none\") {\n          price = productPriceWithTax(item.Price, TAX_CASE, item.TaxClass);\n          item['Price'] = parseFloat(price);\n        }\n      });\n      all_products = products;\n      break;\n\n    default:\n      products && products.map(item => {\n        item['old_price'] = item.Price;\n      });\n      all_products = products;\n      break;\n  }\n\n  return all_products;\n};\nexport const cartPriceWithTax = (price, condition, taxclass) => {\n  //console.log(\"cartPriceWithTax\", price, condition)\n  var deafult_tax = localStorage.getItem('APPLY_DEFAULT_TAX') ? JSON.parse(localStorage.getItem(\"APPLY_DEFAULT_TAX\")) : null;\n  var selected_tax = localStorage.getItem('TAXT_RATE_LIST') ? JSON.parse(localStorage.getItem(\"TAXT_RATE_LIST\")) : null;\n  var apply_defult_tax = localStorage.getItem('DEFAULT_TAX_STATUS') ? localStorage.getItem('DEFAULT_TAX_STATUS') : null;\n  var TaxRate = apply_defult_tax == \"true\" ? deafult_tax : selected_tax;\n  var tax_rate = 0;\n  var actual_price = 0;\n\n  if (TaxRate && TaxRate.length > 0) {\n    TaxRate.map(addTax => {\n      if (addTax.check_is == true) {\n        if (taxclass == addTax.TaxClass && apply_defult_tax == \"true\") {\n          tax_rate += parseFloat(addTax.TaxRate);\n        }\n\n        if (apply_defult_tax == \"false\") {\n          tax_rate += parseFloat(addTax.TaxRate);\n        }\n      }\n    });\n  } ///--- for default tax and have other then standerd class\n\n\n  if (tax_rate == 0 && apply_defult_tax == \"true\") {\n    if (selected_tax && Array.isArray(selected_tax) == true && selected_tax.length > 0) {\n      selected_tax.map(addTax => {\n        if (taxclass == addTax.TaxClass) {\n          tax_rate = parseFloat(addTax.TaxRate);\n        }\n      });\n    }\n  }\n\n  if (condition == '7') return actual_price = parseFloat(parseFloat(price) * tax_rate / 100) + parseFloat(price);else if (condition == '2' || condition == '4') return actual_price = parseFloat(price) / (tax_rate / 100 + 1);else return actual_price = parseFloat(price) - parseFloat(parseFloat(price) * tax_rate / 100);\n}; // Apply tax when product add on cart\n// updated by: Nagendra\n// udated Date: 19 May 2020\n// Description: Remove the prodcut id to get tax  due to custome fee may be taxable and custome fee donot have product id.........\n\nexport const getTaxCartProduct = products => {\n  //console.log(\"getTaxCartProduct\",products)\n  var TAX_CASE = getSettingCase(); //console.log(\"TAX_CASE\", TAX_CASE)\n\n  var all_products = [];\n  var price = 0;\n  var incl_tax = 0;\n  var excl_tax = 0;\n\n  switch (TAX_CASE) {\n    // case 1\n    case 1:\n      products.map(item => {\n        incl_tax = 0;\n\n        if (item.TaxStatus !== \"none\") {\n          //item.product_id &&\n          if (item.isTaxable == true) {\n            incl_tax = getInclusiveTax(item.after_discount && item.after_discount > 0 ? item.after_discount : item.old_price, item.TaxClass);\n          }\n\n          item['incl_tax'] = incl_tax; //* item.quantity\n        }\n      });\n      all_products = products;\n      break;\n    // case 2\n\n    case 2:\n      products.map(item => {\n        excl_tax = 0;\n        price = 0;\n\n        if (item.TaxStatus !== \"none\") {\n          //item.product_id && \n          price = item.old_price;\n\n          if (item.isTaxable == true) {\n            excl_tax = getInclusiveTax(item.old_price, item.TaxClass);\n            price = cartPriceWithTax(item.old_price, 2, item.TaxClass);\n          }\n\n          item['Price'] = price * item.quantity;\n          item['excl_tax'] = excl_tax * item.quantity;\n        }\n      });\n      all_products = products;\n      break;\n    // case 3\n\n    case 3:\n      products && products.map(item => {\n        incl_tax = 0;\n        price = 0;\n\n        if (item.TaxStatus !== \"none\") {\n          //item.product_id &&\n          price = item.old_price;\n\n          if (item.isTaxable == true) {\n            incl_tax = getInclusiveTax(item.old_price, item.TaxClass);\n            item['Price'] = item.old_price * item.quantity;\n          }\n\n          item['incl_tax'] = incl_tax * item.quantity;\n        }\n      });\n      all_products = products;\n      break;\n    // case 4\n\n    case 4:\n      products && products.map(item => {\n        excl_tax = 0;\n        price = 0;\n\n        if (item.TaxStatus !== \"none\") {\n          //item.product_id && \n          price = item.old_price;\n\n          if (item.isTaxable == true) {\n            excl_tax = getInclusiveTax(item.old_price, item.TaxClass);\n            price = cartPriceWithTax(item.old_price, 4, item.TaxClass);\n          }\n\n          item['Price'] = price * item.quantity;\n          item['excl_tax'] = excl_tax * item.quantity;\n        }\n      });\n      all_products = products;\n      break;\n    // case 5\n\n    case 5:\n      products.map(item => {\n        incl_tax = 0;\n        price = 0;\n\n        if (item.TaxStatus !== \"none\") {\n          //item.product_id &&\n          if (item.isTaxable == true) {\n            incl_tax = getExclusiveTax(item.old_price, item.TaxClass);\n          }\n\n          item['Price'] = item.Price;\n          item['incl_tax'] = incl_tax * item.quantity;\n        }\n      });\n      all_products = products;\n      break;\n    // case 6\n\n    case 6:\n      products && products.map(item => {\n        excl_tax = 0;\n        price = 0;\n\n        if (item.TaxStatus !== \"none\") {\n          //item.product_id && \n          if (item.isTaxable == true) {\n            excl_tax = getExclusiveTax(item.old_price, item.TaxClass);\n          }\n\n          item['Price'] = item.old_price * item.quantity;\n          item['excl_tax'] = excl_tax * item.quantity;\n        }\n      });\n      all_products = products;\n      break;\n    // case 7\n\n    case 7:\n      products && products.map(item => {\n        incl_tax = 0;\n        price = 0;\n\n        if (item.TaxStatus !== \"none\") {\n          //item.product_id &&\n          price = item.old_price;\n\n          if (item.isTaxable == true) {\n            price = cartPriceWithTax(item.old_price, 7, item.TaxClass);\n            incl_tax = getExclusiveTax(item.old_price, item.TaxClass);\n          }\n\n          item['Price'] = price * item.quantity;\n          item['incl_tax'] = incl_tax * item.quantity;\n        }\n      });\n      all_products = products;\n      break;\n    // case 8\n\n    default:\n      products && products.map(item => {\n        excl_tax = 0; //item.product_id &&\n\n        if (item.TaxStatus !== \"none\") {\n          if (item.isTaxable == true) {\n            excl_tax = getExclusiveTax(item.old_price, item.TaxClass);\n          }\n\n          item['excl_tax'] = excl_tax * item.quantity;\n        }\n      });\n      all_products = products;\n      break;\n  }\n\n  return all_products;\n};\nexport const inclusiveDiscount = (after_discount, discount_amount, old_price, TaxClass) => {\n  var subtotal = old_price - getInclusiveTax(old_price, TaxClass);\n  var price = after_discount + discount_amount;\n  var discount = discount_amount * 100.00 / price;\n  var get_discount = subtotal * discount / 100.00;\n  return get_discount;\n};\nexport const exclusiveDiscount = (after_discount, discount_amount, old_price) => {\n  var subtotal = old_price;\n  var price = after_discount + discount_amount;\n  var discount = discount_amount * 100.00 / price;\n  var get_discount = subtotal * discount / 100.00;\n  return get_discount;\n}; // apply discount when finaly payment save\n\nexport const getDiscountAmount = products => {\n  var TAX_CASE = getSettingCase();\n  var discountIs = 0;\n  var after_discount = 0;\n  var discount_amount = 0;\n  var old_price = 0;\n  var TaxClass = \"\";\n\n  switch (TAX_CASE) {\n    //  case 1  \n    case 1:\n    case 2:\n    case 3:\n    case 4:\n      products.map(item => {\n        if (item.discount_amount !== 0) {\n          var afterDiscount = item.after_discount !== 0 ? item.after_discount : item.product_after_discount * item.quantity;\n          after_discount += afterDiscount;\n        } else {\n          after_discount += item.Price;\n        }\n\n        if (item.discount_type == 'Percentage') {\n          var inclTax = getInclusiveTax(item.old_price, item.TaxClass);\n          discount_amount += percentWiseDiscount(item.old_price - inclTax, item.new_product_discount_amount) * item.quantity;\n          discountIs = discount_amount;\n        } else if (item.discount_type == 'Number') {\n          discount_amount += item.discount_amount;\n          discountIs = inclusiveDiscount(after_discount, discount_amount, old_price, TaxClass);\n        }\n\n        old_price += item.old_price * item.quantity;\n        TaxClass = item.TaxClass;\n      });\n      break;\n    // case 5\n\n    case 6:\n    case 8:\n      products.map(item => {\n        discountIs += item.discount_amount;\n      });\n      break;\n\n    default:\n      products.map(item => {\n        if (item.discount_amount !== 0) after_discount += item.after_discount;else {\n          after_discount += item.Price;\n        }\n        discount_amount += item.discount_amount;\n        old_price += item.old_price * item.quantity;\n      });\n      discountIs = exclusiveDiscount(after_discount, discount_amount, old_price);\n      break;\n  }\n\n  return discountIs;\n}; // case for all type of shop tax setting\n\nexport const getSettingCase = () => {\n  var TaxSetting = localStorage.getItem(\"TAX_SETTING\") ? JSON.parse(localStorage.getItem(\"TAX_SETTING\")) : null;\n  var all_products = [];\n  var prices_include_tax = TaxSetting ? TaxSetting.pos_prices_include_tax : 'no';\n  var tax_display_shop = TaxSetting ? TaxSetting.pos_tax_display_shop : 'excl';\n  var tax_display_cart = TaxSetting ? TaxSetting.pos_tax_display_cart : 'excl';\n  var tax_round_at_subtotal = TaxSetting ? TaxSetting.pos_tax_round_at_subtotal : 'no';\n  var tax_case = 0;\n\n  switch (true) {\n    //  case 1  \n    case prices_include_tax == \"yes\" && tax_display_shop == \"incl\" && tax_display_cart == \"incl\":\n      tax_case = 1;\n      break;\n    // case 2\n\n    case prices_include_tax == \"yes\" && tax_display_shop == \"incl\" && tax_display_cart == \"excl\":\n      tax_case = 2;\n      break;\n    // case 3\n\n    case prices_include_tax == \"yes\" && tax_display_shop == \"excl\" && tax_display_cart == \"incl\":\n      tax_case = 3;\n      break;\n    // case 4\n\n    case prices_include_tax == \"yes\" && tax_display_shop == \"excl\" && tax_display_cart == \"excl\":\n      tax_case = 4;\n      break;\n    // case 5\n\n    case prices_include_tax == \"no\" && tax_display_shop == \"incl\" && tax_display_cart == \"incl\":\n      tax_case = 5;\n      break;\n    // case 6\n\n    case prices_include_tax == \"no\" && tax_display_shop == \"incl\" && tax_display_cart == \"excl\":\n      tax_case = 6;\n      break;\n    // case 7\n\n    case prices_include_tax == \"no\" && tax_display_shop == \"excl\" && tax_display_cart == \"incl\":\n      tax_case = 7;\n      break;\n    // case 8\n\n    default:\n      tax_case = 8;\n      break;\n  }\n\n  return tax_case;\n};\nexport const changeTaxRate = (item, status) => {\n  var array_of_tax = [];\n\n  if (item) {\n    item && item.map(items => {\n      if (items.check_is == true) {\n        array_of_tax.push(items);\n      }\n    });\n\n    if (array_of_tax && array_of_tax.length > 0) {\n      localStorage.setItem('DEFAULT_TAX_STATUS', false);\n    }\n\n    localStorage.setItem(\"TAXT_RATE_LIST\", JSON.stringify(array_of_tax));\n  }\n\n  var products = localStorage.getItem(\"CARD_PRODUCT_LIST\") ? JSON.parse(localStorage.getItem(\"CARD_PRODUCT_LIST\")) : [];\n  var updateTax = getTaxCartProduct(products);\n  return updateTax;\n};\nexport const RoundAmount = val => {\n  //return Math.round(val * 100) / 100;\n  var decimals = 2;\n  return Number(Math.round(val + 'e' + decimals) + 'e-' + decimals);\n};\n/**\r\n * Created BY : Shakuntala Jatav\r\n * Created Date : 28-Feb-2020\r\n * @param {*} productx get product-x data\r\n * @param {*} product_list get product list array\r\n * Description : Apply taxes on chlid product of productx data\r\n */\n\n_c = RoundAmount;\nexport const getProductxChlidProductTax = (productx, product_list) => {\n  productx.map(prdx => {\n    if (prdx.composite_data) {\n      var productXArray = setProductxTax(prdx.composite_data, product_list);\n      prdx['composite_data'] = productXArray;\n    }\n\n    if (prdx.stamp) {\n      var productXArray = setProductxTax(prdx.stamp, product_list);\n      prdx['stamp'] = productXArray;\n    }\n  });\n  return productx;\n};\n/**\r\n * Created BY : Shakuntala Jatav\r\n * Created Date : 02-03-2020\r\n * @param {*} productx \r\n * @param {*} product_list \r\n * Description : Prepair taxes on chlid product of productx data\r\n */\n\nexport const setProductxTax = (productx, product_list) => {\n  Object.keys(productx).map(i => {\n    var findProductValue = product_list.filter(_item => productx[i].variation_id ? _item.WPID == productx[i].variation_id && _item.ParentId == productx[i].product_id && productx[i].quantity > 0 : _item.WPID == productx[i].product_id && productx[i].quantity > 0);\n\n    if (findProductValue && findProductValue.length > 0) {\n      findProductValue[0]['quantity'] = productx[i].quantity;\n      findProductValue[0]['product_id'] = productx[i].product_id;\n      findProductValue[0]['variation_id'] = productx[i].variation_id ? productx[i].variation_id : 0;\n      findProductValue[0]['discount_amount'] = productx[i].discount ? productx[i].discount : 0;\n      findProductValue[0]['after_discount'] = productx[i].discount ? parseFloat(findProductValue[0].Price * Number(productx[i].quantity)) - parseFloat(productx[i].discount) : 0;\n      var setProducts = getTaxAllProduct(findProductValue);\n      var products = getTaxCartProduct(setProducts);\n      var taxWithProductx = getCheckoutList(products);\n\n      if (products && products.length > 0) {\n        productx[i]['line_subtotal'] = products[0].subtotal;\n        productx[i]['line_total'] = products[0].total;\n        productx[i]['line_tax'] = products[0].total_tax;\n        productx[i]['line_subtotal_tax'] = products[0].subtotal_tax;\n      }\n    }\n  }); //console.log(\"productx updated tax\", productx);\n\n  return productx;\n};\n/**\r\n * Created By : Shakuntala Jatav\r\n * Creatted Date : 13-03-2020\r\n * @param {*} type \r\n * Description : Showing Tax Rate with name\r\n */\n\nexport const getTotalTaxByName = (type, productx_line_items) => {\n  var placedOrderList = type == 'completecheckout' ? localStorage.getItem('placedOrderList') ? JSON.parse(localStorage.getItem('placedOrderList')) : null : type; //var selected_taxrate_list = localStproductx_line_itemsorage.getItem('SELECTED_TAX') ? JSON.parse(localStorage.getItem('SELECTED_TAX')) : null;\n  //SHOP_TAXRATE_LIST\n\n  var selected_taxrate_list = localStorage.getItem('SHOP_TAXRATE_LIST') ? JSON.parse(localStorage.getItem('SHOP_TAXRATE_LIST')) : null;\n  var total_taxrate_name = [];\n  var total_taxrate_ids = [];\n\n  if (productx_line_items && productx_line_items.length > 0) {\n    productx_line_items.map(itemx => {\n      if (itemx.line_total_taxes && itemx.line_total_taxes.length > 0) {\n        itemx.line_total_taxes.map(subitemx => {\n          total_taxrate_ids.push(subitemx);\n        });\n      }\n    });\n  }\n\n  if (placedOrderList && placedOrderList.length > 0) {\n    placedOrderList.map(item => {\n      if (item.total_taxes && item.total_taxes.length > 0) {\n        item.total_taxes.map(subitem => {\n          total_taxrate_ids.push(subitem);\n        });\n      }\n\n      if (type !== \"completecheckout\") {\n        var Taxes = item.Taxes.replace(/^\\/?|\\/?$/, \"\");\n        const object1 = JSON.parse(Taxes);\n\n        if (object1) {\n          for (var [key, value] of Object.entries(object1.total)) {\n            total_taxrate_ids.push({\n              [key]: value\n            });\n          }\n        }\n      }\n    });\n  }\n\n  if (total_taxrate_ids && total_taxrate_ids.length > 0) {\n    for (var i = 0; i < total_taxrate_ids.length; i++) {\n      for (var key in total_taxrate_ids[i]) {\n        var filterSelectedTaxRateList = selected_taxrate_list && selected_taxrate_list.filter(match => match.TaxId == key);\n\n        if (filterSelectedTaxRateList && filterSelectedTaxRateList.length > 0) {\n          var tax_id = filterSelectedTaxRateList[0].TaxId;\n          var tax_name = filterSelectedTaxRateList[0].TaxName;\n          var tax_TaxRate = filterSelectedTaxRateList[0].TaxRate;\n          var tax_amount = parseFloat(total_taxrate_ids[i][key]);\n          var filterValue = total_taxrate_name && total_taxrate_name.find(_match => _match.tax_id == tax_id);\n\n          if (filterValue) {\n            total_taxrate_name.map(item => {\n              if (item.tax_id == tax_id) {\n                item['tax_amount'] += tax_amount;\n              }\n            });\n          }\n\n          if (!filterValue) {\n            total_taxrate_name.push({\n              'tax_id': tax_id,\n              'tax_name': tax_name,\n              'tax_amount': tax_amount,\n              'TaxRate': tax_TaxRate\n            });\n          }\n        }\n      }\n    } //console.log(\"total_taxrate_name\", total_taxrate_name);\n\n  }\n\n  return total_taxrate_name;\n};\n\nfunction percentWiseDiscount(price, discount) {\n  var discountAmount = price * discount / 100.00;\n  return discountAmount;\n}\n/**\r\n * Created By : Shakuntala jatav\r\n * Created Date : 06-04-2020\r\n * @param {*} item \r\n * @param {*} qty \r\n * Description : 1. for caculate tax varition poup modal\r\n                 2. Apply tax when product add on cart\r\n */\n\n\nexport const getVariatioModalProduct = (item, qty) => {\n  //console.log(\"getVariatioModalProduct\", item, qty)\n  if (item.isTaxable == false) {\n    return item;\n  }\n\n  var TAX_CASE = getSettingCase(); //console.log(\"TAX_CASE\", TAX_CASE)\n\n  var all_products = [];\n  var price = 0;\n  var incl_tax = 0;\n  var excl_tax = 0;\n  var discount_amount = item.product_discount_amount ? parseFloat(item.product_discount_amount) : 0;\n  var after_discount_price = 0;\n\n  switch (TAX_CASE) {\n    // case 1\n    case 1:\n      if (item.WPID && item.TaxStatus !== \"none\") {\n        //after_discount_price = item.old_price - discount_amount;\n        incl_tax = getInclusiveTax(item.old_price, item.TaxClass);\n\n        if (item.discount_type == \"Percentage\") {\n          var productDiscount = percentWiseDiscount(item.old_price - incl_tax, item.new_product_discount_amount) * qty;\n          after_discount_price = (item.old_price - incl_tax) * qty - productDiscount;\n        } else {\n          after_discount_price = (item.old_price - incl_tax) * qty - discount_amount;\n        }\n\n        if (item.discount_type == \"Percentage\") {\n          incl_tax = getInclusiveTax(item.old_price - discount_amount, item.TaxClass);\n        } else {\n          incl_tax = getInclusiveTax(item.old_price * qty - discount_amount, item.TaxClass);\n        } //incl_tax = getInclusiveTax(after_discount_price, item.TaxClass)\n        //item['Price'] = after_discount_price * qty\n\n\n        item['incl_tax'] = item.discount_type == \"Percentage\" ? incl_tax * qty : incl_tax; // ******** comented below line  to solve qty * issue on after discount *****//\n        // **tst** item['after_discount'] = item.discount_type == \"Percentage\" ? after_discount_price * qty : after_discount_price;\n        //**tst** remove qty multiplication from after discount\n\n        item['after_discount'] = after_discount_price;\n      }\n\n      all_products = item;\n      break;\n    // case 2\n\n    case 2:\n      if (item.WPID && item.TaxStatus !== \"none\") {\n        //after_discount_price = item.old_price - discount_amount;               \n        if (item.discount_type == \"Percentage\") {\n          var productDiscount = percentWiseDiscount(item.old_price - incl_tax, item.new_product_discount_amount) * qty;\n          after_discount_price = (item.old_price - incl_tax) * qty - productDiscount;\n        } else {\n          after_discount_price = (item.old_price - incl_tax) * qty - discount_amount;\n        }\n\n        if (item.discount_type == \"Percentage\") {\n          excl_tax = getInclusiveTax(item.old_price - discount_amount, item.TaxClass);\n        } else {\n          excl_tax = getInclusiveTax(item.old_price * qty - discount_amount, item.TaxClass);\n        }\n\n        price = cartPriceWithTax(after_discount_price, 2, item.TaxClass); //item['Price'] = price * qty\n\n        item['excl_tax'] = item.discount_type == \"Percentage\" ? excl_tax * qty : excl_tax;\n        item['after_discount'] = after_discount_price;\n      }\n\n      all_products = item;\n      break;\n    // case 3\n\n    case 3:\n      if (item.WPID && item.TaxStatus !== \"none\") {\n        //after_discount_price = item.old_price - discount_amount;\n        if (item.discount_type == \"Percentage\") {\n          var productDiscount = percentWiseDiscount(item.old_price - incl_tax, item.new_product_discount_amount) * qty;\n          after_discount_price = (item.old_price - incl_tax) * qty - productDiscount;\n        } else {\n          after_discount_price = item.discount_type == \"Percentage\" ? item.old_price - discount_amount : item.old_price * qty - discount_amount;\n        }\n\n        if (item.discount_type == \"Percentage\") {\n          incl_tax = getInclusiveTax(item.old_price - discount_amount, item.TaxClass);\n        } else {\n          incl_tax = getInclusiveTax(item.old_price * qty - discount_amount, item.TaxClass);\n        } //item['Price'] = after_discount_price * qty\n\n\n        item['incl_tax'] = item.discount_type == \"Percentage\" ? incl_tax * qty : incl_tax;\n        item['after_discount'] = after_discount_price;\n      }\n\n      all_products = item;\n      break;\n    // case 4\n\n    case 4:\n      if (item.WPID && item.TaxStatus !== \"none\") {\n        //after_discount_price = item.old_price - discount_amount;\n        if (item.discount_type == \"Percentage\") {\n          var productDiscount = percentWiseDiscount(item.old_price - incl_tax, item.new_product_discount_amount) * qty;\n          after_discount_price = (item.old_price - incl_tax) * qty - productDiscount;\n        } else {\n          after_discount_price = item.discount_type == \"Percentage\" ? item.old_price - discount_amount : item.old_price * qty - discount_amount;\n        }\n\n        if (item.discount_type == \"Percentage\") {\n          excl_tax = getInclusiveTax(item.old_price - discount_amount, item.TaxClass);\n        } else {\n          excl_tax = getInclusiveTax(item.old_price * qty - discount_amount, item.TaxClass);\n        }\n\n        price = cartPriceWithTax(after_discount_price, 4, item.TaxClass); //item['Price'] = price * qty\n\n        item['excl_tax'] = item.discount_type == \"Percentage\" ? excl_tax * qty : excl_tax;\n        ;\n        item['after_discount'] = after_discount_price;\n      }\n\n      all_products = item;\n      break;\n    // case 5\n\n    case 5:\n      if (item.WPID && item.TaxStatus !== \"none\") {\n        //after_discount_price = item.old_price - discount_amount;\n        if (item.discount_type == \"Percentage\") {\n          var productDiscount = percentWiseDiscount(item.old_price - incl_tax, item.new_product_discount_amount) * qty;\n          after_discount_price = (item.old_price - incl_tax) * qty - productDiscount;\n        } else {\n          after_discount_price = item.discount_type == \"Percentage\" ? item.old_price - discount_amount : item.old_price * qty - discount_amount;\n        }\n\n        if (item.discount_type == \"Percentage\") {\n          incl_tax = getExclusiveTax(item.old_price - discount_amount, item.TaxClass);\n        } else {\n          incl_tax = getExclusiveTax(item.old_price * qty - discount_amount, item.TaxClass);\n        } //item['Price'] = item.Price * qty\n\n\n        item['incl_tax'] = item.discount_type == \"Percentage\" ? incl_tax * qty : incl_tax;\n        item['after_discount'] = after_discount_price;\n      }\n\n      all_products = item;\n      break;\n    // case 6\n\n    case 6:\n      if (item.WPID && item.TaxStatus !== \"none\") {\n        //after_discount_price = item.old_price - discount_amount;\n        if (item.discount_type == \"Percentage\") {\n          var productDiscount = percentWiseDiscount(item.old_price - incl_tax, item.new_product_discount_amount) * qty;\n          after_discount_price = (item.old_price - incl_tax) * qty - productDiscount;\n        } else {\n          after_discount_price = item.discount_type == \"Percentage\" ? item.old_price - discount_amount : item.old_price * qty - discount_amount;\n        }\n\n        if (item.discount_type == \"Percentage\") {\n          excl_tax = getExclusiveTax(item.old_price - discount_amount, item.TaxClass);\n        } else {\n          excl_tax = getExclusiveTax(after_discount_price, item.TaxClass);\n        } //item['Price'] = after_discount_price * old_price\n\n\n        item['excl_tax'] = item.discount_type == \"Percentage\" ? excl_tax * qty : excl_tax;\n        ;\n        item['after_discount'] = after_discount_price;\n      }\n\n      all_products = item;\n      break;\n    // case 7\n\n    case 7:\n      if (item.WPID && item.TaxStatus !== \"none\") {\n        //after_discount_price = item.old_price - discount_amount;\n        if (item.discount_type == \"Percentage\") {\n          var productDiscount = percentWiseDiscount(item.old_price - incl_tax, item.new_product_discount_amount) * qty;\n          after_discount_price = (item.old_price - incl_tax) * qty - productDiscount;\n        } else {\n          after_discount_price = item.discount_type == \"Percentage\" ? item.old_price - discount_amount : item.old_price * qty - discount_amount;\n        }\n\n        price = cartPriceWithTax(after_discount_price, 7, item.TaxClass);\n\n        if (item.discount_type == \"Percentage\") {\n          incl_tax = getExclusiveTax(item.old_price - discount_amount, item.TaxClass);\n        } else {\n          incl_tax = getExclusiveTax(after_discount_price, item.TaxClass);\n        } //item['Price'] = price * qty\n\n\n        item['incl_tax'] = item.discount_type == \"Percentage\" ? incl_tax * qty : incl_tax;\n        item['after_discount'] = after_discount_price;\n      }\n\n      all_products = item;\n      break;\n    // case 8\n\n    default:\n      if (item.WPID && item.TaxStatus !== \"none\") {\n        if (item.discount_type == \"Percentage\") {\n          var productDiscount = percentWiseDiscount(item.old_price - incl_tax, item.new_product_discount_amount) * qty;\n          after_discount_price = (item.old_price - incl_tax) * qty - productDiscount;\n        } else {\n          after_discount_price = item.discount_type == \"Percentage\" ? item.old_price - discount_amount : item.old_price * qty - discount_amount;\n        }\n\n        if (item.discount_type == \"Percentage\") {\n          excl_tax = getExclusiveTax(item.old_price - discount_amount, item.TaxClass);\n        } else {\n          excl_tax = getExclusiveTax(after_discount_price, item.TaxClass);\n        } //item['Price'] = after_discount_price * qty\n\n\n        item['excl_tax'] = item.discount_type == \"Percentage\" ? excl_tax * qty : excl_tax;\n        item['after_discount'] = after_discount_price;\n      }\n\n      all_products = item;\n      break;\n  }\n\n  return all_products;\n};\nexport const TaxSetting = {\n  getTaxAllProduct,\n  productPriceWithTax,\n  getTaxCartProduct,\n  cartPriceWithTax,\n  getInclusiveTax,\n  getExclusiveTax,\n  getCheckoutList,\n  getDiscountAmount,\n  getSettingCase,\n  typeOfTax,\n  changeTaxRate,\n  getExtensionCheckoutList,\n  setListActivityToCheckout,\n  RoundAmount,\n  getProductxChlidProductTax,\n  getTotalTaxByName\n};\nexport default TaxSetting;\n\nvar _c;\n\n$RefreshReg$(_c, \"RoundAmount\");","map":{"version":3,"names":["getInclusiveTax","price","taxclass","deafult_tax","localStorage","getItem","JSON","parse","selected_tax","apply_defult_tax","toString","TaxRate","Price","parseFloat","tax_rate","length","map","addTax","check_is","TaxClass","Array","isArray","actual_price","inclusiveTax","getExclusiveTax","RoundAmount","exclusiveTax","getInclusiveTaxForTotal","tax_rate_count","TaxId","price_is","push","id","getExclusiveTaxForTotal","setListActivityToCheckout","products","item","totalTaxArray","Taxes","total","subtotalTaxArray","subtotal","pArr","getCheckoutList","totalPrice","total_tax","Object","entries","totaltax","subtotal_tax","subtotaltax","getExtensionCheckoutList","TAX_CASE","getSettingCase","tax","discount_amount","after_discount","quantity","old_price","taxes","update_discount_tax","priceIs","discountTaxes","update_Ex_tax","TaxStatus","incl_tax","excl_tax","all_products","includesiveTax","afterDiscount","product_after_discount","discount_type","singleTaxAmount","isTaxable","taxIs","taxDis","_total","exclusiveDiscount","productPriceWithTax","condition","typeOfTax","TAX_IS","getTaxAllProduct","undefined","cartPriceWithTax","getTaxCartProduct","inclusiveDiscount","discount","get_discount","getDiscountAmount","discountIs","inclTax","percentWiseDiscount","new_product_discount_amount","TaxSetting","prices_include_tax","pos_prices_include_tax","tax_display_shop","pos_tax_display_shop","tax_display_cart","pos_tax_display_cart","tax_round_at_subtotal","pos_tax_round_at_subtotal","tax_case","changeTaxRate","status","array_of_tax","items","setItem","stringify","updateTax","val","decimals","Number","Math","round","getProductxChlidProductTax","productx","product_list","prdx","composite_data","productXArray","setProductxTax","stamp","keys","i","findProductValue","filter","_item","variation_id","WPID","ParentId","product_id","setProducts","taxWithProductx","getTotalTaxByName","type","productx_line_items","placedOrderList","selected_taxrate_list","total_taxrate_name","total_taxrate_ids","itemx","line_total_taxes","subitemx","total_taxes","subitem","replace","object1","key","value","filterSelectedTaxRateList","match","tax_id","tax_name","TaxName","tax_TaxRate","tax_amount","filterValue","find","_match","discountAmount","getVariatioModalProduct","qty","product_discount_amount","after_discount_price","productDiscount"],"sources":["D:/OliverPOS/OliverPOS3.0/src/components/common/TaxSetting.js"],"sourcesContent":["/**\r\n * Created By   : Shakuntala Jatav\r\n * Created Date : on March\r\n * Description  : calculate which type of tax apply in product and cart and checkout section include exclusive and inclusive.\r\n * \r\n * Updated By   : Shakuntala Jatav\r\n * Updated Date : 06-06-2019,13-06-2019,19-06-2019\r\n * Description : 1. when update tax rate(changeTaxRate). \r\n                 2. when tax satus is none so no one tax aaply. \r\n                 3. update multiple tax.\r\n*/\r\n// var RoundAmount = (val) => {\r\n//     //return Math.round(val * 100) / 100;\r\n//     var decimals = 2;\r\n//     return Number(Math.round(val + 'e' + decimals) + 'e-' + decimals);\r\n// }\r\n\r\nexport const getInclusiveTax = (price, taxclass) => {\r\n    //console.log(\"getInclusiveTax\", price, taxclass)\r\n    var deafult_tax = localStorage.getItem('APPLY_DEFAULT_TAX') ? JSON.parse(localStorage.getItem(\"APPLY_DEFAULT_TAX\")) : null;\r\n    var selected_tax = localStorage.getItem('TAXT_RATE_LIST') ? JSON.parse(localStorage.getItem(\"TAXT_RATE_LIST\")) : null;\r\n    var apply_defult_tax = localStorage.getItem('DEFAULT_TAX_STATUS') ? localStorage.getItem('DEFAULT_TAX_STATUS').toString() : null;\r\n    var TaxRate = apply_defult_tax == \"true\" ? deafult_tax : selected_tax;\r\n    // var Price = RoundAmount(price);\r\n    var Price = parseFloat(price);\r\n    var tax_rate = 0;\r\n    if (TaxRate && TaxRate.length > 0) {\r\n        TaxRate.map(addTax => {\r\n            if (addTax.check_is == true) {\r\n                if (taxclass == addTax.TaxClass && apply_defult_tax == \"true\") {\r\n                    tax_rate += parseFloat(addTax.TaxRate);\r\n                }\r\n                if (apply_defult_tax == \"false\") {\r\n                    tax_rate += parseFloat(addTax.TaxRate);\r\n                }\r\n            }\r\n        })\r\n    }   \r\n    //check the product having diffrent tax class which is not match with standered class  \r\n    if(tax_rate==0 && apply_defult_tax==\"true\"){\r\n        selected_tax  && Array.isArray(selected_tax)==true && selected_tax.map(addTax => {\r\n                if (taxclass == addTax.TaxClass ) {\r\n                    tax_rate += parseFloat(addTax.TaxRate);\r\n                }               \r\n        })\r\n    }\r\n    var actual_price = 0;\r\n    var inclusiveTax = 0;\r\n    actual_price = parseFloat(Price) / ((tax_rate / 100) + 1);\r\n    inclusiveTax = (Price - actual_price)\r\n    return inclusiveTax\r\n}\r\n\r\nexport const getExclusiveTax = (price, taxclass) => {\r\n    var deafult_tax = localStorage.getItem('APPLY_DEFAULT_TAX') ? JSON.parse(localStorage.getItem(\"APPLY_DEFAULT_TAX\")) : null;\r\n    var selected_tax = localStorage.getItem('TAXT_RATE_LIST') ? JSON.parse(localStorage.getItem(\"TAXT_RATE_LIST\")) : null;\r\n    var apply_defult_tax = localStorage.getItem('DEFAULT_TAX_STATUS') ? localStorage.getItem('DEFAULT_TAX_STATUS') : null;\r\n    var TaxRate = apply_defult_tax == \"true\" ? deafult_tax : selected_tax;\r\n    var Price = RoundAmount(price);\r\n    var tax_rate = 0;\r\n    if (TaxRate && TaxRate.length > 0) {\r\n        TaxRate.map(addTax => {\r\n            if (addTax.check_is == true) {\r\n                if (taxclass == addTax.TaxClass && apply_defult_tax == \"true\") {\r\n                    tax_rate += parseFloat(addTax.TaxRate);\r\n                }\r\n                if (apply_defult_tax == \"false\") {\r\n                    tax_rate += parseFloat(addTax.TaxRate);\r\n                }\r\n            }\r\n        })\r\n    }\r\n      //check the product having diffrent tax class which is not match with standered class  \r\n      if(tax_rate==0 && apply_defult_tax==\"true\"){\r\n        selected_tax  && Array.isArray(selected_tax)==true && selected_tax.map(addTax => {\r\n                if (taxclass == addTax.TaxClass ) {\r\n                    tax_rate += parseFloat(addTax.TaxRate);\r\n                }               \r\n        })\r\n    }\r\n    var exclusiveTax = 0;\r\n    exclusiveTax = parseFloat((Price * tax_rate) / 100);\r\n    return exclusiveTax;\r\n}\r\n\r\n/**\r\n * Created By   : Shakuntala Jatav\r\n * Created Date : 17-06-2019\r\n * Description  : provide array of tax prodcut wise in inclusive case .\r\n * \r\n * Updated By   :\r\n * Updated Date :\r\n * Description :    \r\n*/\r\nexport const getInclusiveTaxForTotal = (price, taxclass) => {\r\n    //console.log(\"getInclusiveTaxForTotal\")\r\n    var deafult_tax = localStorage.getItem('APPLY_DEFAULT_TAX') ? JSON.parse(localStorage.getItem(\"APPLY_DEFAULT_TAX\")) : null;\r\n    var selected_tax = localStorage.getItem('TAXT_RATE_LIST') ? JSON.parse(localStorage.getItem(\"TAXT_RATE_LIST\")) : null;\r\n    var apply_defult_tax = localStorage.getItem('DEFAULT_TAX_STATUS') ? localStorage.getItem('DEFAULT_TAX_STATUS').toString() : null;\r\n    var TaxRate = apply_defult_tax == \"true\" ? deafult_tax : selected_tax;\r\n    var tax_rate = 0;\r\n    var tax_rate_count=0;;\r\n    var actual_price = 0;\r\n    var inclusiveTax = [];\r\n    var TaxId = 0;\r\n    var Price = parseFloat(price);\r\n    var price_is = 0;\r\n    if (TaxRate && TaxRate.length > 0) {\r\n        TaxRate.map(addTax => {\r\n            if (addTax.check_is == true) {\r\n                if (taxclass == addTax.TaxClass && apply_defult_tax == \"true\") {\r\n                    tax_rate = parseFloat(addTax.TaxRate);\r\n                    tax_rate_count += 1;\r\n                    TaxId = addTax.TaxId;\r\n                    // console.log(\"actual_price\", actual_price, tax_rate)\r\n                    // actual_price = Price / ((tax_rate / 100) + 1);\r\n                    // price_is = Price - actual_price;\r\n                     price_is= (Price * tax_rate)/100;\r\n                     inclusiveTax.push({ id: TaxId, price: price_is })\r\n                }\r\n\r\n                if (apply_defult_tax == \"false\") {\r\n                    tax_rate = parseFloat(addTax.TaxRate);\r\n                    tax_rate_count += 1;\r\n                    TaxId = addTax.TaxId;\r\n                    //  actual_price = Price / ((tax_rate / 100) + 1);\r\n                    //  price_is = Price - actual_price;\r\n                    price_is= (Price * tax_rate)/100;\r\n                    inclusiveTax.push({ id: TaxId, price: price_is })\r\n                }\r\n            }\r\n        })\r\n\r\n        if(tax_rate_count ==0 && tax_rate==0 && apply_defult_tax==\"true\"){\r\n            selected_tax  && Array.isArray(selected_tax)==true && selected_tax.map(addTax => {\r\n                    if (taxclass == addTax.TaxClass ) {\r\n                        tax_rate = parseFloat(addTax.TaxRate);\r\n                        TaxId = addTax.TaxId;\r\n                        actual_price = Price / ((tax_rate / 100) + 1);\r\n                        price_is = Price - actual_price;\r\n                        // price_is= (Price * tax_rate)/100;\r\n                        inclusiveTax.push({ id: TaxId, price: price_is })\r\n                            // tax_rate = parseFloat(addTax.TaxRate);\r\n                    }               \r\n            })\r\n        }\r\n    }\r\n    return inclusiveTax\r\n}\r\n/**\r\n * Created By   : Shakuntala Jatav\r\n * Created Date : 17-06-2019\r\n * Description  : provide array of tax prodcut wise in Exclusive case .\r\n * \r\n * Updated By   :\r\n * Updated Date :\r\n * Description :    \r\n*/\r\nexport const getExclusiveTaxForTotal = (price, taxclass) => {\r\n    //console.log(\"getExclusiveTaxForTotal\", price)\r\n    var deafult_tax = localStorage.getItem('APPLY_DEFAULT_TAX') ? JSON.parse(localStorage.getItem(\"APPLY_DEFAULT_TAX\")) : null;\r\n    var selected_tax = localStorage.getItem('TAXT_RATE_LIST') ? JSON.parse(localStorage.getItem(\"TAXT_RATE_LIST\")) : null;\r\n    var apply_defult_tax = localStorage.getItem('DEFAULT_TAX_STATUS') ? localStorage.getItem('DEFAULT_TAX_STATUS') : null;\r\n    var TaxRate = apply_defult_tax == \"true\" ? deafult_tax : selected_tax;\r\n    var tax_rate = 0;\r\n    var exclusiveTax = [];\r\n    var Price = parseFloat(price);\r\n    var TaxId = 0;\r\n    var price_is = 0;\r\n    if (TaxRate && TaxRate.length > 0) {\r\n        TaxRate.map(addTax => {\r\n            if (addTax.check_is == true) {\r\n                if (taxclass == addTax.TaxClass && apply_defult_tax == \"true\") {\r\n                    tax_rate = parseFloat(addTax.TaxRate);\r\n                    TaxId = addTax.TaxId;\r\n                    price_is = parseFloat((Price * tax_rate) / 100);\r\n                    exclusiveTax.push({ id: TaxId, price: price_is })\r\n                }\r\n                if (apply_defult_tax == \"false\") {\r\n                    tax_rate = parseFloat(addTax.TaxRate);\r\n                    TaxId = addTax.TaxId;\r\n                    price_is = parseFloat((Price * tax_rate) / 100);\r\n                    exclusiveTax.push({ id: TaxId, price: price_is })\r\n                }\r\n            }\r\n        })\r\n    }\r\n        ///--- for default tax and have other then standerd class\r\n        if(tax_rate==0 && apply_defult_tax == \"true\"){\r\n            if (selected_tax && Array.isArray(selected_tax)==true && selected_tax.length > 0) {\r\n                selected_tax.map(addTax => {                 \r\n                        if (taxclass == addTax.TaxClass) {\r\n                            tax_rate = parseFloat(addTax.TaxRate);\r\n                            TaxId = addTax.TaxId;    \r\n                            price_is = parseFloat((Price * tax_rate) / 100);\r\n                            exclusiveTax.push({ id: TaxId, price: price_is }) \r\n                    }\r\n                })\r\n               \r\n        }\r\n    }\r\n    //--------------------------------------------------------\r\n    return exclusiveTax\r\n}\r\n\r\nexport const setListActivityToCheckout = (products) => {\r\n    products.map(item => {\r\n        var totalTaxArray = item.Taxes && JSON.parse(item.Taxes) && JSON.parse(item.Taxes).total;\r\n        var subtotalTaxArray = item.Taxes && JSON.parse(item.Taxes) && JSON.parse(item.Taxes).subtotal;\r\n        if(  item && (!item.subtotal)){\r\n            var pArr=[];\r\n            pArr.push(item);\r\n            getCheckoutList(pArr);        }\r\n        item['subtotal'] = item.subtotal\r\n        item['total'] = item.total ? item.total: item.totalPrice ?item.totalPrice: 0;\r\n        item['total_tax'] = item.total_tax?item.total_tax: totalTaxArray ? Object.entries(totalTaxArray).map(item => ({ [item[0]]: item[1] })) : item.totaltax\r\n        item['subtotal_tax'] = item.subtotal_tax?item.subtotal_tax:subtotalTaxArray ? Object.entries(subtotalTaxArray).map(item => ({ [item[0]]: item[1] })) : item.subtotaltax\r\n    })\r\n}\r\n\r\nexport const getExtensionCheckoutList = (products) => {\r\n    var TAX_CASE = getSettingCase()\r\n    var price = 0;\r\n    var tax = 0;\r\n    products.map(item => {\r\n        price = (item.discount_amount !== 0) ? (item.after_discount * item.quantity) - getInclusiveTax(item.after_discount, item.TaxClass) : (item.old_price - getInclusiveTax(item.old_price)) * item.quantity;\r\n        var taxes = [];\r\n        var update_discount_tax = null;\r\n        var priceIs = price / item.quantity;\r\n        var discountTaxes = [];\r\n        var update_Ex_tax = null;\r\n        if (item.TaxStatus !== 'none') {\r\n            if (item.discount_amount !== 0) {\r\n                if (TAX_CASE == 1 || TAX_CASE == 2 || TAX_CASE == 3 || TAX_CASE == 4) {\r\n                    update_discount_tax = getInclusiveTaxForTotal(priceIs, item.TaxClass);\r\n                } else {\r\n                    update_discount_tax = getExclusiveTaxForTotal(priceIs, item.TaxClass);\r\n                }\r\n            }\r\n            if (TAX_CASE == 1 || TAX_CASE == 2 || TAX_CASE == 3 || TAX_CASE == 4) {\r\n                update_Ex_tax = getInclusiveTaxForTotal(item.old_price, item.TaxClass)\r\n            } else {\r\n                update_Ex_tax = getExclusiveTaxForTotal(item.old_price, item.TaxClass)\r\n            }\r\n            // console.log(\"update_Ex_tax\", update_Ex_tax, \"update_discount_tax\", update_discount_tax)\r\n            if (update_Ex_tax && update_Ex_tax.length > 0) {\r\n                taxes.push({ [update_Ex_tax[0].id]: parseFloat(item.incl_tax) + parseFloat(item.excl_tax) })\r\n            }\r\n            if (update_discount_tax && update_discount_tax.length > 0) {\r\n                discountTaxes.push({ [update_discount_tax[0].id]: parseFloat(item.incl_tax) + parseFloat(item.excl_tax) })\r\n            }\r\n        }\r\n        //console.log(\"taxes\", taxes, \"discountTaxes\", discountTaxes)\r\n        tax = (item.discount_amount !== 0) ? discountTaxes : taxes\r\n        item['subtotal'] = item.Price\r\n        item['total'] = item.Price\r\n        item['total_tax'] = tax\r\n        item['subtotal_tax'] = taxes\r\n    })\r\n}\r\n/**\r\n * Created By   : Shakuntala Jatav\r\n * Created Date : 17-06-2019\r\n * Description  : update checkout list for call function and update tax list use before call api.\r\n * \r\n * Updated By   :\r\n * Updated Date :\r\n * Description :    \r\n*/\r\nexport const getCheckoutList = (products) => {\r\n    var TAX_CASE = getSettingCase();\r\n//     console.log(\"TAX_CASE\", TAX_CASE)\r\n//    console.log(\"products\", products)\r\n    var all_products = [];\r\n    var price = 0;\r\n    var tax = 0;\r\n    switch (TAX_CASE) {\r\n        //  case 1  \r\n        case 1:\r\n            products.map(item => {\r\n               // price = (item.discount_amount !== 0) ? (item.after_discount * item.quantity) - getInclusiveTax(item.after_discount, item.TaxClass) : (item.old_price - getInclusiveTax(item.old_price)) * item.quantity;\r\n             \r\n               var includesiveTax= item.incl_tax;//item.isTaxable==false?0: getInclusiveTax(item.old_price, item.TaxClass);\r\n               // price = price-incl_tax;\r\n                var afterDiscount=item.after_discount !==0?item.after_discount: item.product_after_discount* item.quantity;\r\n               if (item.discount_type == 'Percentage') {\r\n               //var productDiscount=percentWiseDiscount(item.old_price-includesiveTax, item.new_product_discount_amount);\r\n                price =afterDiscount;\r\n                     //price =  (item.old_price - includesiveTax) * item.quantity;\r\n                }else{\r\n               \r\n                    price = (item.discount_amount !== 0) ? (afterDiscount)  : ((item.old_price*item.quantity) - includesiveTax) ;\r\n               }\r\n               //price = (item.discount_amount !== 0) ? item.after_discount : (item.old_price - getInclusiveTax(item.old_price)) * item.quantity;\r\n                var taxes = [];\r\n                var update_discount_tax = null;\r\n                //var priceIs = price / item.quantity;\r\n                var priceIs =  ((item.discount_amount !== 0) ? item.after_discount : item.old_price*item.quantity);\r\n                var discountTaxes = [];\r\n                var singleTaxAmount = item.incl_tax > 0 ? item.incl_tax : 0;\r\n                if ( item.isTaxable==true && item.TaxStatus !== 'none') {\r\n                    if (item.discount_amount !== 0) {\r\n                        //update_discount_tax = singleTaxAmount;\r\n                        update_discount_tax  = getInclusiveTaxForTotal(priceIs, item.TaxClass); //test\r\n                        //getInclusiveTaxForTotal(priceIs-singleTaxAmount, item.TaxClass);\r\n                    }\r\n                    var update_Ex_tax = getInclusiveTaxForTotal((item.old_price*item.quantity)-includesiveTax, item.TaxClass);\r\n                    update_Ex_tax.map(taxIs => {\r\n                        taxes.push({ [taxIs.id]: taxIs.price }) //* item.quantity\r\n                    })                   \r\n                    update_discount_tax && update_discount_tax.length > 0 && update_discount_tax.map(taxDis => {\r\n                        discountTaxes.push({ [taxDis.id]: taxDis.price })\r\n                    })                   \r\n                }\r\n                tax = (item.discount_amount !== 0) ? discountTaxes : taxes;\r\n               // tax =  taxes;\r\n                //console.log(\"singleTaxAmount\", singleTaxAmount)\r\n                 var _total=0;    \r\n                 //_total=price-incl_tax - productDiscount;          \r\n                // if( item.discount_amount !== 0)   \r\n                //     {_total=item.after_discount ;      \r\n                //     //_total=(( item.old_price - includesiveTax) * item.quantity)-item.discount_amount;\r\n                //     }\r\n                //  else\r\n                    _total=( (item.old_price* item.quantity) - includesiveTax  ) ;\r\n               \r\n               //var _total=(calculatedPrice - getInclusiveTax( calculatedPrice, item.TaxClass)) * item.quantity\r\n                item['subtotal'] =_total;\r\n                item['total'] =price  ; \r\n                item['total_tax'] = tax;\r\n                item['subtotal_tax'] = tax;\r\n            })\r\n            all_products = products;\r\n            break;\r\n        // case 2\r\n        case 2:\r\n            products.map(item => {\r\n                var includesiveTax= item.incl_tax;\r\n                price = (item.discount_amount !== 0) ? item.after_discount : (item.old_price - getInclusiveTax(item.old_price, item.TaxClass)) * item.quantity;\r\n                var taxes = [];\r\n                var update_discount_tax = null;\r\n                var priceIs =  ((item.discount_amount !== 0) ? item.after_discount : (item.old_price*item.quantity)- includesiveTax);              \r\n                var discountTaxes = [];\r\n                var singleTaxAmount = item.excl_tax > 0 ? item.excl_tax : 0;\r\n                if (item.TaxStatus !== 'none') {\r\n                    if (item.discount_amount !== 0) {\r\n                        update_discount_tax = getExclusiveTaxForTotal(priceIs, item.TaxClass);\r\n                    }\r\n                    // var update_Ex_tax = getInclusiveTaxForTotal(item.old_price, item.TaxClass);\r\n                    // update_Ex_tax.map(taxIs => {\r\n                    //     taxes.push({ [taxIs.id]: taxIs.price * item.quantity })\r\n                    // })\r\n\r\n                    // var update_Ex_tax = getInclusiveTaxForTotal((item.old_price*item.quantity)-includesiveTax, item.TaxClass);\r\n                    var update_Ex_tax = getInclusiveTaxForTotal((price)-includesiveTax, item.TaxClass); // TAX CASE-2 18/08/2022\r\n                    update_Ex_tax.map(taxIs => {\r\n                        taxes.push({ [taxIs.id]: taxIs.price }) //* item.quantity\r\n                    })   \r\n\r\n                    update_discount_tax && update_discount_tax.length > 0 && update_discount_tax.map(taxDis => {\r\n                        discountTaxes.push({ [taxDis.id]: taxDis.price})\r\n                    })\r\n                }\r\n                tax = (item.discount_amount !== 0) ? discountTaxes : taxes;\r\n                //console.log(\"tax\", tax)\r\n\r\n               // var _total=( (item.old_price* item.quantity) - includesiveTax  ) ;\r\n\r\n                item['subtotal'] = (item.old_price - getInclusiveTax(item.old_price, item.TaxClass)) * item.quantity\r\n                // item['subtotal'] = _total;\r\n                item['total'] = price;\r\n                item['total_tax'] = tax;\r\n                item['subtotal_tax'] = tax;\r\n\r\n            })\r\n            all_products = products;\r\n\r\n            break;\r\n        // case 3\r\n        case 3:\r\n            products.map(item => {\r\n                price = (item.discount_amount !== 0) ? (item.after_discount * item.quantity) - getInclusiveTax(item.after_discount, item.TaxClass) : (item.old_price - getInclusiveTax(item.old_price, item.TaxClass)) * item.quantity;\r\n                var taxes = [];\r\n                var update_discount_tax = null;\r\n                var priceIs =  ((item.discount_amount !== 0) ? item.after_discount : item.old_price*item.quantity);\r\n                var discountTaxes = [];\r\n                var singleTaxAmount = item.incl_tax > 0 ? item.incl_tax : 0;\r\n                if (item.TaxStatus !== 'none') {\r\n                    if (item.discount_amount !== 0) {\r\n                        update_discount_tax = getInclusiveTaxForTotal(priceIs, item.TaxClass);\r\n                    }\r\n                    var update_Ex_tax = getInclusiveTaxForTotal(item.old_price, item.TaxClass);\r\n                    update_Ex_tax.map(taxIs => {\r\n                        taxes.push({ [taxIs.id]: taxIs.price * item.quantity })\r\n                    })\r\n                    update_discount_tax && update_discount_tax.length > 0 && update_discount_tax.map(taxDis => {\r\n                        discountTaxes.push({ [taxDis.id]: taxDis.price})\r\n                    })\r\n                }\r\n                tax = (item.discount_amount !== 0) ? discountTaxes : taxes\r\n                item['subtotal'] = (item.old_price - getInclusiveTax(item.old_price, item.TaxClass)) * item.quantity\r\n                item['total'] = price;\r\n                item['total_tax'] = tax;\r\n                item['subtotal_tax'] = tax;\r\n            })\r\n            all_products = products;\r\n            break;\r\n        // case 4\r\n        case 4:\r\n            products.map(item => {\r\n                price = (item.discount_amount !== 0) ? item.after_discount : (item.old_price - getInclusiveTax(item.old_price, item.TaxClass)) * item.quantity;\r\n                var taxes = [];\r\n                var update_discount_tax = null;\r\n                var priceIs =  ((item.discount_amount !== 0) ? item.after_discount : item.old_price*item.quantity);\r\n                var discountTaxes = [];\r\n                var singleTaxAmount = item.excl_tax > 0 ? item.excl_tax : 0;\r\n                //console.log(\"price\", price)\r\n                // console.log(\"singleTaxAmount\", singleTaxAmount);\r\n                if (item.TaxStatus !== 'none') {\r\n                    if (item.discount_amount !== 0) {\r\n                        update_discount_tax = getExclusiveTaxForTotal(priceIs, item.TaxClass);\r\n                    }\r\n                    var update_Ex_tax = getInclusiveTaxForTotal(item.old_price, item.TaxClass);\r\n                    update_Ex_tax.map(taxIs => {\r\n                        taxes.push({ [taxIs.id]: taxIs.price * item.quantity })\r\n                    })\r\n                    update_discount_tax && update_discount_tax.length > 0 && update_discount_tax.map(taxDis => {\r\n                        discountTaxes.push({ [taxDis.id]: taxDis.price })\r\n                    })\r\n                }\r\n                tax = (item.discount_amount !== 0) ? discountTaxes : taxes;\r\n                item['subtotal'] = (item.old_price - getInclusiveTax(item.old_price, item.TaxClass)) * item.quantity\r\n                item['total'] = price\r\n                item['total_tax'] = tax\r\n                item['subtotal_tax'] = tax;\r\n            })\r\n            break;\r\n        case 6: case 8:\r\n            products.map(item => {\r\n                price = (item.discount_amount !== 0) ? (item.old_price * item.quantity) - item.discount_amount : item.old_price * item.quantity;\r\n                var taxes = [];\r\n                var update_discount_tax = null;\r\n                var priceIs =  ((item.discount_amount !== 0) ? item.after_discount : item.old_price*item.quantity);\r\n                var discountTaxes = [];\r\n                if (item.TaxStatus !== 'none') {\r\n                    if (item.discount_amount !== 0 && item.incl_tax == 0) {\r\n                        update_discount_tax = getExclusiveTaxForTotal(priceIs, item.TaxClass);\r\n                    }\r\n                    var update_Ex_tax = getExclusiveTaxForTotal(item.old_price, item.TaxClass);\r\n                    update_Ex_tax.map(taxIs => {\r\n                        taxes.push({ [taxIs.id]: taxIs.price * item.quantity })\r\n                    })\r\n                    update_discount_tax && update_discount_tax.length > 0 && update_discount_tax.map(taxDis => {\r\n                        discountTaxes.push({ [taxDis.id]: taxDis.price })\r\n                    })\r\n                }\r\n                tax = (item.discount_amount !== 0) ? (item.incl_tax !== 0) ? item.incl_tax : discountTaxes : taxes;\r\n                item['subtotal'] = item.old_price * item.quantity\r\n                item['total'] = price\r\n                item['total_tax'] = tax\r\n                item['subtotal_tax'] = tax;\r\n            })\r\n            break;\r\n        default:\r\n            products.map(item => {\r\n                price = (item.discount_amount !== 0) ? (item.old_price * item.quantity) - exclusiveDiscount(item.after_discount, item.discount_amount, (item.old_price * item.quantity)) : item.old_price * item.quantity;\r\n                var taxes = [];\r\n                var update_discount_tax = null;\r\n                var priceIs =  ((item.discount_amount !== 0) ? item.after_discount : item.old_price)*item.quantity;\r\n                var discountTaxes = [];\r\n                if (item.TaxStatus !== 'none') {\r\n                    if (item.discount_amount !== 0 && item.incl_tax !== 0) {\r\n                        update_discount_tax = getInclusiveTaxForTotal(priceIs, item.TaxClass);\r\n                    }\r\n                    var update_Ex_tax = getExclusiveTaxForTotal(item.old_price, item.TaxClass);\r\n                    update_Ex_tax.map(taxIs => {\r\n                        taxes.push({ [taxIs.id]: taxIs.price * item.quantity })\r\n                    })\r\n                    update_discount_tax && update_discount_tax.length > 0 && update_discount_tax.map(taxDis => {\r\n                        discountTaxes.push({ [taxDis.id]: taxDis.price })\r\n                    })\r\n                }\r\n                tax = (item.discount_amount !== 0) ? (item.incl_tax !== 0) ? discountTaxes : item.excl_tax : taxes;\r\n                item['subtotal'] = item.old_price * item.quantity\r\n                item['total'] = price\r\n                item['total_tax'] = tax\r\n                item['subtotal_tax'] = tax;\r\n            })\r\n            all_products = products;\r\n            break;\r\n    }    \r\n    return all_products\r\n}\r\n\r\nexport const productPriceWithTax = (price, condition, taxclass) => {\r\n    var deafult_tax = localStorage.getItem('APPLY_DEFAULT_TAX') ? JSON.parse(localStorage.getItem(\"APPLY_DEFAULT_TAX\")) : null;\r\n    var selected_tax = localStorage.getItem('TAXT_RATE_LIST') ? JSON.parse(localStorage.getItem(\"TAXT_RATE_LIST\")) : null;\r\n    var apply_defult_tax = localStorage.getItem('DEFAULT_TAX_STATUS') ? localStorage.getItem('DEFAULT_TAX_STATUS') : null;\r\n    var TaxRate = apply_defult_tax == \"true\" ? deafult_tax : selected_tax;\r\n    var tax_rate = 0;\r\n    var actual_price = 0;\r\n    if (TaxRate && TaxRate.length > 0) {\r\n        TaxRate.map(addTax => {\r\n            if (addTax.check_is == true) {\r\n                if (taxclass == addTax.TaxClass && apply_defult_tax == \"true\") {\r\n                    tax_rate += parseFloat(addTax.TaxRate)\r\n                }\r\n                if (apply_defult_tax == \"false\") {\r\n                    tax_rate += parseFloat(addTax.TaxRate);\r\n                }\r\n            }\r\n        })\r\n    }\r\n    if (condition == '3' || condition == '4')\r\n        return actual_price = parseFloat(price) / ((tax_rate / 100) + 1);\r\n    else\r\n        return actual_price = parseFloat((parseFloat(price) * tax_rate) / 100) + parseFloat(price);\r\n}\r\n\r\nexport const typeOfTax = () => {\r\n    var TAX_CASE = getSettingCase();\r\n    var TAX_IS = \"Tax\";\r\n    switch (TAX_CASE) {\r\n        case 1: case 3: case 5: case 7:\r\n            TAX_IS = \"incl\";\r\n            break;\r\n        default:\r\n            TAX_IS = \"Tax\";\r\n            break;\r\n    }\r\n    return TAX_IS\r\n}\r\n// Apply tax when show product list on shop \r\nexport const getTaxAllProduct = (products) => {\r\n    var all_products = [];\r\n    var price = 0;\r\n    var TAX_CASE = getSettingCase();\r\n    //console.log(\"TAX_CASE\", TAX_CASE)\r\n    switch (TAX_CASE) {\r\n        //  case 1  \r\n        case 1: case 2: case 7: case 8:\r\n            if(products && products !== null && products !== undefined){\r\n                products.map(item => {\r\n                    item['old_price'] = item.Price\r\n                })\r\n            }\r\n            all_products = products;\r\n            break;\r\n        case 3: case 4: case 5: case 6:\r\n            products &&  products.map(item => {\r\n                item['old_price'] = item.Price;\r\n                if (item.TaxStatus !== \"none\") {\r\n                    price = productPriceWithTax(item.Price, TAX_CASE, item.TaxClass)\r\n                    item['Price'] = parseFloat(price)\r\n                }\r\n            })\r\n            all_products = products;\r\n            break;\r\n        default:\r\n            products && products.map(item => {\r\n                item['old_price'] = item.Price\r\n            })\r\n            all_products = products;\r\n            break;\r\n    }\r\n\r\n    return all_products\r\n}\r\n\r\nexport const cartPriceWithTax = (price, condition, taxclass) => {\r\n    //console.log(\"cartPriceWithTax\", price, condition)\r\n    var deafult_tax = localStorage.getItem('APPLY_DEFAULT_TAX') ? JSON.parse(localStorage.getItem(\"APPLY_DEFAULT_TAX\")) : null;\r\n    var selected_tax = localStorage.getItem('TAXT_RATE_LIST') ? JSON.parse(localStorage.getItem(\"TAXT_RATE_LIST\")) : null;\r\n    var apply_defult_tax = localStorage.getItem('DEFAULT_TAX_STATUS') ? localStorage.getItem('DEFAULT_TAX_STATUS') : null;\r\n    var TaxRate = apply_defult_tax == \"true\" ? deafult_tax : selected_tax;\r\n    var tax_rate = 0;\r\n    var actual_price = 0;\r\n    if (TaxRate && TaxRate.length > 0) {\r\n        TaxRate.map(addTax => {\r\n            if (addTax.check_is == true) {\r\n                if (taxclass == addTax.TaxClass && apply_defult_tax == \"true\") {\r\n                    tax_rate += parseFloat(addTax.TaxRate);\r\n                }\r\n                if (apply_defult_tax == \"false\") {\r\n                    tax_rate += parseFloat(addTax.TaxRate);\r\n                }\r\n            }\r\n        })\r\n    }\r\n     ///--- for default tax and have other then standerd class\r\n     if(tax_rate==0 && apply_defult_tax == \"true\"){\r\n        if (selected_tax && Array.isArray(selected_tax)==true && selected_tax.length > 0) {\r\n            selected_tax.map(addTax => {                 \r\n                    if (taxclass == addTax.TaxClass) {\r\n                        tax_rate = parseFloat(addTax.TaxRate);\r\n                }\r\n            })\r\n        }  \r\n    }\r\n\r\n    if (condition == '7')\r\n        return actual_price = parseFloat((parseFloat(price) * tax_rate) / 100) + parseFloat(price);\r\n    else if (condition == '2' || condition == '4')\r\n        return actual_price = parseFloat(price) / ((tax_rate / 100) + 1);\r\n    else\r\n        return actual_price = parseFloat(price) - parseFloat((parseFloat(price) * tax_rate) / 100);\r\n}\r\n// Apply tax when product add on cart\r\n// updated by: Nagendra\r\n// udated Date: 19 May 2020\r\n// Description: Remove the prodcut id to get tax  due to custome fee may be taxable and custome fee donot have product id.........\r\nexport const getTaxCartProduct = (products) => {\r\n    //console.log(\"getTaxCartProduct\",products)\r\n    var TAX_CASE = getSettingCase();\r\n    //console.log(\"TAX_CASE\", TAX_CASE)\r\n    var all_products = [];\r\n    var price = 0;\r\n    var incl_tax = 0;\r\n    var excl_tax = 0;\r\n    switch (TAX_CASE) {\r\n        // case 1\r\n        case 1:\r\n            products.map(item => {\r\n                incl_tax = 0;\r\n                if ( item.TaxStatus !== \"none\" ) {//item.product_id &&\r\n                    if( item.isTaxable ==true){\r\n                         incl_tax = getInclusiveTax(item.after_discount && item.after_discount>0?item.after_discount : item.old_price, item.TaxClass)\r\n                    }                   \r\n                    item['incl_tax'] = incl_tax //* item.quantity\r\n                }\r\n            })\r\n            all_products = products;\r\n            break;\r\n        // case 2\r\n        case 2:\r\n            products.map(item => {\r\n                excl_tax = 0;\r\n                price = 0;\r\n                if (item.TaxStatus !== \"none\") {//item.product_id && \r\n                    price=item.old_price;\r\n                    if( item.isTaxable ==true){\r\n                    excl_tax = getInclusiveTax(item.old_price, item.TaxClass)\r\n                    price = cartPriceWithTax(item.old_price, 2, item.TaxClass)\r\n                    }\r\n                    item['Price'] = price * item.quantity\r\n                    item['excl_tax'] = excl_tax * item.quantity\r\n                }\r\n            })\r\n            all_products = products;\r\n            break;\r\n        // case 3\r\n        case 3:\r\n            products && products.map(item => {\r\n                incl_tax = 0;\r\n                price = 0;\r\n                if (item.TaxStatus !== \"none\") { //item.product_id &&\r\n                    price=item.old_price;\r\n                    if( item.isTaxable ==true){\r\n                    incl_tax = getInclusiveTax(item.old_price, item.TaxClass)\r\n                    item['Price'] = item.old_price * item.quantity\r\n                    }\r\n                    item['incl_tax'] = incl_tax * item.quantity\r\n                }\r\n            })\r\n            all_products = products;\r\n            break;\r\n        // case 4\r\n        case 4:\r\n            products && products.map(item => {\r\n                excl_tax = 0;\r\n                price = 0;\r\n                if (item.TaxStatus !== \"none\") { //item.product_id && \r\n                    price=item.old_price;\r\n                    if( item.isTaxable ==true){\r\n                    excl_tax = getInclusiveTax(item.old_price, item.TaxClass)\r\n                    price = cartPriceWithTax(item.old_price, 4, item.TaxClass);\r\n                    }\r\n                    item['Price'] = price * item.quantity\r\n                    item['excl_tax'] = excl_tax * item.quantity\r\n                }\r\n            })\r\n            all_products = products;\r\n            break;\r\n        // case 5\r\n        case 5:\r\n            products.map(item => {\r\n                incl_tax = 0;\r\n                price = 0;\r\n                if ( item.TaxStatus !== \"none\") { //item.product_id &&\r\n                    if( item.isTaxable ==true){\r\n                    incl_tax = getExclusiveTax(item.old_price, item.TaxClass)\r\n                    }\r\n                    item['Price'] = item.Price\r\n                    item['incl_tax'] = incl_tax * item.quantity\r\n                }\r\n            })\r\n            all_products = products;\r\n            break;\r\n        // case 6\r\n        case 6:\r\n            products && products.map(item => {\r\n                excl_tax = 0;\r\n                price = 0;\r\n                if (item.TaxStatus !== \"none\") { //item.product_id && \r\n                    if( item.isTaxable ==true){\r\n                    excl_tax = getExclusiveTax(item.old_price, item.TaxClass)\r\n                    }\r\n                    item['Price'] = item.old_price * item.quantity\r\n                    item['excl_tax'] = excl_tax * item.quantity\r\n                }\r\n            })\r\n            all_products = products;\r\n            break;\r\n        // case 7\r\n        case 7:\r\n            products && products.map(item => {\r\n                incl_tax = 0;\r\n                price = 0;\r\n                if ( item.TaxStatus !== \"none\") {//item.product_id &&\r\n                    price = item.old_price;\r\n                    if( item.isTaxable ==true){\r\n                    price = cartPriceWithTax(item.old_price, 7, item.TaxClass)\r\n                    incl_tax = getExclusiveTax(item.old_price, item.TaxClass)\r\n                    }\r\n                    item['Price'] = price * item.quantity\r\n                    item['incl_tax'] = incl_tax * item.quantity\r\n                }\r\n            })\r\n            all_products = products;\r\n            break;\r\n        // case 8\r\n        default:\r\n            products && products.map(item => {  \r\n                excl_tax = 0;              \r\n                //item.product_id &&\r\n                if ( item.TaxStatus !== \"none\") {\r\n                    if( item.isTaxable ==true){\r\n                    excl_tax = getExclusiveTax(item.old_price, item.TaxClass)\r\n                    }\r\n                    item['excl_tax'] = excl_tax * item.quantity;\r\n                }\r\n            })\r\n            all_products = products;\r\n            break;\r\n    }\r\n    return all_products\r\n}\r\n\r\nexport const inclusiveDiscount = (after_discount, discount_amount, old_price,TaxClass) => {\r\n    var subtotal = old_price - getInclusiveTax(old_price,TaxClass);\r\n    var price = after_discount + discount_amount;\r\n    var discount = (discount_amount * 100.00) / price;\r\n    var get_discount = (subtotal * discount) / 100.00;\r\n    return get_discount;\r\n}\r\n\r\nexport const exclusiveDiscount = (after_discount, discount_amount, old_price) => {\r\n    var subtotal = old_price\r\n    var price = after_discount + discount_amount;\r\n    var discount = (discount_amount * 100.00) / price;\r\n    var get_discount = (subtotal * discount) / 100.00;\r\n    return get_discount;\r\n}\r\n// apply discount when finaly payment save\r\nexport const getDiscountAmount = (products) => {\r\n    var TAX_CASE = getSettingCase()\r\n    var discountIs = 0;\r\n    var after_discount = 0;\r\n    var discount_amount = 0;\r\n    var old_price = 0;\r\n    var TaxClass=\"\";\r\n    switch (TAX_CASE) {\r\n        //  case 1  \r\n        case 1: case 2: case 3: case 4:\r\n            products.map(item => {\r\n                if (item.discount_amount !== 0){\r\n                   var afterDiscount=item.after_discount !==0?item.after_discount: item.product_after_discount* item.quantity;\r\n                    after_discount += afterDiscount;\r\n                }\r\n                else {\r\n                    after_discount += item.Price;\r\n                }\r\n                if(item.discount_type=='Percentage'){\r\n                        var inclTax=getInclusiveTax(item.old_price,item.TaxClass);\r\n                        discount_amount +=percentWiseDiscount(item.old_price-inclTax, item.new_product_discount_amount) * item.quantity;\r\n                        discountIs =discount_amount;\r\n                    }else if(item.discount_type=='Number'){\r\n                        discount_amount += item.discount_amount;\r\n                        discountIs = inclusiveDiscount(after_discount, discount_amount, old_price, TaxClass);\r\n                }\r\n                old_price += item.old_price * item.quantity;\r\n                TaxClass=item.TaxClass;\r\n            })\r\n           \r\n            break;\r\n        // case 5\r\n        case 6: case 8:\r\n            products.map(item => {\r\n                discountIs += item.discount_amount;\r\n            })\r\n            break;\r\n\r\n        default:\r\n            products.map(item => {\r\n                if (item.discount_amount !== 0)\r\n                    after_discount += item.after_discount;\r\n                else {\r\n                    after_discount += item.Price;\r\n                }\r\n                discount_amount += item.discount_amount;\r\n                old_price += item.old_price * item.quantity;\r\n            })\r\n            discountIs = exclusiveDiscount(after_discount, discount_amount, old_price)\r\n            break;\r\n    }\r\n\r\n    return discountIs\r\n}\r\n// case for all type of shop tax setting\r\nexport const getSettingCase = () => {\r\n    var TaxSetting = localStorage.getItem(\"TAX_SETTING\") ? JSON.parse(localStorage.getItem(\"TAX_SETTING\")) : null;\r\n    var all_products = [];\r\n    var prices_include_tax = TaxSetting ? TaxSetting.pos_prices_include_tax : 'no';\r\n    var tax_display_shop = TaxSetting ? TaxSetting.pos_tax_display_shop : 'excl';\r\n    var tax_display_cart = TaxSetting ? TaxSetting.pos_tax_display_cart : 'excl';\r\n    var tax_round_at_subtotal = TaxSetting ? TaxSetting.pos_tax_round_at_subtotal : 'no';\r\n    var tax_case = 0;\r\n\r\n    switch (true) {\r\n        //  case 1  \r\n        case (prices_include_tax == \"yes\" && tax_display_shop == \"incl\" && tax_display_cart == \"incl\"):\r\n            tax_case = 1;\r\n            break;\r\n        // case 2\r\n        case (prices_include_tax == \"yes\" && tax_display_shop == \"incl\" && tax_display_cart == \"excl\"):\r\n            tax_case = 2;\r\n            break;\r\n        // case 3\r\n        case (prices_include_tax == \"yes\" && tax_display_shop == \"excl\" && tax_display_cart == \"incl\"):\r\n            tax_case = 3;\r\n            break;\r\n        // case 4\r\n        case (prices_include_tax == \"yes\" && tax_display_shop == \"excl\" && tax_display_cart == \"excl\"):\r\n            tax_case = 4;\r\n            break;\r\n        // case 5\r\n        case (prices_include_tax == \"no\" && tax_display_shop == \"incl\" && tax_display_cart == \"incl\"):\r\n            tax_case = 5;\r\n            break;\r\n        // case 6\r\n        case (prices_include_tax == \"no\" && tax_display_shop == \"incl\" && tax_display_cart == \"excl\"):\r\n            tax_case = 6;\r\n            break;\r\n        // case 7\r\n        case (prices_include_tax == \"no\" && tax_display_shop == \"excl\" && tax_display_cart == \"incl\"):\r\n            tax_case = 7;\r\n            break;\r\n        // case 8\r\n        default:\r\n            tax_case = 8;\r\n            break;\r\n    }\r\n    return tax_case\r\n}\r\n\r\nexport const changeTaxRate = (item, status) => {\r\n    var array_of_tax = [];\r\n    if (item) {\r\n\r\n        item && item.map(items => {\r\n            if (items.check_is == true) {\r\n                array_of_tax.push(items);\r\n            }\r\n\r\n        })\r\n        if (array_of_tax && array_of_tax.length > 0) {\r\n            localStorage.setItem('DEFAULT_TAX_STATUS', false)\r\n        }\r\n        localStorage.setItem(\"TAXT_RATE_LIST\", JSON.stringify(array_of_tax));\r\n    }\r\n    var products = localStorage.getItem(\"CARD_PRODUCT_LIST\") ? JSON.parse(localStorage.getItem(\"CARD_PRODUCT_LIST\")) : [];\r\n    var updateTax = getTaxCartProduct(products);\r\n    return updateTax;\r\n}\r\n\r\nexport const RoundAmount = (val) => {\r\n    //return Math.round(val * 100) / 100;\r\n    var decimals = 2;\r\n    return Number(Math.round(val + 'e' + decimals) + 'e-' + decimals);\r\n}\r\n\r\n/**\r\n * Created BY : Shakuntala Jatav\r\n * Created Date : 28-Feb-2020\r\n * @param {*} productx get product-x data\r\n * @param {*} product_list get product list array\r\n * Description : Apply taxes on chlid product of productx data\r\n */\r\nexport const getProductxChlidProductTax = (productx, product_list) => {\r\n    productx.map(prdx => {\r\n        if (prdx.composite_data) {\r\n            var productXArray = setProductxTax(prdx.composite_data, product_list);\r\n            prdx['composite_data'] = productXArray;\r\n        }\r\n        if (prdx.stamp) {\r\n            var productXArray = setProductxTax(prdx.stamp, product_list);\r\n            prdx['stamp'] = productXArray;\r\n        }\r\n    })\r\n    return productx;\r\n}\r\n\r\n/**\r\n * Created BY : Shakuntala Jatav\r\n * Created Date : 02-03-2020\r\n * @param {*} productx \r\n * @param {*} product_list \r\n * Description : Prepair taxes on chlid product of productx data\r\n */\r\nexport const setProductxTax = (productx, product_list) => {\r\n    Object.keys(productx).map(i => {\r\n        var findProductValue = product_list.filter(_item => (productx[i].variation_id ? (_item.WPID == productx[i].variation_id && _item.ParentId == productx[i].product_id && productx[i].quantity > 0) : (_item.WPID == productx[i].product_id) && productx[i].quantity > 0));\r\n        if (findProductValue && findProductValue.length > 0) {\r\n            findProductValue[0]['quantity'] = productx[i].quantity;\r\n            findProductValue[0]['product_id'] = productx[i].product_id;\r\n            findProductValue[0]['variation_id'] = productx[i].variation_id ? productx[i].variation_id : 0;\r\n            findProductValue[0]['discount_amount'] = productx[i].discount ? productx[i].discount : 0;\r\n            findProductValue[0]['after_discount'] = productx[i].discount ? parseFloat(findProductValue[0].Price * Number(productx[i].quantity)) - parseFloat(productx[i].discount) : 0;\r\n\r\n            var setProducts = getTaxAllProduct(findProductValue);\r\n            var products = getTaxCartProduct(setProducts);\r\n            var taxWithProductx = getCheckoutList(products);\r\n            if (products && products.length > 0) {\r\n                productx[i]['line_subtotal'] = products[0].subtotal;\r\n                productx[i]['line_total'] = products[0].total;\r\n                productx[i]['line_tax'] = products[0].total_tax;\r\n                productx[i]['line_subtotal_tax'] = products[0].subtotal_tax;\r\n            }\r\n        }\r\n    })\r\n    //console.log(\"productx updated tax\", productx);\r\n    return productx;\r\n}\r\n/**\r\n * Created By : Shakuntala Jatav\r\n * Creatted Date : 13-03-2020\r\n * @param {*} type \r\n * Description : Showing Tax Rate with name\r\n */\r\n\r\nexport const getTotalTaxByName = (type, productx_line_items) => {\r\n    var placedOrderList = (type == 'completecheckout') ? localStorage.getItem('placedOrderList') ? JSON.parse(localStorage.getItem('placedOrderList')) : null : type;\r\n    //var selected_taxrate_list = localStproductx_line_itemsorage.getItem('SELECTED_TAX') ? JSON.parse(localStorage.getItem('SELECTED_TAX')) : null;\r\n    //SHOP_TAXRATE_LIST\r\n    var selected_taxrate_list = localStorage.getItem('SHOP_TAXRATE_LIST') ? JSON.parse(localStorage.getItem('SHOP_TAXRATE_LIST')) : null;\r\n    var total_taxrate_name = [];\r\n    var total_taxrate_ids = [];\r\n    if (productx_line_items && productx_line_items.length > 0) {\r\n        productx_line_items.map(itemx => {\r\n            if (itemx.line_total_taxes && itemx.line_total_taxes.length > 0) {\r\n                itemx.line_total_taxes.map(subitemx => {\r\n                    total_taxrate_ids.push(subitemx)\r\n                })\r\n            }\r\n        })\r\n    }\r\n    if (placedOrderList && placedOrderList.length > 0) {\r\n        placedOrderList.map(item => {\r\n            if (item.total_taxes && item.total_taxes.length > 0) {\r\n                item.total_taxes.map(subitem => {\r\n                    total_taxrate_ids.push(subitem)\r\n                })\r\n            }\r\n            if (type !== \"completecheckout\") {\r\n                var Taxes = item.Taxes.replace(/^\\/?|\\/?$/, \"\");\r\n                const object1 = JSON.parse(Taxes);\r\n                if (object1) {\r\n                    for (var [key, value] of Object.entries(object1.total)) {\r\n                        total_taxrate_ids.push({ [key]: value })\r\n                    }\r\n                }\r\n            }\r\n        })\r\n    }\r\n    if (total_taxrate_ids && total_taxrate_ids.length > 0) {\r\n        for (var i = 0; i < total_taxrate_ids.length; i++) {\r\n            for (var key in total_taxrate_ids[i]) {\r\n                var filterSelectedTaxRateList = selected_taxrate_list && selected_taxrate_list.filter(match => (match.TaxId == key));\r\n                if (filterSelectedTaxRateList && filterSelectedTaxRateList.length > 0) {\r\n                    var tax_id = filterSelectedTaxRateList[0].TaxId;\r\n                    var tax_name = filterSelectedTaxRateList[0].TaxName;\r\n                    var tax_TaxRate = filterSelectedTaxRateList[0].TaxRate;\r\n                    var tax_amount = parseFloat(total_taxrate_ids[i][key]);\r\n                    var filterValue = total_taxrate_name && total_taxrate_name.find(_match => (_match.tax_id == tax_id));\r\n                    if (filterValue) {\r\n                        total_taxrate_name.map(item => {\r\n                            if (item.tax_id == tax_id) {\r\n                                item['tax_amount'] += tax_amount;\r\n                                \r\n                            }\r\n                        })\r\n                    }\r\n                    if (!filterValue) {\r\n                        total_taxrate_name.push({ 'tax_id': tax_id, 'tax_name': tax_name, 'tax_amount': tax_amount,'TaxRate':tax_TaxRate })\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        //console.log(\"total_taxrate_name\", total_taxrate_name);\r\n    }\r\n    return total_taxrate_name;\r\n}\r\n\r\nfunction percentWiseDiscount(price, discount) {\r\n    var discountAmount = (price * discount) / 100.00;\r\n    return discountAmount;\r\n}\r\n/**\r\n * Created By : Shakuntala jatav\r\n * Created Date : 06-04-2020\r\n * @param {*} item \r\n * @param {*} qty \r\n * Description : 1. for caculate tax varition poup modal\r\n                 2. Apply tax when product add on cart\r\n */\r\n\r\nexport const getVariatioModalProduct = (item, qty) => {\r\n    //console.log(\"getVariatioModalProduct\", item, qty)\r\n\r\n    if (item.isTaxable==false){\r\n        return item;\r\n    }\r\n    var TAX_CASE = getSettingCase();\r\n    //console.log(\"TAX_CASE\", TAX_CASE)\r\n    var all_products = [];\r\n    var price = 0;\r\n    var incl_tax = 0;\r\n    var excl_tax = 0;\r\n    var discount_amount = item.product_discount_amount ? parseFloat(item.product_discount_amount) : 0;\r\n    var after_discount_price = 0;\r\n    switch (TAX_CASE) {\r\n        // case 1\r\n        case 1:\r\n            if (item.WPID && item.TaxStatus !== \"none\") {\r\n                //after_discount_price = item.old_price - discount_amount;\r\n                incl_tax = getInclusiveTax(item.old_price, item.TaxClass)               \r\n                if(item.discount_type == \"Percentage\") {\r\n                  var  productDiscount=percentWiseDiscount(item.old_price-incl_tax, item.new_product_discount_amount)* qty;\r\n                  after_discount_price =  ((item.old_price-incl_tax) * qty) - productDiscount\r\n                }  else{\r\n                    after_discount_price =  ((item.old_price-incl_tax) * qty) - discount_amount;\r\n                }\r\n                if(item.discount_type == \"Percentage\" ){\r\n                    incl_tax = getInclusiveTax(item.old_price-discount_amount, item.TaxClass)\r\n                }else{\r\n                    incl_tax = getInclusiveTax((item.old_price * qty )-discount_amount, item.TaxClass)\r\n                }\r\n\r\n                //incl_tax = getInclusiveTax(after_discount_price, item.TaxClass)\r\n                //item['Price'] = after_discount_price * qty\r\n                item['incl_tax'] = item.discount_type == \"Percentage\" ? incl_tax * qty : incl_tax;\r\n                // ******** comented below line  to solve qty * issue on after discount *****//\r\n                // **tst** item['after_discount'] = item.discount_type == \"Percentage\" ? after_discount_price * qty : after_discount_price;\r\n\r\n                //**tst** remove qty multiplication from after discount\r\n                item['after_discount'] = after_discount_price;\r\n            }\r\n            all_products = item;\r\n            break;\r\n        // case 2\r\n        case 2:\r\n            if (item.WPID && item.TaxStatus !== \"none\") {\r\n                //after_discount_price = item.old_price - discount_amount;               \r\n                if(item.discount_type == \"Percentage\") {\r\n                    var  productDiscount=percentWiseDiscount(item.old_price-incl_tax, item.new_product_discount_amount)* qty;\r\n                    after_discount_price =  ((item.old_price-incl_tax) * qty) - productDiscount\r\n                  }  else{\r\n                      after_discount_price =  ((item.old_price-incl_tax) * qty) - discount_amount;\r\n                  }\r\n                  if(item.discount_type == \"Percentage\" ){\r\n                    excl_tax = getInclusiveTax(item.old_price-discount_amount, item.TaxClass)\r\n                    }else{\r\n                        excl_tax = getInclusiveTax((item.old_price * qty )-discount_amount, item.TaxClass)\r\n                    }\r\n                \r\n                  price = cartPriceWithTax(after_discount_price, 2, item.TaxClass)\r\n                //item['Price'] = price * qty\r\n                item['excl_tax'] = item.discount_type == \"Percentage\" ? excl_tax * qty : excl_tax;\r\n                item['after_discount'] = after_discount_price;\r\n            }\r\n            all_products = item;\r\n            break;\r\n        // case 3\r\n        case 3:\r\n            if (item.WPID && item.TaxStatus !== \"none\") {\r\n                //after_discount_price = item.old_price - discount_amount;\r\n                if(item.discount_type == \"Percentage\") {\r\n                    var  productDiscount=percentWiseDiscount(item.old_price-incl_tax, item.new_product_discount_amount)* qty;\r\n                    after_discount_price =  ((item.old_price-incl_tax) * qty) - productDiscount\r\n                  }  else{\r\n                    after_discount_price = item.discount_type == \"Percentage\" ? item.old_price - discount_amount : (item.old_price * qty) - discount_amount;\r\n                  }\r\n                  if(item.discount_type == \"Percentage\" ){\r\n                    incl_tax = getInclusiveTax(item.old_price-discount_amount, item.TaxClass)\r\n                    }else{\r\n                        incl_tax = getInclusiveTax((item.old_price * qty )-discount_amount, item.TaxClass)\r\n                    }  \r\n                 \r\n                //item['Price'] = after_discount_price * qty\r\n                item['incl_tax'] = item.discount_type == \"Percentage\" ? incl_tax * qty : incl_tax;\r\n                item['after_discount'] = after_discount_price;\r\n            }\r\n            all_products = item;\r\n            break;\r\n        // case 4\r\n        case 4:\r\n            if (item.WPID && item.TaxStatus !== \"none\") {\r\n                //after_discount_price = item.old_price - discount_amount;\r\n                if(item.discount_type == \"Percentage\") {\r\n                    var  productDiscount=percentWiseDiscount(item.old_price-incl_tax, item.new_product_discount_amount)* qty;\r\n                    after_discount_price =  ((item.old_price-incl_tax) * qty) - productDiscount\r\n                  }  else{\r\n                    after_discount_price = item.discount_type == \"Percentage\" ? item.old_price - discount_amount : (item.old_price * qty) - discount_amount;\r\n                  }\r\n                  if(item.discount_type == \"Percentage\" ){\r\n                    excl_tax = getInclusiveTax(item.old_price-discount_amount, item.TaxClass)\r\n                    }else{\r\n                        excl_tax = getInclusiveTax((item.old_price * qty )-discount_amount, item.TaxClass)\r\n                    }\r\n                price = cartPriceWithTax(after_discount_price, 4, item.TaxClass);\r\n                //item['Price'] = price * qty\r\n                item['excl_tax'] = item.discount_type == \"Percentage\" ? excl_tax * qty : excl_tax;;\r\n                item['after_discount'] = after_discount_price;\r\n            }\r\n            all_products = item;\r\n            break;\r\n        // case 5\r\n        case 5:\r\n            if (item.WPID && item.TaxStatus !== \"none\") {\r\n                //after_discount_price = item.old_price - discount_amount;\r\n                if(item.discount_type == \"Percentage\") {\r\n                    var  productDiscount=percentWiseDiscount(item.old_price-incl_tax, item.new_product_discount_amount)* qty;\r\n                    after_discount_price =  ((item.old_price-incl_tax) * qty) - productDiscount\r\n                  }  else{\r\n                    after_discount_price = item.discount_type == \"Percentage\" ? item.old_price - discount_amount : (item.old_price * qty) - discount_amount;\r\n                  }\r\n                  if(item.discount_type == \"Percentage\" ){\r\n                    incl_tax = getExclusiveTax(item.old_price-discount_amount, item.TaxClass)\r\n                    }else{\r\n                        incl_tax = getExclusiveTax((item.old_price * qty )-discount_amount, item.TaxClass)\r\n                    }\r\n                 \r\n                //item['Price'] = item.Price * qty\r\n                item['incl_tax'] = item.discount_type == \"Percentage\" ? incl_tax * qty : incl_tax;\r\n                item['after_discount'] = after_discount_price;\r\n            }\r\n            all_products = item;\r\n            break;\r\n        // case 6\r\n        case 6:\r\n            if (item.WPID && item.TaxStatus !== \"none\") {\r\n                //after_discount_price = item.old_price - discount_amount;\r\n                if(item.discount_type == \"Percentage\") {\r\n                    var  productDiscount=percentWiseDiscount(item.old_price-incl_tax, item.new_product_discount_amount)* qty;\r\n                    after_discount_price =  ((item.old_price-incl_tax) * qty) - productDiscount\r\n                  }  else{\r\n                    after_discount_price = item.discount_type == \"Percentage\" ? item.old_price - discount_amount : (item.old_price * qty) - discount_amount;\r\n                  }\r\n\r\n                  if(item.discount_type == \"Percentage\" ){\r\n                    excl_tax = getExclusiveTax(item.old_price-discount_amount, item.TaxClass)\r\n                }else{\r\n                  excl_tax = getExclusiveTax(after_discount_price, item.TaxClass)\r\n                }\r\n                //item['Price'] = after_discount_price * old_price\r\n                item['excl_tax'] = item.discount_type == \"Percentage\" ? excl_tax * qty : excl_tax;;\r\n                item['after_discount'] = after_discount_price;\r\n            }\r\n            all_products = item;\r\n            break;\r\n        // case 7\r\n        case 7:\r\n            if (item.WPID && item.TaxStatus !== \"none\") {\r\n                //after_discount_price = item.old_price - discount_amount;\r\n                if(item.discount_type == \"Percentage\") {\r\n                    var  productDiscount=percentWiseDiscount(item.old_price-incl_tax, item.new_product_discount_amount)* qty;\r\n                    after_discount_price =  ((item.old_price-incl_tax) * qty) - productDiscount\r\n                  }  else{\r\n                    after_discount_price = item.discount_type == \"Percentage\" ? item.old_price - discount_amount : (item.old_price * qty) - discount_amount;\r\n                  }\r\n                price = cartPriceWithTax(after_discount_price, 7, item.TaxClass)\r\n                if(item.discount_type == \"Percentage\" ){\r\n                    incl_tax = getExclusiveTax(item.old_price-discount_amount, item.TaxClass)\r\n                }else{\r\n                    incl_tax = getExclusiveTax(after_discount_price, item.TaxClass)\r\n                }\r\n                //item['Price'] = price * qty\r\n                item['incl_tax'] = item.discount_type == \"Percentage\" ? incl_tax * qty : incl_tax;\r\n                item['after_discount'] = after_discount_price;\r\n            }\r\n            all_products = item;\r\n            break;\r\n        // case 8\r\n        default:\r\n            if (item.WPID && item.TaxStatus !== \"none\") {\r\n                if(item.discount_type == \"Percentage\") {\r\n                    var  productDiscount=percentWiseDiscount(item.old_price-incl_tax, item.new_product_discount_amount)* qty;\r\n                    after_discount_price =  ((item.old_price-incl_tax) * qty) - productDiscount\r\n                  }  else{\r\n                after_discount_price = item.discount_type == \"Percentage\" ? item.old_price - discount_amount : (item.old_price * qty) - discount_amount;\r\n                  }\r\n                  if(item.discount_type == \"Percentage\" ){\r\n                    excl_tax = getExclusiveTax(item.old_price-discount_amount, item.TaxClass)\r\n                }else{\r\n                    excl_tax = getExclusiveTax(after_discount_price, item.TaxClass)\r\n                }\r\n                //item['Price'] = after_discount_price * qty\r\n                item['excl_tax'] = item.discount_type == \"Percentage\" ? excl_tax * qty : excl_tax;\r\n                item['after_discount'] = after_discount_price;\r\n            }\r\n            all_products = item;\r\n            break;\r\n    }\r\n    return all_products\r\n}\r\n\r\nexport const TaxSetting = {\r\n    getTaxAllProduct, productPriceWithTax, getTaxCartProduct, cartPriceWithTax, getInclusiveTax, getExclusiveTax, getCheckoutList, getDiscountAmount, getSettingCase, typeOfTax, changeTaxRate, getExtensionCheckoutList, setListActivityToCheckout, RoundAmount,\r\n    getProductxChlidProductTax, getTotalTaxByName\r\n}\r\nexport default TaxSetting;"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,OAAO,MAAMA,eAAe,GAAG,CAACC,KAAD,EAAQC,QAAR,KAAqB;EAChD;EACA,IAAIC,WAAW,GAAGC,YAAY,CAACC,OAAb,CAAqB,mBAArB,IAA4CC,IAAI,CAACC,KAAL,CAAWH,YAAY,CAACC,OAAb,CAAqB,mBAArB,CAAX,CAA5C,GAAoG,IAAtH;EACA,IAAIG,YAAY,GAAGJ,YAAY,CAACC,OAAb,CAAqB,gBAArB,IAAyCC,IAAI,CAACC,KAAL,CAAWH,YAAY,CAACC,OAAb,CAAqB,gBAArB,CAAX,CAAzC,GAA8F,IAAjH;EACA,IAAII,gBAAgB,GAAGL,YAAY,CAACC,OAAb,CAAqB,oBAArB,IAA6CD,YAAY,CAACC,OAAb,CAAqB,oBAArB,EAA2CK,QAA3C,EAA7C,GAAqG,IAA5H;EACA,IAAIC,OAAO,GAAGF,gBAAgB,IAAI,MAApB,GAA6BN,WAA7B,GAA2CK,YAAzD,CALgD,CAMhD;;EACA,IAAII,KAAK,GAAGC,UAAU,CAACZ,KAAD,CAAtB;EACA,IAAIa,QAAQ,GAAG,CAAf;;EACA,IAAIH,OAAO,IAAIA,OAAO,CAACI,MAAR,GAAiB,CAAhC,EAAmC;IAC/BJ,OAAO,CAACK,GAAR,CAAYC,MAAM,IAAI;MAClB,IAAIA,MAAM,CAACC,QAAP,IAAmB,IAAvB,EAA6B;QACzB,IAAIhB,QAAQ,IAAIe,MAAM,CAACE,QAAnB,IAA+BV,gBAAgB,IAAI,MAAvD,EAA+D;UAC3DK,QAAQ,IAAID,UAAU,CAACI,MAAM,CAACN,OAAR,CAAtB;QACH;;QACD,IAAIF,gBAAgB,IAAI,OAAxB,EAAiC;UAC7BK,QAAQ,IAAID,UAAU,CAACI,MAAM,CAACN,OAAR,CAAtB;QACH;MACJ;IACJ,CATD;EAUH,CApB+C,CAqBhD;;;EACA,IAAGG,QAAQ,IAAE,CAAV,IAAeL,gBAAgB,IAAE,MAApC,EAA2C;IACvCD,YAAY,IAAKY,KAAK,CAACC,OAAN,CAAcb,YAAd,KAA6B,IAA9C,IAAsDA,YAAY,CAACQ,GAAb,CAAiBC,MAAM,IAAI;MACzE,IAAIf,QAAQ,IAAIe,MAAM,CAACE,QAAvB,EAAkC;QAC9BL,QAAQ,IAAID,UAAU,CAACI,MAAM,CAACN,OAAR,CAAtB;MACH;IACR,CAJqD,CAAtD;EAKH;;EACD,IAAIW,YAAY,GAAG,CAAnB;EACA,IAAIC,YAAY,GAAG,CAAnB;EACAD,YAAY,GAAGT,UAAU,CAACD,KAAD,CAAV,IAAsBE,QAAQ,GAAG,GAAZ,GAAmB,CAAxC,CAAf;EACAS,YAAY,GAAIX,KAAK,GAAGU,YAAxB;EACA,OAAOC,YAAP;AACH,CAlCM;AAoCP,OAAO,MAAMC,eAAe,GAAG,CAACvB,KAAD,EAAQC,QAAR,KAAqB;EAChD,IAAIC,WAAW,GAAGC,YAAY,CAACC,OAAb,CAAqB,mBAArB,IAA4CC,IAAI,CAACC,KAAL,CAAWH,YAAY,CAACC,OAAb,CAAqB,mBAArB,CAAX,CAA5C,GAAoG,IAAtH;EACA,IAAIG,YAAY,GAAGJ,YAAY,CAACC,OAAb,CAAqB,gBAArB,IAAyCC,IAAI,CAACC,KAAL,CAAWH,YAAY,CAACC,OAAb,CAAqB,gBAArB,CAAX,CAAzC,GAA8F,IAAjH;EACA,IAAII,gBAAgB,GAAGL,YAAY,CAACC,OAAb,CAAqB,oBAArB,IAA6CD,YAAY,CAACC,OAAb,CAAqB,oBAArB,CAA7C,GAA0F,IAAjH;EACA,IAAIM,OAAO,GAAGF,gBAAgB,IAAI,MAApB,GAA6BN,WAA7B,GAA2CK,YAAzD;EACA,IAAII,KAAK,GAAGa,WAAW,CAACxB,KAAD,CAAvB;EACA,IAAIa,QAAQ,GAAG,CAAf;;EACA,IAAIH,OAAO,IAAIA,OAAO,CAACI,MAAR,GAAiB,CAAhC,EAAmC;IAC/BJ,OAAO,CAACK,GAAR,CAAYC,MAAM,IAAI;MAClB,IAAIA,MAAM,CAACC,QAAP,IAAmB,IAAvB,EAA6B;QACzB,IAAIhB,QAAQ,IAAIe,MAAM,CAACE,QAAnB,IAA+BV,gBAAgB,IAAI,MAAvD,EAA+D;UAC3DK,QAAQ,IAAID,UAAU,CAACI,MAAM,CAACN,OAAR,CAAtB;QACH;;QACD,IAAIF,gBAAgB,IAAI,OAAxB,EAAiC;UAC7BK,QAAQ,IAAID,UAAU,CAACI,MAAM,CAACN,OAAR,CAAtB;QACH;MACJ;IACJ,CATD;EAUH,CAlB+C,CAmB9C;;;EACA,IAAGG,QAAQ,IAAE,CAAV,IAAeL,gBAAgB,IAAE,MAApC,EAA2C;IACzCD,YAAY,IAAKY,KAAK,CAACC,OAAN,CAAcb,YAAd,KAA6B,IAA9C,IAAsDA,YAAY,CAACQ,GAAb,CAAiBC,MAAM,IAAI;MACzE,IAAIf,QAAQ,IAAIe,MAAM,CAACE,QAAvB,EAAkC;QAC9BL,QAAQ,IAAID,UAAU,CAACI,MAAM,CAACN,OAAR,CAAtB;MACH;IACR,CAJqD,CAAtD;EAKH;;EACD,IAAIe,YAAY,GAAG,CAAnB;EACAA,YAAY,GAAGb,UAAU,CAAED,KAAK,GAAGE,QAAT,GAAqB,GAAtB,CAAzB;EACA,OAAOY,YAAP;AACH,CA9BM;AAgCP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,OAAO,MAAMC,uBAAuB,GAAG,CAAC1B,KAAD,EAAQC,QAAR,KAAqB;EACxD;EACA,IAAIC,WAAW,GAAGC,YAAY,CAACC,OAAb,CAAqB,mBAArB,IAA4CC,IAAI,CAACC,KAAL,CAAWH,YAAY,CAACC,OAAb,CAAqB,mBAArB,CAAX,CAA5C,GAAoG,IAAtH;EACA,IAAIG,YAAY,GAAGJ,YAAY,CAACC,OAAb,CAAqB,gBAArB,IAAyCC,IAAI,CAACC,KAAL,CAAWH,YAAY,CAACC,OAAb,CAAqB,gBAArB,CAAX,CAAzC,GAA8F,IAAjH;EACA,IAAII,gBAAgB,GAAGL,YAAY,CAACC,OAAb,CAAqB,oBAArB,IAA6CD,YAAY,CAACC,OAAb,CAAqB,oBAArB,EAA2CK,QAA3C,EAA7C,GAAqG,IAA5H;EACA,IAAIC,OAAO,GAAGF,gBAAgB,IAAI,MAApB,GAA6BN,WAA7B,GAA2CK,YAAzD;EACA,IAAIM,QAAQ,GAAG,CAAf;EACA,IAAIc,cAAc,GAAC,CAAnB;EAAqB;EACrB,IAAIN,YAAY,GAAG,CAAnB;EACA,IAAIC,YAAY,GAAG,EAAnB;EACA,IAAIM,KAAK,GAAG,CAAZ;EACA,IAAIjB,KAAK,GAAGC,UAAU,CAACZ,KAAD,CAAtB;EACA,IAAI6B,QAAQ,GAAG,CAAf;;EACA,IAAInB,OAAO,IAAIA,OAAO,CAACI,MAAR,GAAiB,CAAhC,EAAmC;IAC/BJ,OAAO,CAACK,GAAR,CAAYC,MAAM,IAAI;MAClB,IAAIA,MAAM,CAACC,QAAP,IAAmB,IAAvB,EAA6B;QACzB,IAAIhB,QAAQ,IAAIe,MAAM,CAACE,QAAnB,IAA+BV,gBAAgB,IAAI,MAAvD,EAA+D;UAC3DK,QAAQ,GAAGD,UAAU,CAACI,MAAM,CAACN,OAAR,CAArB;UACAiB,cAAc,IAAI,CAAlB;UACAC,KAAK,GAAGZ,MAAM,CAACY,KAAf,CAH2D,CAI3D;UACA;UACA;;UACCC,QAAQ,GAAGlB,KAAK,GAAGE,QAAT,GAAmB,GAA7B;UACAS,YAAY,CAACQ,IAAb,CAAkB;YAAEC,EAAE,EAAEH,KAAN;YAAa5B,KAAK,EAAE6B;UAApB,CAAlB;QACJ;;QAED,IAAIrB,gBAAgB,IAAI,OAAxB,EAAiC;UAC7BK,QAAQ,GAAGD,UAAU,CAACI,MAAM,CAACN,OAAR,CAArB;UACAiB,cAAc,IAAI,CAAlB;UACAC,KAAK,GAAGZ,MAAM,CAACY,KAAf,CAH6B,CAI7B;UACA;;UACAC,QAAQ,GAAGlB,KAAK,GAAGE,QAAT,GAAmB,GAA7B;UACAS,YAAY,CAACQ,IAAb,CAAkB;YAAEC,EAAE,EAAEH,KAAN;YAAa5B,KAAK,EAAE6B;UAApB,CAAlB;QACH;MACJ;IACJ,CAvBD;;IAyBA,IAAGF,cAAc,IAAG,CAAjB,IAAsBd,QAAQ,IAAE,CAAhC,IAAqCL,gBAAgB,IAAE,MAA1D,EAAiE;MAC7DD,YAAY,IAAKY,KAAK,CAACC,OAAN,CAAcb,YAAd,KAA6B,IAA9C,IAAsDA,YAAY,CAACQ,GAAb,CAAiBC,MAAM,IAAI;QACzE,IAAIf,QAAQ,IAAIe,MAAM,CAACE,QAAvB,EAAkC;UAC9BL,QAAQ,GAAGD,UAAU,CAACI,MAAM,CAACN,OAAR,CAArB;UACAkB,KAAK,GAAGZ,MAAM,CAACY,KAAf;UACAP,YAAY,GAAGV,KAAK,IAAKE,QAAQ,GAAG,GAAZ,GAAmB,CAAvB,CAApB;UACAgB,QAAQ,GAAGlB,KAAK,GAAGU,YAAnB,CAJ8B,CAK9B;;UACAC,YAAY,CAACQ,IAAb,CAAkB;YAAEC,EAAE,EAAEH,KAAN;YAAa5B,KAAK,EAAE6B;UAApB,CAAlB,EAN8B,CAO1B;QACP;MACR,CAVqD,CAAtD;IAWH;EACJ;;EACD,OAAOP,YAAP;AACH,CAtDM;AAuDP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,OAAO,MAAMU,uBAAuB,GAAG,CAAChC,KAAD,EAAQC,QAAR,KAAqB;EACxD;EACA,IAAIC,WAAW,GAAGC,YAAY,CAACC,OAAb,CAAqB,mBAArB,IAA4CC,IAAI,CAACC,KAAL,CAAWH,YAAY,CAACC,OAAb,CAAqB,mBAArB,CAAX,CAA5C,GAAoG,IAAtH;EACA,IAAIG,YAAY,GAAGJ,YAAY,CAACC,OAAb,CAAqB,gBAArB,IAAyCC,IAAI,CAACC,KAAL,CAAWH,YAAY,CAACC,OAAb,CAAqB,gBAArB,CAAX,CAAzC,GAA8F,IAAjH;EACA,IAAII,gBAAgB,GAAGL,YAAY,CAACC,OAAb,CAAqB,oBAArB,IAA6CD,YAAY,CAACC,OAAb,CAAqB,oBAArB,CAA7C,GAA0F,IAAjH;EACA,IAAIM,OAAO,GAAGF,gBAAgB,IAAI,MAApB,GAA6BN,WAA7B,GAA2CK,YAAzD;EACA,IAAIM,QAAQ,GAAG,CAAf;EACA,IAAIY,YAAY,GAAG,EAAnB;EACA,IAAId,KAAK,GAAGC,UAAU,CAACZ,KAAD,CAAtB;EACA,IAAI4B,KAAK,GAAG,CAAZ;EACA,IAAIC,QAAQ,GAAG,CAAf;;EACA,IAAInB,OAAO,IAAIA,OAAO,CAACI,MAAR,GAAiB,CAAhC,EAAmC;IAC/BJ,OAAO,CAACK,GAAR,CAAYC,MAAM,IAAI;MAClB,IAAIA,MAAM,CAACC,QAAP,IAAmB,IAAvB,EAA6B;QACzB,IAAIhB,QAAQ,IAAIe,MAAM,CAACE,QAAnB,IAA+BV,gBAAgB,IAAI,MAAvD,EAA+D;UAC3DK,QAAQ,GAAGD,UAAU,CAACI,MAAM,CAACN,OAAR,CAArB;UACAkB,KAAK,GAAGZ,MAAM,CAACY,KAAf;UACAC,QAAQ,GAAGjB,UAAU,CAAED,KAAK,GAAGE,QAAT,GAAqB,GAAtB,CAArB;UACAY,YAAY,CAACK,IAAb,CAAkB;YAAEC,EAAE,EAAEH,KAAN;YAAa5B,KAAK,EAAE6B;UAApB,CAAlB;QACH;;QACD,IAAIrB,gBAAgB,IAAI,OAAxB,EAAiC;UAC7BK,QAAQ,GAAGD,UAAU,CAACI,MAAM,CAACN,OAAR,CAArB;UACAkB,KAAK,GAAGZ,MAAM,CAACY,KAAf;UACAC,QAAQ,GAAGjB,UAAU,CAAED,KAAK,GAAGE,QAAT,GAAqB,GAAtB,CAArB;UACAY,YAAY,CAACK,IAAb,CAAkB;YAAEC,EAAE,EAAEH,KAAN;YAAa5B,KAAK,EAAE6B;UAApB,CAAlB;QACH;MACJ;IACJ,CAfD;EAgBH,CA5BuD,CA6BpD;;;EACA,IAAGhB,QAAQ,IAAE,CAAV,IAAeL,gBAAgB,IAAI,MAAtC,EAA6C;IACzC,IAAID,YAAY,IAAIY,KAAK,CAACC,OAAN,CAAcb,YAAd,KAA6B,IAA7C,IAAqDA,YAAY,CAACO,MAAb,GAAsB,CAA/E,EAAkF;MAC9EP,YAAY,CAACQ,GAAb,CAAiBC,MAAM,IAAI;QACnB,IAAIf,QAAQ,IAAIe,MAAM,CAACE,QAAvB,EAAiC;UAC7BL,QAAQ,GAAGD,UAAU,CAACI,MAAM,CAACN,OAAR,CAArB;UACAkB,KAAK,GAAGZ,MAAM,CAACY,KAAf;UACAC,QAAQ,GAAGjB,UAAU,CAAED,KAAK,GAAGE,QAAT,GAAqB,GAAtB,CAArB;UACAY,YAAY,CAACK,IAAb,CAAkB;YAAEC,EAAE,EAAEH,KAAN;YAAa5B,KAAK,EAAE6B;UAApB,CAAlB;QACP;MACJ,CAPD;IASP;EACJ,CA1CuD,CA2CxD;;;EACA,OAAOJ,YAAP;AACH,CA7CM;AA+CP,OAAO,MAAMQ,yBAAyB,GAAIC,QAAD,IAAc;EACnDA,QAAQ,CAACnB,GAAT,CAAaoB,IAAI,IAAI;IACjB,IAAIC,aAAa,GAAGD,IAAI,CAACE,KAAL,IAAchC,IAAI,CAACC,KAAL,CAAW6B,IAAI,CAACE,KAAhB,CAAd,IAAwChC,IAAI,CAACC,KAAL,CAAW6B,IAAI,CAACE,KAAhB,EAAuBC,KAAnF;IACA,IAAIC,gBAAgB,GAAGJ,IAAI,CAACE,KAAL,IAAchC,IAAI,CAACC,KAAL,CAAW6B,IAAI,CAACE,KAAhB,CAAd,IAAwChC,IAAI,CAACC,KAAL,CAAW6B,IAAI,CAACE,KAAhB,EAAuBG,QAAtF;;IACA,IAAKL,IAAI,IAAK,CAACA,IAAI,CAACK,QAApB,EAA8B;MAC1B,IAAIC,IAAI,GAAC,EAAT;MACAA,IAAI,CAACX,IAAL,CAAUK,IAAV;MACAO,eAAe,CAACD,IAAD,CAAf;IAA+B;;IACnCN,IAAI,CAAC,UAAD,CAAJ,GAAmBA,IAAI,CAACK,QAAxB;IACAL,IAAI,CAAC,OAAD,CAAJ,GAAgBA,IAAI,CAACG,KAAL,GAAaH,IAAI,CAACG,KAAlB,GAAyBH,IAAI,CAACQ,UAAL,GAAiBR,IAAI,CAACQ,UAAtB,GAAkC,CAA3E;IACAR,IAAI,CAAC,WAAD,CAAJ,GAAoBA,IAAI,CAACS,SAAL,GAAeT,IAAI,CAACS,SAApB,GAA+BR,aAAa,GAAGS,MAAM,CAACC,OAAP,CAAeV,aAAf,EAA8BrB,GAA9B,CAAkCoB,IAAI,KAAK;MAAE,CAACA,IAAI,CAAC,CAAD,CAAL,GAAWA,IAAI,CAAC,CAAD;IAAjB,CAAL,CAAtC,CAAH,GAAyEA,IAAI,CAACY,QAA9I;IACAZ,IAAI,CAAC,cAAD,CAAJ,GAAuBA,IAAI,CAACa,YAAL,GAAkBb,IAAI,CAACa,YAAvB,GAAoCT,gBAAgB,GAAGM,MAAM,CAACC,OAAP,CAAeP,gBAAf,EAAiCxB,GAAjC,CAAqCoB,IAAI,KAAK;MAAE,CAACA,IAAI,CAAC,CAAD,CAAL,GAAWA,IAAI,CAAC,CAAD;IAAjB,CAAL,CAAzC,CAAH,GAA4EA,IAAI,CAACc,WAA5J;EACH,CAXD;AAYH,CAbM;AAeP,OAAO,MAAMC,wBAAwB,GAAIhB,QAAD,IAAc;EAClD,IAAIiB,QAAQ,GAAGC,cAAc,EAA7B;EACA,IAAIpD,KAAK,GAAG,CAAZ;EACA,IAAIqD,GAAG,GAAG,CAAV;EACAnB,QAAQ,CAACnB,GAAT,CAAaoB,IAAI,IAAI;IACjBnC,KAAK,GAAImC,IAAI,CAACmB,eAAL,KAAyB,CAA1B,GAAgCnB,IAAI,CAACoB,cAAL,GAAsBpB,IAAI,CAACqB,QAA5B,GAAwCzD,eAAe,CAACoC,IAAI,CAACoB,cAAN,EAAsBpB,IAAI,CAACjB,QAA3B,CAAtF,GAA6H,CAACiB,IAAI,CAACsB,SAAL,GAAiB1D,eAAe,CAACoC,IAAI,CAACsB,SAAN,CAAjC,IAAqDtB,IAAI,CAACqB,QAA/L;IACA,IAAIE,KAAK,GAAG,EAAZ;IACA,IAAIC,mBAAmB,GAAG,IAA1B;IACA,IAAIC,OAAO,GAAG5D,KAAK,GAAGmC,IAAI,CAACqB,QAA3B;IACA,IAAIK,aAAa,GAAG,EAApB;IACA,IAAIC,aAAa,GAAG,IAApB;;IACA,IAAI3B,IAAI,CAAC4B,SAAL,KAAmB,MAAvB,EAA+B;MAC3B,IAAI5B,IAAI,CAACmB,eAAL,KAAyB,CAA7B,EAAgC;QAC5B,IAAIH,QAAQ,IAAI,CAAZ,IAAiBA,QAAQ,IAAI,CAA7B,IAAkCA,QAAQ,IAAI,CAA9C,IAAmDA,QAAQ,IAAI,CAAnE,EAAsE;UAClEQ,mBAAmB,GAAGjC,uBAAuB,CAACkC,OAAD,EAAUzB,IAAI,CAACjB,QAAf,CAA7C;QACH,CAFD,MAEO;UACHyC,mBAAmB,GAAG3B,uBAAuB,CAAC4B,OAAD,EAAUzB,IAAI,CAACjB,QAAf,CAA7C;QACH;MACJ;;MACD,IAAIiC,QAAQ,IAAI,CAAZ,IAAiBA,QAAQ,IAAI,CAA7B,IAAkCA,QAAQ,IAAI,CAA9C,IAAmDA,QAAQ,IAAI,CAAnE,EAAsE;QAClEW,aAAa,GAAGpC,uBAAuB,CAACS,IAAI,CAACsB,SAAN,EAAiBtB,IAAI,CAACjB,QAAtB,CAAvC;MACH,CAFD,MAEO;QACH4C,aAAa,GAAG9B,uBAAuB,CAACG,IAAI,CAACsB,SAAN,EAAiBtB,IAAI,CAACjB,QAAtB,CAAvC;MACH,CAZ0B,CAa3B;;;MACA,IAAI4C,aAAa,IAAIA,aAAa,CAAChD,MAAd,GAAuB,CAA5C,EAA+C;QAC3C4C,KAAK,CAAC5B,IAAN,CAAW;UAAE,CAACgC,aAAa,CAAC,CAAD,CAAb,CAAiB/B,EAAlB,GAAuBnB,UAAU,CAACuB,IAAI,CAAC6B,QAAN,CAAV,GAA4BpD,UAAU,CAACuB,IAAI,CAAC8B,QAAN;QAA/D,CAAX;MACH;;MACD,IAAIN,mBAAmB,IAAIA,mBAAmB,CAAC7C,MAApB,GAA6B,CAAxD,EAA2D;QACvD+C,aAAa,CAAC/B,IAAd,CAAmB;UAAE,CAAC6B,mBAAmB,CAAC,CAAD,CAAnB,CAAuB5B,EAAxB,GAA6BnB,UAAU,CAACuB,IAAI,CAAC6B,QAAN,CAAV,GAA4BpD,UAAU,CAACuB,IAAI,CAAC8B,QAAN;QAArE,CAAnB;MACH;IACJ,CA3BgB,CA4BjB;;;IACAZ,GAAG,GAAIlB,IAAI,CAACmB,eAAL,KAAyB,CAA1B,GAA+BO,aAA/B,GAA+CH,KAArD;IACAvB,IAAI,CAAC,UAAD,CAAJ,GAAmBA,IAAI,CAACxB,KAAxB;IACAwB,IAAI,CAAC,OAAD,CAAJ,GAAgBA,IAAI,CAACxB,KAArB;IACAwB,IAAI,CAAC,WAAD,CAAJ,GAAoBkB,GAApB;IACAlB,IAAI,CAAC,cAAD,CAAJ,GAAuBuB,KAAvB;EACH,CAlCD;AAmCH,CAvCM;AAwCP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,OAAO,MAAMhB,eAAe,GAAIR,QAAD,IAAc;EACzC,IAAIiB,QAAQ,GAAGC,cAAc,EAA7B,CADyC,CAE7C;EACA;;EACI,IAAIc,YAAY,GAAG,EAAnB;EACA,IAAIlE,KAAK,GAAG,CAAZ;EACA,IAAIqD,GAAG,GAAG,CAAV;;EACA,QAAQF,QAAR;IACI;IACA,KAAK,CAAL;MACIjB,QAAQ,CAACnB,GAAT,CAAaoB,IAAI,IAAI;QAClB;QAEA,IAAIgC,cAAc,GAAEhC,IAAI,CAAC6B,QAAzB,CAHkB,CAGgB;QAClC;;QACC,IAAII,aAAa,GAACjC,IAAI,CAACoB,cAAL,KAAuB,CAAvB,GAAyBpB,IAAI,CAACoB,cAA9B,GAA8CpB,IAAI,CAACkC,sBAAL,GAA6BlC,IAAI,CAACqB,QAAlG;;QACD,IAAIrB,IAAI,CAACmC,aAAL,IAAsB,YAA1B,EAAwC;UACxC;UACCtE,KAAK,GAAEoE,aAAP,CAFuC,CAGlC;QACJ,CAJF,MAIM;UAEDpE,KAAK,GAAImC,IAAI,CAACmB,eAAL,KAAyB,CAA1B,GAAgCc,aAAhC,GAAoDjC,IAAI,CAACsB,SAAL,GAAetB,IAAI,CAACqB,QAArB,GAAiCW,cAA5F;QACJ,CAbiB,CAclB;;;QACC,IAAIT,KAAK,GAAG,EAAZ;QACA,IAAIC,mBAAmB,GAAG,IAA1B,CAhBiB,CAiBjB;;QACA,IAAIC,OAAO,GAAMzB,IAAI,CAACmB,eAAL,KAAyB,CAA1B,GAA+BnB,IAAI,CAACoB,cAApC,GAAqDpB,IAAI,CAACsB,SAAL,GAAetB,IAAI,CAACqB,QAAzF;QACA,IAAIK,aAAa,GAAG,EAApB;QACA,IAAIU,eAAe,GAAGpC,IAAI,CAAC6B,QAAL,GAAgB,CAAhB,GAAoB7B,IAAI,CAAC6B,QAAzB,GAAoC,CAA1D;;QACA,IAAK7B,IAAI,CAACqC,SAAL,IAAgB,IAAhB,IAAwBrC,IAAI,CAAC4B,SAAL,KAAmB,MAAhD,EAAwD;UACpD,IAAI5B,IAAI,CAACmB,eAAL,KAAyB,CAA7B,EAAgC;YAC5B;YACAK,mBAAmB,GAAIjC,uBAAuB,CAACkC,OAAD,EAAUzB,IAAI,CAACjB,QAAf,CAA9C,CAF4B,CAE4C;YACxE;UACH;;UACD,IAAI4C,aAAa,GAAGpC,uBAAuB,CAAES,IAAI,CAACsB,SAAL,GAAetB,IAAI,CAACqB,QAArB,GAA+BW,cAAhC,EAAgDhC,IAAI,CAACjB,QAArD,CAA3C;UACA4C,aAAa,CAAC/C,GAAd,CAAkB0D,KAAK,IAAI;YACvBf,KAAK,CAAC5B,IAAN,CAAW;cAAE,CAAC2C,KAAK,CAAC1C,EAAP,GAAY0C,KAAK,CAACzE;YAApB,CAAX,EADuB,CACiB;UAC3C,CAFD;UAGA2D,mBAAmB,IAAIA,mBAAmB,CAAC7C,MAApB,GAA6B,CAApD,IAAyD6C,mBAAmB,CAAC5C,GAApB,CAAwB2D,MAAM,IAAI;YACvFb,aAAa,CAAC/B,IAAd,CAAmB;cAAE,CAAC4C,MAAM,CAAC3C,EAAR,GAAa2C,MAAM,CAAC1E;YAAtB,CAAnB;UACH,CAFwD,CAAzD;QAGH;;QACDqD,GAAG,GAAIlB,IAAI,CAACmB,eAAL,KAAyB,CAA1B,GAA+BO,aAA/B,GAA+CH,KAArD,CAnCiB,CAoClB;QACC;;QACC,IAAIiB,MAAM,GAAC,CAAX,CAtCgB,CAuChB;QACD;QACA;QACA;QACA;QACA;;QACIA,MAAM,GAAIxC,IAAI,CAACsB,SAAL,GAAgBtB,IAAI,CAACqB,QAAtB,GAAkCW,cAA3C,CA7Ca,CA+ClB;;QACChC,IAAI,CAAC,UAAD,CAAJ,GAAkBwC,MAAlB;QACAxC,IAAI,CAAC,OAAD,CAAJ,GAAenC,KAAf;QACAmC,IAAI,CAAC,WAAD,CAAJ,GAAoBkB,GAApB;QACAlB,IAAI,CAAC,cAAD,CAAJ,GAAuBkB,GAAvB;MACH,CApDD;MAqDAa,YAAY,GAAGhC,QAAf;MACA;IACJ;;IACA,KAAK,CAAL;MACIA,QAAQ,CAACnB,GAAT,CAAaoB,IAAI,IAAI;QACjB,IAAIgC,cAAc,GAAEhC,IAAI,CAAC6B,QAAzB;QACAhE,KAAK,GAAImC,IAAI,CAACmB,eAAL,KAAyB,CAA1B,GAA+BnB,IAAI,CAACoB,cAApC,GAAqD,CAACpB,IAAI,CAACsB,SAAL,GAAiB1D,eAAe,CAACoC,IAAI,CAACsB,SAAN,EAAiBtB,IAAI,CAACjB,QAAtB,CAAjC,IAAoEiB,IAAI,CAACqB,QAAtI;QACA,IAAIE,KAAK,GAAG,EAAZ;QACA,IAAIC,mBAAmB,GAAG,IAA1B;QACA,IAAIC,OAAO,GAAMzB,IAAI,CAACmB,eAAL,KAAyB,CAA1B,GAA+BnB,IAAI,CAACoB,cAApC,GAAsDpB,IAAI,CAACsB,SAAL,GAAetB,IAAI,CAACqB,QAArB,GAAgCW,cAArG;QACA,IAAIN,aAAa,GAAG,EAApB;QACA,IAAIU,eAAe,GAAGpC,IAAI,CAAC8B,QAAL,GAAgB,CAAhB,GAAoB9B,IAAI,CAAC8B,QAAzB,GAAoC,CAA1D;;QACA,IAAI9B,IAAI,CAAC4B,SAAL,KAAmB,MAAvB,EAA+B;UAC3B,IAAI5B,IAAI,CAACmB,eAAL,KAAyB,CAA7B,EAAgC;YAC5BK,mBAAmB,GAAG3B,uBAAuB,CAAC4B,OAAD,EAAUzB,IAAI,CAACjB,QAAf,CAA7C;UACH,CAH0B,CAI3B;UACA;UACA;UACA;UAEA;;;UACA,IAAI4C,aAAa,GAAGpC,uBAAuB,CAAE1B,KAAD,GAAQmE,cAAT,EAAyBhC,IAAI,CAACjB,QAA9B,CAA3C,CAV2B,CAUyD;;UACpF4C,aAAa,CAAC/C,GAAd,CAAkB0D,KAAK,IAAI;YACvBf,KAAK,CAAC5B,IAAN,CAAW;cAAE,CAAC2C,KAAK,CAAC1C,EAAP,GAAY0C,KAAK,CAACzE;YAApB,CAAX,EADuB,CACiB;UAC3C,CAFD;UAIA2D,mBAAmB,IAAIA,mBAAmB,CAAC7C,MAApB,GAA6B,CAApD,IAAyD6C,mBAAmB,CAAC5C,GAApB,CAAwB2D,MAAM,IAAI;YACvFb,aAAa,CAAC/B,IAAd,CAAmB;cAAE,CAAC4C,MAAM,CAAC3C,EAAR,GAAa2C,MAAM,CAAC1E;YAAtB,CAAnB;UACH,CAFwD,CAAzD;QAGH;;QACDqD,GAAG,GAAIlB,IAAI,CAACmB,eAAL,KAAyB,CAA1B,GAA+BO,aAA/B,GAA+CH,KAArD,CA3BiB,CA4BjB;QAED;;QAECvB,IAAI,CAAC,UAAD,CAAJ,GAAmB,CAACA,IAAI,CAACsB,SAAL,GAAiB1D,eAAe,CAACoC,IAAI,CAACsB,SAAN,EAAiBtB,IAAI,CAACjB,QAAtB,CAAjC,IAAoEiB,IAAI,CAACqB,QAA5F,CAhCiB,CAiCjB;;QACArB,IAAI,CAAC,OAAD,CAAJ,GAAgBnC,KAAhB;QACAmC,IAAI,CAAC,WAAD,CAAJ,GAAoBkB,GAApB;QACAlB,IAAI,CAAC,cAAD,CAAJ,GAAuBkB,GAAvB;MAEH,CAtCD;MAuCAa,YAAY,GAAGhC,QAAf;MAEA;IACJ;;IACA,KAAK,CAAL;MACIA,QAAQ,CAACnB,GAAT,CAAaoB,IAAI,IAAI;QACjBnC,KAAK,GAAImC,IAAI,CAACmB,eAAL,KAAyB,CAA1B,GAAgCnB,IAAI,CAACoB,cAAL,GAAsBpB,IAAI,CAACqB,QAA5B,GAAwCzD,eAAe,CAACoC,IAAI,CAACoB,cAAN,EAAsBpB,IAAI,CAACjB,QAA3B,CAAtF,GAA6H,CAACiB,IAAI,CAACsB,SAAL,GAAiB1D,eAAe,CAACoC,IAAI,CAACsB,SAAN,EAAiBtB,IAAI,CAACjB,QAAtB,CAAjC,IAAoEiB,IAAI,CAACqB,QAA9M;QACA,IAAIE,KAAK,GAAG,EAAZ;QACA,IAAIC,mBAAmB,GAAG,IAA1B;QACA,IAAIC,OAAO,GAAMzB,IAAI,CAACmB,eAAL,KAAyB,CAA1B,GAA+BnB,IAAI,CAACoB,cAApC,GAAqDpB,IAAI,CAACsB,SAAL,GAAetB,IAAI,CAACqB,QAAzF;QACA,IAAIK,aAAa,GAAG,EAApB;QACA,IAAIU,eAAe,GAAGpC,IAAI,CAAC6B,QAAL,GAAgB,CAAhB,GAAoB7B,IAAI,CAAC6B,QAAzB,GAAoC,CAA1D;;QACA,IAAI7B,IAAI,CAAC4B,SAAL,KAAmB,MAAvB,EAA+B;UAC3B,IAAI5B,IAAI,CAACmB,eAAL,KAAyB,CAA7B,EAAgC;YAC5BK,mBAAmB,GAAGjC,uBAAuB,CAACkC,OAAD,EAAUzB,IAAI,CAACjB,QAAf,CAA7C;UACH;;UACD,IAAI4C,aAAa,GAAGpC,uBAAuB,CAACS,IAAI,CAACsB,SAAN,EAAiBtB,IAAI,CAACjB,QAAtB,CAA3C;UACA4C,aAAa,CAAC/C,GAAd,CAAkB0D,KAAK,IAAI;YACvBf,KAAK,CAAC5B,IAAN,CAAW;cAAE,CAAC2C,KAAK,CAAC1C,EAAP,GAAY0C,KAAK,CAACzE,KAAN,GAAcmC,IAAI,CAACqB;YAAjC,CAAX;UACH,CAFD;UAGAG,mBAAmB,IAAIA,mBAAmB,CAAC7C,MAApB,GAA6B,CAApD,IAAyD6C,mBAAmB,CAAC5C,GAApB,CAAwB2D,MAAM,IAAI;YACvFb,aAAa,CAAC/B,IAAd,CAAmB;cAAE,CAAC4C,MAAM,CAAC3C,EAAR,GAAa2C,MAAM,CAAC1E;YAAtB,CAAnB;UACH,CAFwD,CAAzD;QAGH;;QACDqD,GAAG,GAAIlB,IAAI,CAACmB,eAAL,KAAyB,CAA1B,GAA+BO,aAA/B,GAA+CH,KAArD;QACAvB,IAAI,CAAC,UAAD,CAAJ,GAAmB,CAACA,IAAI,CAACsB,SAAL,GAAiB1D,eAAe,CAACoC,IAAI,CAACsB,SAAN,EAAiBtB,IAAI,CAACjB,QAAtB,CAAjC,IAAoEiB,IAAI,CAACqB,QAA5F;QACArB,IAAI,CAAC,OAAD,CAAJ,GAAgBnC,KAAhB;QACAmC,IAAI,CAAC,WAAD,CAAJ,GAAoBkB,GAApB;QACAlB,IAAI,CAAC,cAAD,CAAJ,GAAuBkB,GAAvB;MACH,CAxBD;MAyBAa,YAAY,GAAGhC,QAAf;MACA;IACJ;;IACA,KAAK,CAAL;MACIA,QAAQ,CAACnB,GAAT,CAAaoB,IAAI,IAAI;QACjBnC,KAAK,GAAImC,IAAI,CAACmB,eAAL,KAAyB,CAA1B,GAA+BnB,IAAI,CAACoB,cAApC,GAAqD,CAACpB,IAAI,CAACsB,SAAL,GAAiB1D,eAAe,CAACoC,IAAI,CAACsB,SAAN,EAAiBtB,IAAI,CAACjB,QAAtB,CAAjC,IAAoEiB,IAAI,CAACqB,QAAtI;QACA,IAAIE,KAAK,GAAG,EAAZ;QACA,IAAIC,mBAAmB,GAAG,IAA1B;QACA,IAAIC,OAAO,GAAMzB,IAAI,CAACmB,eAAL,KAAyB,CAA1B,GAA+BnB,IAAI,CAACoB,cAApC,GAAqDpB,IAAI,CAACsB,SAAL,GAAetB,IAAI,CAACqB,QAAzF;QACA,IAAIK,aAAa,GAAG,EAApB;QACA,IAAIU,eAAe,GAAGpC,IAAI,CAAC8B,QAAL,GAAgB,CAAhB,GAAoB9B,IAAI,CAAC8B,QAAzB,GAAoC,CAA1D,CANiB,CAOjB;QACA;;QACA,IAAI9B,IAAI,CAAC4B,SAAL,KAAmB,MAAvB,EAA+B;UAC3B,IAAI5B,IAAI,CAACmB,eAAL,KAAyB,CAA7B,EAAgC;YAC5BK,mBAAmB,GAAG3B,uBAAuB,CAAC4B,OAAD,EAAUzB,IAAI,CAACjB,QAAf,CAA7C;UACH;;UACD,IAAI4C,aAAa,GAAGpC,uBAAuB,CAACS,IAAI,CAACsB,SAAN,EAAiBtB,IAAI,CAACjB,QAAtB,CAA3C;UACA4C,aAAa,CAAC/C,GAAd,CAAkB0D,KAAK,IAAI;YACvBf,KAAK,CAAC5B,IAAN,CAAW;cAAE,CAAC2C,KAAK,CAAC1C,EAAP,GAAY0C,KAAK,CAACzE,KAAN,GAAcmC,IAAI,CAACqB;YAAjC,CAAX;UACH,CAFD;UAGAG,mBAAmB,IAAIA,mBAAmB,CAAC7C,MAApB,GAA6B,CAApD,IAAyD6C,mBAAmB,CAAC5C,GAApB,CAAwB2D,MAAM,IAAI;YACvFb,aAAa,CAAC/B,IAAd,CAAmB;cAAE,CAAC4C,MAAM,CAAC3C,EAAR,GAAa2C,MAAM,CAAC1E;YAAtB,CAAnB;UACH,CAFwD,CAAzD;QAGH;;QACDqD,GAAG,GAAIlB,IAAI,CAACmB,eAAL,KAAyB,CAA1B,GAA+BO,aAA/B,GAA+CH,KAArD;QACAvB,IAAI,CAAC,UAAD,CAAJ,GAAmB,CAACA,IAAI,CAACsB,SAAL,GAAiB1D,eAAe,CAACoC,IAAI,CAACsB,SAAN,EAAiBtB,IAAI,CAACjB,QAAtB,CAAjC,IAAoEiB,IAAI,CAACqB,QAA5F;QACArB,IAAI,CAAC,OAAD,CAAJ,GAAgBnC,KAAhB;QACAmC,IAAI,CAAC,WAAD,CAAJ,GAAoBkB,GAApB;QACAlB,IAAI,CAAC,cAAD,CAAJ,GAAuBkB,GAAvB;MACH,CA1BD;MA2BA;;IACJ,KAAK,CAAL;IAAQ,KAAK,CAAL;MACJnB,QAAQ,CAACnB,GAAT,CAAaoB,IAAI,IAAI;QACjBnC,KAAK,GAAImC,IAAI,CAACmB,eAAL,KAAyB,CAA1B,GAAgCnB,IAAI,CAACsB,SAAL,GAAiBtB,IAAI,CAACqB,QAAvB,GAAmCrB,IAAI,CAACmB,eAAvE,GAAyFnB,IAAI,CAACsB,SAAL,GAAiBtB,IAAI,CAACqB,QAAvH;QACA,IAAIE,KAAK,GAAG,EAAZ;QACA,IAAIC,mBAAmB,GAAG,IAA1B;QACA,IAAIC,OAAO,GAAMzB,IAAI,CAACmB,eAAL,KAAyB,CAA1B,GAA+BnB,IAAI,CAACoB,cAApC,GAAqDpB,IAAI,CAACsB,SAAL,GAAetB,IAAI,CAACqB,QAAzF;QACA,IAAIK,aAAa,GAAG,EAApB;;QACA,IAAI1B,IAAI,CAAC4B,SAAL,KAAmB,MAAvB,EAA+B;UAC3B,IAAI5B,IAAI,CAACmB,eAAL,KAAyB,CAAzB,IAA8BnB,IAAI,CAAC6B,QAAL,IAAiB,CAAnD,EAAsD;YAClDL,mBAAmB,GAAG3B,uBAAuB,CAAC4B,OAAD,EAAUzB,IAAI,CAACjB,QAAf,CAA7C;UACH;;UACD,IAAI4C,aAAa,GAAG9B,uBAAuB,CAACG,IAAI,CAACsB,SAAN,EAAiBtB,IAAI,CAACjB,QAAtB,CAA3C;UACA4C,aAAa,CAAC/C,GAAd,CAAkB0D,KAAK,IAAI;YACvBf,KAAK,CAAC5B,IAAN,CAAW;cAAE,CAAC2C,KAAK,CAAC1C,EAAP,GAAY0C,KAAK,CAACzE,KAAN,GAAcmC,IAAI,CAACqB;YAAjC,CAAX;UACH,CAFD;UAGAG,mBAAmB,IAAIA,mBAAmB,CAAC7C,MAApB,GAA6B,CAApD,IAAyD6C,mBAAmB,CAAC5C,GAApB,CAAwB2D,MAAM,IAAI;YACvFb,aAAa,CAAC/B,IAAd,CAAmB;cAAE,CAAC4C,MAAM,CAAC3C,EAAR,GAAa2C,MAAM,CAAC1E;YAAtB,CAAnB;UACH,CAFwD,CAAzD;QAGH;;QACDqD,GAAG,GAAIlB,IAAI,CAACmB,eAAL,KAAyB,CAA1B,GAAgCnB,IAAI,CAAC6B,QAAL,KAAkB,CAAnB,GAAwB7B,IAAI,CAAC6B,QAA7B,GAAwCH,aAAvE,GAAuFH,KAA7F;QACAvB,IAAI,CAAC,UAAD,CAAJ,GAAmBA,IAAI,CAACsB,SAAL,GAAiBtB,IAAI,CAACqB,QAAzC;QACArB,IAAI,CAAC,OAAD,CAAJ,GAAgBnC,KAAhB;QACAmC,IAAI,CAAC,WAAD,CAAJ,GAAoBkB,GAApB;QACAlB,IAAI,CAAC,cAAD,CAAJ,GAAuBkB,GAAvB;MACH,CAvBD;MAwBA;;IACJ;MACInB,QAAQ,CAACnB,GAAT,CAAaoB,IAAI,IAAI;QACjBnC,KAAK,GAAImC,IAAI,CAACmB,eAAL,KAAyB,CAA1B,GAAgCnB,IAAI,CAACsB,SAAL,GAAiBtB,IAAI,CAACqB,QAAvB,GAAmCoB,iBAAiB,CAACzC,IAAI,CAACoB,cAAN,EAAsBpB,IAAI,CAACmB,eAA3B,EAA6CnB,IAAI,CAACsB,SAAL,GAAiBtB,IAAI,CAACqB,QAAnE,CAAnF,GAAmKrB,IAAI,CAACsB,SAAL,GAAiBtB,IAAI,CAACqB,QAAjM;QACA,IAAIE,KAAK,GAAG,EAAZ;QACA,IAAIC,mBAAmB,GAAG,IAA1B;QACA,IAAIC,OAAO,GAAI,CAAEzB,IAAI,CAACmB,eAAL,KAAyB,CAA1B,GAA+BnB,IAAI,CAACoB,cAApC,GAAqDpB,IAAI,CAACsB,SAA3D,IAAsEtB,IAAI,CAACqB,QAA1F;QACA,IAAIK,aAAa,GAAG,EAApB;;QACA,IAAI1B,IAAI,CAAC4B,SAAL,KAAmB,MAAvB,EAA+B;UAC3B,IAAI5B,IAAI,CAACmB,eAAL,KAAyB,CAAzB,IAA8BnB,IAAI,CAAC6B,QAAL,KAAkB,CAApD,EAAuD;YACnDL,mBAAmB,GAAGjC,uBAAuB,CAACkC,OAAD,EAAUzB,IAAI,CAACjB,QAAf,CAA7C;UACH;;UACD,IAAI4C,aAAa,GAAG9B,uBAAuB,CAACG,IAAI,CAACsB,SAAN,EAAiBtB,IAAI,CAACjB,QAAtB,CAA3C;UACA4C,aAAa,CAAC/C,GAAd,CAAkB0D,KAAK,IAAI;YACvBf,KAAK,CAAC5B,IAAN,CAAW;cAAE,CAAC2C,KAAK,CAAC1C,EAAP,GAAY0C,KAAK,CAACzE,KAAN,GAAcmC,IAAI,CAACqB;YAAjC,CAAX;UACH,CAFD;UAGAG,mBAAmB,IAAIA,mBAAmB,CAAC7C,MAApB,GAA6B,CAApD,IAAyD6C,mBAAmB,CAAC5C,GAApB,CAAwB2D,MAAM,IAAI;YACvFb,aAAa,CAAC/B,IAAd,CAAmB;cAAE,CAAC4C,MAAM,CAAC3C,EAAR,GAAa2C,MAAM,CAAC1E;YAAtB,CAAnB;UACH,CAFwD,CAAzD;QAGH;;QACDqD,GAAG,GAAIlB,IAAI,CAACmB,eAAL,KAAyB,CAA1B,GAAgCnB,IAAI,CAAC6B,QAAL,KAAkB,CAAnB,GAAwBH,aAAxB,GAAwC1B,IAAI,CAAC8B,QAA5E,GAAuFP,KAA7F;QACAvB,IAAI,CAAC,UAAD,CAAJ,GAAmBA,IAAI,CAACsB,SAAL,GAAiBtB,IAAI,CAACqB,QAAzC;QACArB,IAAI,CAAC,OAAD,CAAJ,GAAgBnC,KAAhB;QACAmC,IAAI,CAAC,WAAD,CAAJ,GAAoBkB,GAApB;QACAlB,IAAI,CAAC,cAAD,CAAJ,GAAuBkB,GAAvB;MACH,CAvBD;MAwBAa,YAAY,GAAGhC,QAAf;MACA;EArNR;;EAuNA,OAAOgC,YAAP;AACH,CA/NM;AAiOP,OAAO,MAAMW,mBAAmB,GAAG,CAAC7E,KAAD,EAAQ8E,SAAR,EAAmB7E,QAAnB,KAAgC;EAC/D,IAAIC,WAAW,GAAGC,YAAY,CAACC,OAAb,CAAqB,mBAArB,IAA4CC,IAAI,CAACC,KAAL,CAAWH,YAAY,CAACC,OAAb,CAAqB,mBAArB,CAAX,CAA5C,GAAoG,IAAtH;EACA,IAAIG,YAAY,GAAGJ,YAAY,CAACC,OAAb,CAAqB,gBAArB,IAAyCC,IAAI,CAACC,KAAL,CAAWH,YAAY,CAACC,OAAb,CAAqB,gBAArB,CAAX,CAAzC,GAA8F,IAAjH;EACA,IAAII,gBAAgB,GAAGL,YAAY,CAACC,OAAb,CAAqB,oBAArB,IAA6CD,YAAY,CAACC,OAAb,CAAqB,oBAArB,CAA7C,GAA0F,IAAjH;EACA,IAAIM,OAAO,GAAGF,gBAAgB,IAAI,MAApB,GAA6BN,WAA7B,GAA2CK,YAAzD;EACA,IAAIM,QAAQ,GAAG,CAAf;EACA,IAAIQ,YAAY,GAAG,CAAnB;;EACA,IAAIX,OAAO,IAAIA,OAAO,CAACI,MAAR,GAAiB,CAAhC,EAAmC;IAC/BJ,OAAO,CAACK,GAAR,CAAYC,MAAM,IAAI;MAClB,IAAIA,MAAM,CAACC,QAAP,IAAmB,IAAvB,EAA6B;QACzB,IAAIhB,QAAQ,IAAIe,MAAM,CAACE,QAAnB,IAA+BV,gBAAgB,IAAI,MAAvD,EAA+D;UAC3DK,QAAQ,IAAID,UAAU,CAACI,MAAM,CAACN,OAAR,CAAtB;QACH;;QACD,IAAIF,gBAAgB,IAAI,OAAxB,EAAiC;UAC7BK,QAAQ,IAAID,UAAU,CAACI,MAAM,CAACN,OAAR,CAAtB;QACH;MACJ;IACJ,CATD;EAUH;;EACD,IAAIoE,SAAS,IAAI,GAAb,IAAoBA,SAAS,IAAI,GAArC,EACI,OAAOzD,YAAY,GAAGT,UAAU,CAACZ,KAAD,CAAV,IAAsBa,QAAQ,GAAG,GAAZ,GAAmB,CAAxC,CAAtB,CADJ,KAGI,OAAOQ,YAAY,GAAGT,UAAU,CAAEA,UAAU,CAACZ,KAAD,CAAV,GAAoBa,QAArB,GAAiC,GAAlC,CAAV,GAAmDD,UAAU,CAACZ,KAAD,CAAnF;AACP,CAvBM;AAyBP,OAAO,MAAM+E,SAAS,GAAG,MAAM;EAC3B,IAAI5B,QAAQ,GAAGC,cAAc,EAA7B;EACA,IAAI4B,MAAM,GAAG,KAAb;;EACA,QAAQ7B,QAAR;IACI,KAAK,CAAL;IAAQ,KAAK,CAAL;IAAQ,KAAK,CAAL;IAAQ,KAAK,CAAL;MACpB6B,MAAM,GAAG,MAAT;MACA;;IACJ;MACIA,MAAM,GAAG,KAAT;MACA;EANR;;EAQA,OAAOA,MAAP;AACH,CAZM,C,CAaP;;AACA,OAAO,MAAMC,gBAAgB,GAAI/C,QAAD,IAAc;EAC1C,IAAIgC,YAAY,GAAG,EAAnB;EACA,IAAIlE,KAAK,GAAG,CAAZ;EACA,IAAImD,QAAQ,GAAGC,cAAc,EAA7B,CAH0C,CAI1C;;EACA,QAAQD,QAAR;IACI;IACA,KAAK,CAAL;IAAQ,KAAK,CAAL;IAAQ,KAAK,CAAL;IAAQ,KAAK,CAAL;MACpB,IAAGjB,QAAQ,IAAIA,QAAQ,KAAK,IAAzB,IAAiCA,QAAQ,KAAKgD,SAAjD,EAA2D;QACvDhD,QAAQ,CAACnB,GAAT,CAAaoB,IAAI,IAAI;UACjBA,IAAI,CAAC,WAAD,CAAJ,GAAoBA,IAAI,CAACxB,KAAzB;QACH,CAFD;MAGH;;MACDuD,YAAY,GAAGhC,QAAf;MACA;;IACJ,KAAK,CAAL;IAAQ,KAAK,CAAL;IAAQ,KAAK,CAAL;IAAQ,KAAK,CAAL;MACpBA,QAAQ,IAAKA,QAAQ,CAACnB,GAAT,CAAaoB,IAAI,IAAI;QAC9BA,IAAI,CAAC,WAAD,CAAJ,GAAoBA,IAAI,CAACxB,KAAzB;;QACA,IAAIwB,IAAI,CAAC4B,SAAL,KAAmB,MAAvB,EAA+B;UAC3B/D,KAAK,GAAG6E,mBAAmB,CAAC1C,IAAI,CAACxB,KAAN,EAAawC,QAAb,EAAuBhB,IAAI,CAACjB,QAA5B,CAA3B;UACAiB,IAAI,CAAC,OAAD,CAAJ,GAAgBvB,UAAU,CAACZ,KAAD,CAA1B;QACH;MACJ,CANY,CAAb;MAOAkE,YAAY,GAAGhC,QAAf;MACA;;IACJ;MACIA,QAAQ,IAAIA,QAAQ,CAACnB,GAAT,CAAaoB,IAAI,IAAI;QAC7BA,IAAI,CAAC,WAAD,CAAJ,GAAoBA,IAAI,CAACxB,KAAzB;MACH,CAFW,CAAZ;MAGAuD,YAAY,GAAGhC,QAAf;MACA;EAzBR;;EA4BA,OAAOgC,YAAP;AACH,CAlCM;AAoCP,OAAO,MAAMiB,gBAAgB,GAAG,CAACnF,KAAD,EAAQ8E,SAAR,EAAmB7E,QAAnB,KAAgC;EAC5D;EACA,IAAIC,WAAW,GAAGC,YAAY,CAACC,OAAb,CAAqB,mBAArB,IAA4CC,IAAI,CAACC,KAAL,CAAWH,YAAY,CAACC,OAAb,CAAqB,mBAArB,CAAX,CAA5C,GAAoG,IAAtH;EACA,IAAIG,YAAY,GAAGJ,YAAY,CAACC,OAAb,CAAqB,gBAArB,IAAyCC,IAAI,CAACC,KAAL,CAAWH,YAAY,CAACC,OAAb,CAAqB,gBAArB,CAAX,CAAzC,GAA8F,IAAjH;EACA,IAAII,gBAAgB,GAAGL,YAAY,CAACC,OAAb,CAAqB,oBAArB,IAA6CD,YAAY,CAACC,OAAb,CAAqB,oBAArB,CAA7C,GAA0F,IAAjH;EACA,IAAIM,OAAO,GAAGF,gBAAgB,IAAI,MAApB,GAA6BN,WAA7B,GAA2CK,YAAzD;EACA,IAAIM,QAAQ,GAAG,CAAf;EACA,IAAIQ,YAAY,GAAG,CAAnB;;EACA,IAAIX,OAAO,IAAIA,OAAO,CAACI,MAAR,GAAiB,CAAhC,EAAmC;IAC/BJ,OAAO,CAACK,GAAR,CAAYC,MAAM,IAAI;MAClB,IAAIA,MAAM,CAACC,QAAP,IAAmB,IAAvB,EAA6B;QACzB,IAAIhB,QAAQ,IAAIe,MAAM,CAACE,QAAnB,IAA+BV,gBAAgB,IAAI,MAAvD,EAA+D;UAC3DK,QAAQ,IAAID,UAAU,CAACI,MAAM,CAACN,OAAR,CAAtB;QACH;;QACD,IAAIF,gBAAgB,IAAI,OAAxB,EAAiC;UAC7BK,QAAQ,IAAID,UAAU,CAACI,MAAM,CAACN,OAAR,CAAtB;QACH;MACJ;IACJ,CATD;EAUH,CAnB2D,CAoB3D;;;EACA,IAAGG,QAAQ,IAAE,CAAV,IAAeL,gBAAgB,IAAI,MAAtC,EAA6C;IAC1C,IAAID,YAAY,IAAIY,KAAK,CAACC,OAAN,CAAcb,YAAd,KAA6B,IAA7C,IAAqDA,YAAY,CAACO,MAAb,GAAsB,CAA/E,EAAkF;MAC9EP,YAAY,CAACQ,GAAb,CAAiBC,MAAM,IAAI;QACnB,IAAIf,QAAQ,IAAIe,MAAM,CAACE,QAAvB,EAAiC;UAC7BL,QAAQ,GAAGD,UAAU,CAACI,MAAM,CAACN,OAAR,CAArB;QACP;MACJ,CAJD;IAKH;EACJ;;EAED,IAAIoE,SAAS,IAAI,GAAjB,EACI,OAAOzD,YAAY,GAAGT,UAAU,CAAEA,UAAU,CAACZ,KAAD,CAAV,GAAoBa,QAArB,GAAiC,GAAlC,CAAV,GAAmDD,UAAU,CAACZ,KAAD,CAAnF,CADJ,KAEK,IAAI8E,SAAS,IAAI,GAAb,IAAoBA,SAAS,IAAI,GAArC,EACD,OAAOzD,YAAY,GAAGT,UAAU,CAACZ,KAAD,CAAV,IAAsBa,QAAQ,GAAG,GAAZ,GAAmB,CAAxC,CAAtB,CADC,KAGD,OAAOQ,YAAY,GAAGT,UAAU,CAACZ,KAAD,CAAV,GAAoBY,UAAU,CAAEA,UAAU,CAACZ,KAAD,CAAV,GAAoBa,QAArB,GAAiC,GAAlC,CAApD;AACP,CArCM,C,CAsCP;AACA;AACA;AACA;;AACA,OAAO,MAAMuE,iBAAiB,GAAIlD,QAAD,IAAc;EAC3C;EACA,IAAIiB,QAAQ,GAAGC,cAAc,EAA7B,CAF2C,CAG3C;;EACA,IAAIc,YAAY,GAAG,EAAnB;EACA,IAAIlE,KAAK,GAAG,CAAZ;EACA,IAAIgE,QAAQ,GAAG,CAAf;EACA,IAAIC,QAAQ,GAAG,CAAf;;EACA,QAAQd,QAAR;IACI;IACA,KAAK,CAAL;MACIjB,QAAQ,CAACnB,GAAT,CAAaoB,IAAI,IAAI;QACjB6B,QAAQ,GAAG,CAAX;;QACA,IAAK7B,IAAI,CAAC4B,SAAL,KAAmB,MAAxB,EAAiC;UAAC;UAC9B,IAAI5B,IAAI,CAACqC,SAAL,IAAiB,IAArB,EAA0B;YACrBR,QAAQ,GAAGjE,eAAe,CAACoC,IAAI,CAACoB,cAAL,IAAuBpB,IAAI,CAACoB,cAAL,GAAoB,CAA3C,GAA6CpB,IAAI,CAACoB,cAAlD,GAAmEpB,IAAI,CAACsB,SAAzE,EAAoFtB,IAAI,CAACjB,QAAzF,CAA1B;UACJ;;UACDiB,IAAI,CAAC,UAAD,CAAJ,GAAmB6B,QAAnB,CAJ6B,CAID;QAC/B;MACJ,CARD;MASAE,YAAY,GAAGhC,QAAf;MACA;IACJ;;IACA,KAAK,CAAL;MACIA,QAAQ,CAACnB,GAAT,CAAaoB,IAAI,IAAI;QACjB8B,QAAQ,GAAG,CAAX;QACAjE,KAAK,GAAG,CAAR;;QACA,IAAImC,IAAI,CAAC4B,SAAL,KAAmB,MAAvB,EAA+B;UAAC;UAC5B/D,KAAK,GAACmC,IAAI,CAACsB,SAAX;;UACA,IAAItB,IAAI,CAACqC,SAAL,IAAiB,IAArB,EAA0B;YAC1BP,QAAQ,GAAGlE,eAAe,CAACoC,IAAI,CAACsB,SAAN,EAAiBtB,IAAI,CAACjB,QAAtB,CAA1B;YACAlB,KAAK,GAAGmF,gBAAgB,CAAChD,IAAI,CAACsB,SAAN,EAAiB,CAAjB,EAAoBtB,IAAI,CAACjB,QAAzB,CAAxB;UACC;;UACDiB,IAAI,CAAC,OAAD,CAAJ,GAAgBnC,KAAK,GAAGmC,IAAI,CAACqB,QAA7B;UACArB,IAAI,CAAC,UAAD,CAAJ,GAAmB8B,QAAQ,GAAG9B,IAAI,CAACqB,QAAnC;QACH;MACJ,CAZD;MAaAU,YAAY,GAAGhC,QAAf;MACA;IACJ;;IACA,KAAK,CAAL;MACIA,QAAQ,IAAIA,QAAQ,CAACnB,GAAT,CAAaoB,IAAI,IAAI;QAC7B6B,QAAQ,GAAG,CAAX;QACAhE,KAAK,GAAG,CAAR;;QACA,IAAImC,IAAI,CAAC4B,SAAL,KAAmB,MAAvB,EAA+B;UAAE;UAC7B/D,KAAK,GAACmC,IAAI,CAACsB,SAAX;;UACA,IAAItB,IAAI,CAACqC,SAAL,IAAiB,IAArB,EAA0B;YAC1BR,QAAQ,GAAGjE,eAAe,CAACoC,IAAI,CAACsB,SAAN,EAAiBtB,IAAI,CAACjB,QAAtB,CAA1B;YACAiB,IAAI,CAAC,OAAD,CAAJ,GAAgBA,IAAI,CAACsB,SAAL,GAAiBtB,IAAI,CAACqB,QAAtC;UACC;;UACDrB,IAAI,CAAC,UAAD,CAAJ,GAAmB6B,QAAQ,GAAG7B,IAAI,CAACqB,QAAnC;QACH;MACJ,CAXW,CAAZ;MAYAU,YAAY,GAAGhC,QAAf;MACA;IACJ;;IACA,KAAK,CAAL;MACIA,QAAQ,IAAIA,QAAQ,CAACnB,GAAT,CAAaoB,IAAI,IAAI;QAC7B8B,QAAQ,GAAG,CAAX;QACAjE,KAAK,GAAG,CAAR;;QACA,IAAImC,IAAI,CAAC4B,SAAL,KAAmB,MAAvB,EAA+B;UAAE;UAC7B/D,KAAK,GAACmC,IAAI,CAACsB,SAAX;;UACA,IAAItB,IAAI,CAACqC,SAAL,IAAiB,IAArB,EAA0B;YAC1BP,QAAQ,GAAGlE,eAAe,CAACoC,IAAI,CAACsB,SAAN,EAAiBtB,IAAI,CAACjB,QAAtB,CAA1B;YACAlB,KAAK,GAAGmF,gBAAgB,CAAChD,IAAI,CAACsB,SAAN,EAAiB,CAAjB,EAAoBtB,IAAI,CAACjB,QAAzB,CAAxB;UACC;;UACDiB,IAAI,CAAC,OAAD,CAAJ,GAAgBnC,KAAK,GAAGmC,IAAI,CAACqB,QAA7B;UACArB,IAAI,CAAC,UAAD,CAAJ,GAAmB8B,QAAQ,GAAG9B,IAAI,CAACqB,QAAnC;QACH;MACJ,CAZW,CAAZ;MAaAU,YAAY,GAAGhC,QAAf;MACA;IACJ;;IACA,KAAK,CAAL;MACIA,QAAQ,CAACnB,GAAT,CAAaoB,IAAI,IAAI;QACjB6B,QAAQ,GAAG,CAAX;QACAhE,KAAK,GAAG,CAAR;;QACA,IAAKmC,IAAI,CAAC4B,SAAL,KAAmB,MAAxB,EAAgC;UAAE;UAC9B,IAAI5B,IAAI,CAACqC,SAAL,IAAiB,IAArB,EAA0B;YAC1BR,QAAQ,GAAGzC,eAAe,CAACY,IAAI,CAACsB,SAAN,EAAiBtB,IAAI,CAACjB,QAAtB,CAA1B;UACC;;UACDiB,IAAI,CAAC,OAAD,CAAJ,GAAgBA,IAAI,CAACxB,KAArB;UACAwB,IAAI,CAAC,UAAD,CAAJ,GAAmB6B,QAAQ,GAAG7B,IAAI,CAACqB,QAAnC;QACH;MACJ,CAVD;MAWAU,YAAY,GAAGhC,QAAf;MACA;IACJ;;IACA,KAAK,CAAL;MACIA,QAAQ,IAAIA,QAAQ,CAACnB,GAAT,CAAaoB,IAAI,IAAI;QAC7B8B,QAAQ,GAAG,CAAX;QACAjE,KAAK,GAAG,CAAR;;QACA,IAAImC,IAAI,CAAC4B,SAAL,KAAmB,MAAvB,EAA+B;UAAE;UAC7B,IAAI5B,IAAI,CAACqC,SAAL,IAAiB,IAArB,EAA0B;YAC1BP,QAAQ,GAAG1C,eAAe,CAACY,IAAI,CAACsB,SAAN,EAAiBtB,IAAI,CAACjB,QAAtB,CAA1B;UACC;;UACDiB,IAAI,CAAC,OAAD,CAAJ,GAAgBA,IAAI,CAACsB,SAAL,GAAiBtB,IAAI,CAACqB,QAAtC;UACArB,IAAI,CAAC,UAAD,CAAJ,GAAmB8B,QAAQ,GAAG9B,IAAI,CAACqB,QAAnC;QACH;MACJ,CAVW,CAAZ;MAWAU,YAAY,GAAGhC,QAAf;MACA;IACJ;;IACA,KAAK,CAAL;MACIA,QAAQ,IAAIA,QAAQ,CAACnB,GAAT,CAAaoB,IAAI,IAAI;QAC7B6B,QAAQ,GAAG,CAAX;QACAhE,KAAK,GAAG,CAAR;;QACA,IAAKmC,IAAI,CAAC4B,SAAL,KAAmB,MAAxB,EAAgC;UAAC;UAC7B/D,KAAK,GAAGmC,IAAI,CAACsB,SAAb;;UACA,IAAItB,IAAI,CAACqC,SAAL,IAAiB,IAArB,EAA0B;YAC1BxE,KAAK,GAAGmF,gBAAgB,CAAChD,IAAI,CAACsB,SAAN,EAAiB,CAAjB,EAAoBtB,IAAI,CAACjB,QAAzB,CAAxB;YACA8C,QAAQ,GAAGzC,eAAe,CAACY,IAAI,CAACsB,SAAN,EAAiBtB,IAAI,CAACjB,QAAtB,CAA1B;UACC;;UACDiB,IAAI,CAAC,OAAD,CAAJ,GAAgBnC,KAAK,GAAGmC,IAAI,CAACqB,QAA7B;UACArB,IAAI,CAAC,UAAD,CAAJ,GAAmB6B,QAAQ,GAAG7B,IAAI,CAACqB,QAAnC;QACH;MACJ,CAZW,CAAZ;MAaAU,YAAY,GAAGhC,QAAf;MACA;IACJ;;IACA;MACIA,QAAQ,IAAIA,QAAQ,CAACnB,GAAT,CAAaoB,IAAI,IAAI;QAC7B8B,QAAQ,GAAG,CAAX,CAD6B,CAE7B;;QACA,IAAK9B,IAAI,CAAC4B,SAAL,KAAmB,MAAxB,EAAgC;UAC5B,IAAI5B,IAAI,CAACqC,SAAL,IAAiB,IAArB,EAA0B;YAC1BP,QAAQ,GAAG1C,eAAe,CAACY,IAAI,CAACsB,SAAN,EAAiBtB,IAAI,CAACjB,QAAtB,CAA1B;UACC;;UACDiB,IAAI,CAAC,UAAD,CAAJ,GAAmB8B,QAAQ,GAAG9B,IAAI,CAACqB,QAAnC;QACH;MACJ,CATW,CAAZ;MAUAU,YAAY,GAAGhC,QAAf;MACA;EA5HR;;EA8HA,OAAOgC,YAAP;AACH,CAvIM;AAyIP,OAAO,MAAMmB,iBAAiB,GAAG,CAAC9B,cAAD,EAAiBD,eAAjB,EAAkCG,SAAlC,EAA4CvC,QAA5C,KAAyD;EACtF,IAAIsB,QAAQ,GAAGiB,SAAS,GAAG1D,eAAe,CAAC0D,SAAD,EAAWvC,QAAX,CAA1C;EACA,IAAIlB,KAAK,GAAGuD,cAAc,GAAGD,eAA7B;EACA,IAAIgC,QAAQ,GAAIhC,eAAe,GAAG,MAAnB,GAA6BtD,KAA5C;EACA,IAAIuF,YAAY,GAAI/C,QAAQ,GAAG8C,QAAZ,GAAwB,MAA3C;EACA,OAAOC,YAAP;AACH,CANM;AAQP,OAAO,MAAMX,iBAAiB,GAAG,CAACrB,cAAD,EAAiBD,eAAjB,EAAkCG,SAAlC,KAAgD;EAC7E,IAAIjB,QAAQ,GAAGiB,SAAf;EACA,IAAIzD,KAAK,GAAGuD,cAAc,GAAGD,eAA7B;EACA,IAAIgC,QAAQ,GAAIhC,eAAe,GAAG,MAAnB,GAA6BtD,KAA5C;EACA,IAAIuF,YAAY,GAAI/C,QAAQ,GAAG8C,QAAZ,GAAwB,MAA3C;EACA,OAAOC,YAAP;AACH,CANM,C,CAOP;;AACA,OAAO,MAAMC,iBAAiB,GAAItD,QAAD,IAAc;EAC3C,IAAIiB,QAAQ,GAAGC,cAAc,EAA7B;EACA,IAAIqC,UAAU,GAAG,CAAjB;EACA,IAAIlC,cAAc,GAAG,CAArB;EACA,IAAID,eAAe,GAAG,CAAtB;EACA,IAAIG,SAAS,GAAG,CAAhB;EACA,IAAIvC,QAAQ,GAAC,EAAb;;EACA,QAAQiC,QAAR;IACI;IACA,KAAK,CAAL;IAAQ,KAAK,CAAL;IAAQ,KAAK,CAAL;IAAQ,KAAK,CAAL;MACpBjB,QAAQ,CAACnB,GAAT,CAAaoB,IAAI,IAAI;QACjB,IAAIA,IAAI,CAACmB,eAAL,KAAyB,CAA7B,EAA+B;UAC5B,IAAIc,aAAa,GAACjC,IAAI,CAACoB,cAAL,KAAuB,CAAvB,GAAyBpB,IAAI,CAACoB,cAA9B,GAA8CpB,IAAI,CAACkC,sBAAL,GAA6BlC,IAAI,CAACqB,QAAlG;UACCD,cAAc,IAAIa,aAAlB;QACH,CAHD,MAIK;UACDb,cAAc,IAAIpB,IAAI,CAACxB,KAAvB;QACH;;QACD,IAAGwB,IAAI,CAACmC,aAAL,IAAoB,YAAvB,EAAoC;UAC5B,IAAIoB,OAAO,GAAC3F,eAAe,CAACoC,IAAI,CAACsB,SAAN,EAAgBtB,IAAI,CAACjB,QAArB,CAA3B;UACAoC,eAAe,IAAGqC,mBAAmB,CAACxD,IAAI,CAACsB,SAAL,GAAeiC,OAAhB,EAAyBvD,IAAI,CAACyD,2BAA9B,CAAnB,GAAgFzD,IAAI,CAACqB,QAAvG;UACAiC,UAAU,GAAEnC,eAAZ;QACH,CAJL,MAIU,IAAGnB,IAAI,CAACmC,aAAL,IAAoB,QAAvB,EAAgC;UAClChB,eAAe,IAAInB,IAAI,CAACmB,eAAxB;UACAmC,UAAU,GAAGJ,iBAAiB,CAAC9B,cAAD,EAAiBD,eAAjB,EAAkCG,SAAlC,EAA6CvC,QAA7C,CAA9B;QACP;;QACDuC,SAAS,IAAItB,IAAI,CAACsB,SAAL,GAAiBtB,IAAI,CAACqB,QAAnC;QACAtC,QAAQ,GAACiB,IAAI,CAACjB,QAAd;MACH,CAlBD;MAoBA;IACJ;;IACA,KAAK,CAAL;IAAQ,KAAK,CAAL;MACJgB,QAAQ,CAACnB,GAAT,CAAaoB,IAAI,IAAI;QACjBsD,UAAU,IAAItD,IAAI,CAACmB,eAAnB;MACH,CAFD;MAGA;;IAEJ;MACIpB,QAAQ,CAACnB,GAAT,CAAaoB,IAAI,IAAI;QACjB,IAAIA,IAAI,CAACmB,eAAL,KAAyB,CAA7B,EACIC,cAAc,IAAIpB,IAAI,CAACoB,cAAvB,CADJ,KAEK;UACDA,cAAc,IAAIpB,IAAI,CAACxB,KAAvB;QACH;QACD2C,eAAe,IAAInB,IAAI,CAACmB,eAAxB;QACAG,SAAS,IAAItB,IAAI,CAACsB,SAAL,GAAiBtB,IAAI,CAACqB,QAAnC;MACH,CARD;MASAiC,UAAU,GAAGb,iBAAiB,CAACrB,cAAD,EAAiBD,eAAjB,EAAkCG,SAAlC,CAA9B;MACA;EA1CR;;EA6CA,OAAOgC,UAAP;AACH,CArDM,C,CAsDP;;AACA,OAAO,MAAMrC,cAAc,GAAG,MAAM;EAChC,IAAIyC,UAAU,GAAG1F,YAAY,CAACC,OAAb,CAAqB,aAArB,IAAsCC,IAAI,CAACC,KAAL,CAAWH,YAAY,CAACC,OAAb,CAAqB,aAArB,CAAX,CAAtC,GAAwF,IAAzG;EACA,IAAI8D,YAAY,GAAG,EAAnB;EACA,IAAI4B,kBAAkB,GAAGD,UAAU,GAAGA,UAAU,CAACE,sBAAd,GAAuC,IAA1E;EACA,IAAIC,gBAAgB,GAAGH,UAAU,GAAGA,UAAU,CAACI,oBAAd,GAAqC,MAAtE;EACA,IAAIC,gBAAgB,GAAGL,UAAU,GAAGA,UAAU,CAACM,oBAAd,GAAqC,MAAtE;EACA,IAAIC,qBAAqB,GAAGP,UAAU,GAAGA,UAAU,CAACQ,yBAAd,GAA0C,IAAhF;EACA,IAAIC,QAAQ,GAAG,CAAf;;EAEA,QAAQ,IAAR;IACI;IACA,KAAMR,kBAAkB,IAAI,KAAtB,IAA+BE,gBAAgB,IAAI,MAAnD,IAA6DE,gBAAgB,IAAI,MAAvF;MACII,QAAQ,GAAG,CAAX;MACA;IACJ;;IACA,KAAMR,kBAAkB,IAAI,KAAtB,IAA+BE,gBAAgB,IAAI,MAAnD,IAA6DE,gBAAgB,IAAI,MAAvF;MACII,QAAQ,GAAG,CAAX;MACA;IACJ;;IACA,KAAMR,kBAAkB,IAAI,KAAtB,IAA+BE,gBAAgB,IAAI,MAAnD,IAA6DE,gBAAgB,IAAI,MAAvF;MACII,QAAQ,GAAG,CAAX;MACA;IACJ;;IACA,KAAMR,kBAAkB,IAAI,KAAtB,IAA+BE,gBAAgB,IAAI,MAAnD,IAA6DE,gBAAgB,IAAI,MAAvF;MACII,QAAQ,GAAG,CAAX;MACA;IACJ;;IACA,KAAMR,kBAAkB,IAAI,IAAtB,IAA8BE,gBAAgB,IAAI,MAAlD,IAA4DE,gBAAgB,IAAI,MAAtF;MACII,QAAQ,GAAG,CAAX;MACA;IACJ;;IACA,KAAMR,kBAAkB,IAAI,IAAtB,IAA8BE,gBAAgB,IAAI,MAAlD,IAA4DE,gBAAgB,IAAI,MAAtF;MACII,QAAQ,GAAG,CAAX;MACA;IACJ;;IACA,KAAMR,kBAAkB,IAAI,IAAtB,IAA8BE,gBAAgB,IAAI,MAAlD,IAA4DE,gBAAgB,IAAI,MAAtF;MACII,QAAQ,GAAG,CAAX;MACA;IACJ;;IACA;MACIA,QAAQ,GAAG,CAAX;MACA;EAhCR;;EAkCA,OAAOA,QAAP;AACH,CA5CM;AA8CP,OAAO,MAAMC,aAAa,GAAG,CAACpE,IAAD,EAAOqE,MAAP,KAAkB;EAC3C,IAAIC,YAAY,GAAG,EAAnB;;EACA,IAAItE,IAAJ,EAAU;IAENA,IAAI,IAAIA,IAAI,CAACpB,GAAL,CAAS2F,KAAK,IAAI;MACtB,IAAIA,KAAK,CAACzF,QAAN,IAAkB,IAAtB,EAA4B;QACxBwF,YAAY,CAAC3E,IAAb,CAAkB4E,KAAlB;MACH;IAEJ,CALO,CAAR;;IAMA,IAAID,YAAY,IAAIA,YAAY,CAAC3F,MAAb,GAAsB,CAA1C,EAA6C;MACzCX,YAAY,CAACwG,OAAb,CAAqB,oBAArB,EAA2C,KAA3C;IACH;;IACDxG,YAAY,CAACwG,OAAb,CAAqB,gBAArB,EAAuCtG,IAAI,CAACuG,SAAL,CAAeH,YAAf,CAAvC;EACH;;EACD,IAAIvE,QAAQ,GAAG/B,YAAY,CAACC,OAAb,CAAqB,mBAArB,IAA4CC,IAAI,CAACC,KAAL,CAAWH,YAAY,CAACC,OAAb,CAAqB,mBAArB,CAAX,CAA5C,GAAoG,EAAnH;EACA,IAAIyG,SAAS,GAAGzB,iBAAiB,CAAClD,QAAD,CAAjC;EACA,OAAO2E,SAAP;AACH,CAlBM;AAoBP,OAAO,MAAMrF,WAAW,GAAIsF,GAAD,IAAS;EAChC;EACA,IAAIC,QAAQ,GAAG,CAAf;EACA,OAAOC,MAAM,CAACC,IAAI,CAACC,KAAL,CAAWJ,GAAG,GAAG,GAAN,GAAYC,QAAvB,IAAmC,IAAnC,GAA0CA,QAA3C,CAAb;AACH,CAJM;AAMP;AACA;AACA;AACA;AACA;AACA;AACA;;KAZavF,W;AAab,OAAO,MAAM2F,0BAA0B,GAAG,CAACC,QAAD,EAAWC,YAAX,KAA4B;EAClED,QAAQ,CAACrG,GAAT,CAAauG,IAAI,IAAI;IACjB,IAAIA,IAAI,CAACC,cAAT,EAAyB;MACrB,IAAIC,aAAa,GAAGC,cAAc,CAACH,IAAI,CAACC,cAAN,EAAsBF,YAAtB,CAAlC;MACAC,IAAI,CAAC,gBAAD,CAAJ,GAAyBE,aAAzB;IACH;;IACD,IAAIF,IAAI,CAACI,KAAT,EAAgB;MACZ,IAAIF,aAAa,GAAGC,cAAc,CAACH,IAAI,CAACI,KAAN,EAAaL,YAAb,CAAlC;MACAC,IAAI,CAAC,OAAD,CAAJ,GAAgBE,aAAhB;IACH;EACJ,CATD;EAUA,OAAOJ,QAAP;AACH,CAZM;AAcP;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,OAAO,MAAMK,cAAc,GAAG,CAACL,QAAD,EAAWC,YAAX,KAA4B;EACtDxE,MAAM,CAAC8E,IAAP,CAAYP,QAAZ,EAAsBrG,GAAtB,CAA0B6G,CAAC,IAAI;IAC3B,IAAIC,gBAAgB,GAAGR,YAAY,CAACS,MAAb,CAAoBC,KAAK,IAAKX,QAAQ,CAACQ,CAAD,CAAR,CAAYI,YAAZ,GAA4BD,KAAK,CAACE,IAAN,IAAcb,QAAQ,CAACQ,CAAD,CAAR,CAAYI,YAA1B,IAA0CD,KAAK,CAACG,QAAN,IAAkBd,QAAQ,CAACQ,CAAD,CAAR,CAAYO,UAAxE,IAAsFf,QAAQ,CAACQ,CAAD,CAAR,CAAYpE,QAAZ,GAAuB,CAAzI,GAA+IuE,KAAK,CAACE,IAAN,IAAcb,QAAQ,CAACQ,CAAD,CAAR,CAAYO,UAA3B,IAA0Cf,QAAQ,CAACQ,CAAD,CAAR,CAAYpE,QAAZ,GAAuB,CAA7O,CAAvB;;IACA,IAAIqE,gBAAgB,IAAIA,gBAAgB,CAAC/G,MAAjB,GAA0B,CAAlD,EAAqD;MACjD+G,gBAAgB,CAAC,CAAD,CAAhB,CAAoB,UAApB,IAAkCT,QAAQ,CAACQ,CAAD,CAAR,CAAYpE,QAA9C;MACAqE,gBAAgB,CAAC,CAAD,CAAhB,CAAoB,YAApB,IAAoCT,QAAQ,CAACQ,CAAD,CAAR,CAAYO,UAAhD;MACAN,gBAAgB,CAAC,CAAD,CAAhB,CAAoB,cAApB,IAAsCT,QAAQ,CAACQ,CAAD,CAAR,CAAYI,YAAZ,GAA2BZ,QAAQ,CAACQ,CAAD,CAAR,CAAYI,YAAvC,GAAsD,CAA5F;MACAH,gBAAgB,CAAC,CAAD,CAAhB,CAAoB,iBAApB,IAAyCT,QAAQ,CAACQ,CAAD,CAAR,CAAYtC,QAAZ,GAAuB8B,QAAQ,CAACQ,CAAD,CAAR,CAAYtC,QAAnC,GAA8C,CAAvF;MACAuC,gBAAgB,CAAC,CAAD,CAAhB,CAAoB,gBAApB,IAAwCT,QAAQ,CAACQ,CAAD,CAAR,CAAYtC,QAAZ,GAAuB1E,UAAU,CAACiH,gBAAgB,CAAC,CAAD,CAAhB,CAAoBlH,KAApB,GAA4BqG,MAAM,CAACI,QAAQ,CAACQ,CAAD,CAAR,CAAYpE,QAAb,CAAnC,CAAV,GAAuE5C,UAAU,CAACwG,QAAQ,CAACQ,CAAD,CAAR,CAAYtC,QAAb,CAAxG,GAAiI,CAAzK;MAEA,IAAI8C,WAAW,GAAGnD,gBAAgB,CAAC4C,gBAAD,CAAlC;MACA,IAAI3F,QAAQ,GAAGkD,iBAAiB,CAACgD,WAAD,CAAhC;MACA,IAAIC,eAAe,GAAG3F,eAAe,CAACR,QAAD,CAArC;;MACA,IAAIA,QAAQ,IAAIA,QAAQ,CAACpB,MAAT,GAAkB,CAAlC,EAAqC;QACjCsG,QAAQ,CAACQ,CAAD,CAAR,CAAY,eAAZ,IAA+B1F,QAAQ,CAAC,CAAD,CAAR,CAAYM,QAA3C;QACA4E,QAAQ,CAACQ,CAAD,CAAR,CAAY,YAAZ,IAA4B1F,QAAQ,CAAC,CAAD,CAAR,CAAYI,KAAxC;QACA8E,QAAQ,CAACQ,CAAD,CAAR,CAAY,UAAZ,IAA0B1F,QAAQ,CAAC,CAAD,CAAR,CAAYU,SAAtC;QACAwE,QAAQ,CAACQ,CAAD,CAAR,CAAY,mBAAZ,IAAmC1F,QAAQ,CAAC,CAAD,CAAR,CAAYc,YAA/C;MACH;IACJ;EACJ,CAnBD,EADsD,CAqBtD;;EACA,OAAOoE,QAAP;AACH,CAvBM;AAwBP;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAO,MAAMkB,iBAAiB,GAAG,CAACC,IAAD,EAAOC,mBAAP,KAA+B;EAC5D,IAAIC,eAAe,GAAIF,IAAI,IAAI,kBAAT,GAA+BpI,YAAY,CAACC,OAAb,CAAqB,iBAArB,IAA0CC,IAAI,CAACC,KAAL,CAAWH,YAAY,CAACC,OAAb,CAAqB,iBAArB,CAAX,CAA1C,GAAgG,IAA/H,GAAsImI,IAA5J,CAD4D,CAE5D;EACA;;EACA,IAAIG,qBAAqB,GAAGvI,YAAY,CAACC,OAAb,CAAqB,mBAArB,IAA4CC,IAAI,CAACC,KAAL,CAAWH,YAAY,CAACC,OAAb,CAAqB,mBAArB,CAAX,CAA5C,GAAoG,IAAhI;EACA,IAAIuI,kBAAkB,GAAG,EAAzB;EACA,IAAIC,iBAAiB,GAAG,EAAxB;;EACA,IAAIJ,mBAAmB,IAAIA,mBAAmB,CAAC1H,MAApB,GAA6B,CAAxD,EAA2D;IACvD0H,mBAAmB,CAACzH,GAApB,CAAwB8H,KAAK,IAAI;MAC7B,IAAIA,KAAK,CAACC,gBAAN,IAA0BD,KAAK,CAACC,gBAAN,CAAuBhI,MAAvB,GAAgC,CAA9D,EAAiE;QAC7D+H,KAAK,CAACC,gBAAN,CAAuB/H,GAAvB,CAA2BgI,QAAQ,IAAI;UACnCH,iBAAiB,CAAC9G,IAAlB,CAAuBiH,QAAvB;QACH,CAFD;MAGH;IACJ,CAND;EAOH;;EACD,IAAIN,eAAe,IAAIA,eAAe,CAAC3H,MAAhB,GAAyB,CAAhD,EAAmD;IAC/C2H,eAAe,CAAC1H,GAAhB,CAAoBoB,IAAI,IAAI;MACxB,IAAIA,IAAI,CAAC6G,WAAL,IAAoB7G,IAAI,CAAC6G,WAAL,CAAiBlI,MAAjB,GAA0B,CAAlD,EAAqD;QACjDqB,IAAI,CAAC6G,WAAL,CAAiBjI,GAAjB,CAAqBkI,OAAO,IAAI;UAC5BL,iBAAiB,CAAC9G,IAAlB,CAAuBmH,OAAvB;QACH,CAFD;MAGH;;MACD,IAAIV,IAAI,KAAK,kBAAb,EAAiC;QAC7B,IAAIlG,KAAK,GAAGF,IAAI,CAACE,KAAL,CAAW6G,OAAX,CAAmB,WAAnB,EAAgC,EAAhC,CAAZ;QACA,MAAMC,OAAO,GAAG9I,IAAI,CAACC,KAAL,CAAW+B,KAAX,CAAhB;;QACA,IAAI8G,OAAJ,EAAa;UACT,KAAK,IAAI,CAACC,GAAD,EAAMC,KAAN,CAAT,IAAyBxG,MAAM,CAACC,OAAP,CAAeqG,OAAO,CAAC7G,KAAvB,CAAzB,EAAwD;YACpDsG,iBAAiB,CAAC9G,IAAlB,CAAuB;cAAE,CAACsH,GAAD,GAAOC;YAAT,CAAvB;UACH;QACJ;MACJ;IACJ,CAfD;EAgBH;;EACD,IAAIT,iBAAiB,IAAIA,iBAAiB,CAAC9H,MAAlB,GAA2B,CAApD,EAAuD;IACnD,KAAK,IAAI8G,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGgB,iBAAiB,CAAC9H,MAAtC,EAA8C8G,CAAC,EAA/C,EAAmD;MAC/C,KAAK,IAAIwB,GAAT,IAAgBR,iBAAiB,CAAChB,CAAD,CAAjC,EAAsC;QAClC,IAAI0B,yBAAyB,GAAGZ,qBAAqB,IAAIA,qBAAqB,CAACZ,MAAtB,CAA6ByB,KAAK,IAAKA,KAAK,CAAC3H,KAAN,IAAewH,GAAtD,CAAzD;;QACA,IAAIE,yBAAyB,IAAIA,yBAAyB,CAACxI,MAA1B,GAAmC,CAApE,EAAuE;UACnE,IAAI0I,MAAM,GAAGF,yBAAyB,CAAC,CAAD,CAAzB,CAA6B1H,KAA1C;UACA,IAAI6H,QAAQ,GAAGH,yBAAyB,CAAC,CAAD,CAAzB,CAA6BI,OAA5C;UACA,IAAIC,WAAW,GAAGL,yBAAyB,CAAC,CAAD,CAAzB,CAA6B5I,OAA/C;UACA,IAAIkJ,UAAU,GAAGhJ,UAAU,CAACgI,iBAAiB,CAAChB,CAAD,CAAjB,CAAqBwB,GAArB,CAAD,CAA3B;UACA,IAAIS,WAAW,GAAGlB,kBAAkB,IAAIA,kBAAkB,CAACmB,IAAnB,CAAwBC,MAAM,IAAKA,MAAM,CAACP,MAAP,IAAiBA,MAApD,CAAxC;;UACA,IAAIK,WAAJ,EAAiB;YACblB,kBAAkB,CAAC5H,GAAnB,CAAuBoB,IAAI,IAAI;cAC3B,IAAIA,IAAI,CAACqH,MAAL,IAAeA,MAAnB,EAA2B;gBACvBrH,IAAI,CAAC,YAAD,CAAJ,IAAsByH,UAAtB;cAEH;YACJ,CALD;UAMH;;UACD,IAAI,CAACC,WAAL,EAAkB;YACdlB,kBAAkB,CAAC7G,IAAnB,CAAwB;cAAE,UAAU0H,MAAZ;cAAoB,YAAYC,QAAhC;cAA0C,cAAcG,UAAxD;cAAmE,WAAUD;YAA7E,CAAxB;UACH;QACJ;MACJ;IACJ,CAvBkD,CAwBnD;;EACH;;EACD,OAAOhB,kBAAP;AACH,CA7DM;;AA+DP,SAAShD,mBAAT,CAA6B3F,KAA7B,EAAoCsF,QAApC,EAA8C;EAC1C,IAAI0E,cAAc,GAAIhK,KAAK,GAAGsF,QAAT,GAAqB,MAA1C;EACA,OAAO0E,cAAP;AACH;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEA,OAAO,MAAMC,uBAAuB,GAAG,CAAC9H,IAAD,EAAO+H,GAAP,KAAe;EAClD;EAEA,IAAI/H,IAAI,CAACqC,SAAL,IAAgB,KAApB,EAA0B;IACtB,OAAOrC,IAAP;EACH;;EACD,IAAIgB,QAAQ,GAAGC,cAAc,EAA7B,CANkD,CAOlD;;EACA,IAAIc,YAAY,GAAG,EAAnB;EACA,IAAIlE,KAAK,GAAG,CAAZ;EACA,IAAIgE,QAAQ,GAAG,CAAf;EACA,IAAIC,QAAQ,GAAG,CAAf;EACA,IAAIX,eAAe,GAAGnB,IAAI,CAACgI,uBAAL,GAA+BvJ,UAAU,CAACuB,IAAI,CAACgI,uBAAN,CAAzC,GAA0E,CAAhG;EACA,IAAIC,oBAAoB,GAAG,CAA3B;;EACA,QAAQjH,QAAR;IACI;IACA,KAAK,CAAL;MACI,IAAIhB,IAAI,CAAC8F,IAAL,IAAa9F,IAAI,CAAC4B,SAAL,KAAmB,MAApC,EAA4C;QACxC;QACAC,QAAQ,GAAGjE,eAAe,CAACoC,IAAI,CAACsB,SAAN,EAAiBtB,IAAI,CAACjB,QAAtB,CAA1B;;QACA,IAAGiB,IAAI,CAACmC,aAAL,IAAsB,YAAzB,EAAuC;UACrC,IAAK+F,eAAe,GAAC1E,mBAAmB,CAACxD,IAAI,CAACsB,SAAL,GAAeO,QAAhB,EAA0B7B,IAAI,CAACyD,2BAA/B,CAAnB,GAAgFsE,GAArG;UACAE,oBAAoB,GAAK,CAACjI,IAAI,CAACsB,SAAL,GAAeO,QAAhB,IAA4BkG,GAA7B,GAAoCG,eAA5D;QACD,CAHD,MAGO;UACHD,oBAAoB,GAAK,CAACjI,IAAI,CAACsB,SAAL,GAAeO,QAAhB,IAA4BkG,GAA7B,GAAoC5G,eAA5D;QACH;;QACD,IAAGnB,IAAI,CAACmC,aAAL,IAAsB,YAAzB,EAAuC;UACnCN,QAAQ,GAAGjE,eAAe,CAACoC,IAAI,CAACsB,SAAL,GAAeH,eAAhB,EAAiCnB,IAAI,CAACjB,QAAtC,CAA1B;QACH,CAFD,MAEK;UACD8C,QAAQ,GAAGjE,eAAe,CAAEoC,IAAI,CAACsB,SAAL,GAAiByG,GAAlB,GAAwB5G,eAAzB,EAA0CnB,IAAI,CAACjB,QAA/C,CAA1B;QACH,CAbuC,CAexC;QACA;;;QACAiB,IAAI,CAAC,UAAD,CAAJ,GAAmBA,IAAI,CAACmC,aAAL,IAAsB,YAAtB,GAAqCN,QAAQ,GAAGkG,GAAhD,GAAsDlG,QAAzE,CAjBwC,CAkBxC;QACA;QAEA;;QACA7B,IAAI,CAAC,gBAAD,CAAJ,GAAyBiI,oBAAzB;MACH;;MACDlG,YAAY,GAAG/B,IAAf;MACA;IACJ;;IACA,KAAK,CAAL;MACI,IAAIA,IAAI,CAAC8F,IAAL,IAAa9F,IAAI,CAAC4B,SAAL,KAAmB,MAApC,EAA4C;QACxC;QACA,IAAG5B,IAAI,CAACmC,aAAL,IAAsB,YAAzB,EAAuC;UACnC,IAAK+F,eAAe,GAAC1E,mBAAmB,CAACxD,IAAI,CAACsB,SAAL,GAAeO,QAAhB,EAA0B7B,IAAI,CAACyD,2BAA/B,CAAnB,GAAgFsE,GAArG;UACAE,oBAAoB,GAAK,CAACjI,IAAI,CAACsB,SAAL,GAAeO,QAAhB,IAA4BkG,GAA7B,GAAoCG,eAA5D;QACD,CAHH,MAGS;UACHD,oBAAoB,GAAK,CAACjI,IAAI,CAACsB,SAAL,GAAeO,QAAhB,IAA4BkG,GAA7B,GAAoC5G,eAA5D;QACH;;QACD,IAAGnB,IAAI,CAACmC,aAAL,IAAsB,YAAzB,EAAuC;UACrCL,QAAQ,GAAGlE,eAAe,CAACoC,IAAI,CAACsB,SAAL,GAAeH,eAAhB,EAAiCnB,IAAI,CAACjB,QAAtC,CAA1B;QACC,CAFH,MAEO;UACD+C,QAAQ,GAAGlE,eAAe,CAAEoC,IAAI,CAACsB,SAAL,GAAiByG,GAAlB,GAAwB5G,eAAzB,EAA0CnB,IAAI,CAACjB,QAA/C,CAA1B;QACH;;QAEHlB,KAAK,GAAGmF,gBAAgB,CAACiF,oBAAD,EAAuB,CAAvB,EAA0BjI,IAAI,CAACjB,QAA/B,CAAxB,CAdsC,CAexC;;QACAiB,IAAI,CAAC,UAAD,CAAJ,GAAmBA,IAAI,CAACmC,aAAL,IAAsB,YAAtB,GAAqCL,QAAQ,GAAGiG,GAAhD,GAAsDjG,QAAzE;QACA9B,IAAI,CAAC,gBAAD,CAAJ,GAAyBiI,oBAAzB;MACH;;MACDlG,YAAY,GAAG/B,IAAf;MACA;IACJ;;IACA,KAAK,CAAL;MACI,IAAIA,IAAI,CAAC8F,IAAL,IAAa9F,IAAI,CAAC4B,SAAL,KAAmB,MAApC,EAA4C;QACxC;QACA,IAAG5B,IAAI,CAACmC,aAAL,IAAsB,YAAzB,EAAuC;UACnC,IAAK+F,eAAe,GAAC1E,mBAAmB,CAACxD,IAAI,CAACsB,SAAL,GAAeO,QAAhB,EAA0B7B,IAAI,CAACyD,2BAA/B,CAAnB,GAAgFsE,GAArG;UACAE,oBAAoB,GAAK,CAACjI,IAAI,CAACsB,SAAL,GAAeO,QAAhB,IAA4BkG,GAA7B,GAAoCG,eAA5D;QACD,CAHH,MAGS;UACLD,oBAAoB,GAAGjI,IAAI,CAACmC,aAAL,IAAsB,YAAtB,GAAqCnC,IAAI,CAACsB,SAAL,GAAiBH,eAAtD,GAAyEnB,IAAI,CAACsB,SAAL,GAAiByG,GAAlB,GAAyB5G,eAAxH;QACD;;QACD,IAAGnB,IAAI,CAACmC,aAAL,IAAsB,YAAzB,EAAuC;UACrCN,QAAQ,GAAGjE,eAAe,CAACoC,IAAI,CAACsB,SAAL,GAAeH,eAAhB,EAAiCnB,IAAI,CAACjB,QAAtC,CAA1B;QACC,CAFH,MAEO;UACD8C,QAAQ,GAAGjE,eAAe,CAAEoC,IAAI,CAACsB,SAAL,GAAiByG,GAAlB,GAAwB5G,eAAzB,EAA0CnB,IAAI,CAACjB,QAA/C,CAA1B;QACH,CAZmC,CAcxC;;;QACAiB,IAAI,CAAC,UAAD,CAAJ,GAAmBA,IAAI,CAACmC,aAAL,IAAsB,YAAtB,GAAqCN,QAAQ,GAAGkG,GAAhD,GAAsDlG,QAAzE;QACA7B,IAAI,CAAC,gBAAD,CAAJ,GAAyBiI,oBAAzB;MACH;;MACDlG,YAAY,GAAG/B,IAAf;MACA;IACJ;;IACA,KAAK,CAAL;MACI,IAAIA,IAAI,CAAC8F,IAAL,IAAa9F,IAAI,CAAC4B,SAAL,KAAmB,MAApC,EAA4C;QACxC;QACA,IAAG5B,IAAI,CAACmC,aAAL,IAAsB,YAAzB,EAAuC;UACnC,IAAK+F,eAAe,GAAC1E,mBAAmB,CAACxD,IAAI,CAACsB,SAAL,GAAeO,QAAhB,EAA0B7B,IAAI,CAACyD,2BAA/B,CAAnB,GAAgFsE,GAArG;UACAE,oBAAoB,GAAK,CAACjI,IAAI,CAACsB,SAAL,GAAeO,QAAhB,IAA4BkG,GAA7B,GAAoCG,eAA5D;QACD,CAHH,MAGS;UACLD,oBAAoB,GAAGjI,IAAI,CAACmC,aAAL,IAAsB,YAAtB,GAAqCnC,IAAI,CAACsB,SAAL,GAAiBH,eAAtD,GAAyEnB,IAAI,CAACsB,SAAL,GAAiByG,GAAlB,GAAyB5G,eAAxH;QACD;;QACD,IAAGnB,IAAI,CAACmC,aAAL,IAAsB,YAAzB,EAAuC;UACrCL,QAAQ,GAAGlE,eAAe,CAACoC,IAAI,CAACsB,SAAL,GAAeH,eAAhB,EAAiCnB,IAAI,CAACjB,QAAtC,CAA1B;QACC,CAFH,MAEO;UACD+C,QAAQ,GAAGlE,eAAe,CAAEoC,IAAI,CAACsB,SAAL,GAAiByG,GAAlB,GAAwB5G,eAAzB,EAA0CnB,IAAI,CAACjB,QAA/C,CAA1B;QACH;;QACLlB,KAAK,GAAGmF,gBAAgB,CAACiF,oBAAD,EAAuB,CAAvB,EAA0BjI,IAAI,CAACjB,QAA/B,CAAxB,CAbwC,CAcxC;;QACAiB,IAAI,CAAC,UAAD,CAAJ,GAAmBA,IAAI,CAACmC,aAAL,IAAsB,YAAtB,GAAqCL,QAAQ,GAAGiG,GAAhD,GAAsDjG,QAAzE;QAAkF;QAClF9B,IAAI,CAAC,gBAAD,CAAJ,GAAyBiI,oBAAzB;MACH;;MACDlG,YAAY,GAAG/B,IAAf;MACA;IACJ;;IACA,KAAK,CAAL;MACI,IAAIA,IAAI,CAAC8F,IAAL,IAAa9F,IAAI,CAAC4B,SAAL,KAAmB,MAApC,EAA4C;QACxC;QACA,IAAG5B,IAAI,CAACmC,aAAL,IAAsB,YAAzB,EAAuC;UACnC,IAAK+F,eAAe,GAAC1E,mBAAmB,CAACxD,IAAI,CAACsB,SAAL,GAAeO,QAAhB,EAA0B7B,IAAI,CAACyD,2BAA/B,CAAnB,GAAgFsE,GAArG;UACAE,oBAAoB,GAAK,CAACjI,IAAI,CAACsB,SAAL,GAAeO,QAAhB,IAA4BkG,GAA7B,GAAoCG,eAA5D;QACD,CAHH,MAGS;UACLD,oBAAoB,GAAGjI,IAAI,CAACmC,aAAL,IAAsB,YAAtB,GAAqCnC,IAAI,CAACsB,SAAL,GAAiBH,eAAtD,GAAyEnB,IAAI,CAACsB,SAAL,GAAiByG,GAAlB,GAAyB5G,eAAxH;QACD;;QACD,IAAGnB,IAAI,CAACmC,aAAL,IAAsB,YAAzB,EAAuC;UACrCN,QAAQ,GAAGzC,eAAe,CAACY,IAAI,CAACsB,SAAL,GAAeH,eAAhB,EAAiCnB,IAAI,CAACjB,QAAtC,CAA1B;QACC,CAFH,MAEO;UACD8C,QAAQ,GAAGzC,eAAe,CAAEY,IAAI,CAACsB,SAAL,GAAiByG,GAAlB,GAAwB5G,eAAzB,EAA0CnB,IAAI,CAACjB,QAA/C,CAA1B;QACH,CAZmC,CAcxC;;;QACAiB,IAAI,CAAC,UAAD,CAAJ,GAAmBA,IAAI,CAACmC,aAAL,IAAsB,YAAtB,GAAqCN,QAAQ,GAAGkG,GAAhD,GAAsDlG,QAAzE;QACA7B,IAAI,CAAC,gBAAD,CAAJ,GAAyBiI,oBAAzB;MACH;;MACDlG,YAAY,GAAG/B,IAAf;MACA;IACJ;;IACA,KAAK,CAAL;MACI,IAAIA,IAAI,CAAC8F,IAAL,IAAa9F,IAAI,CAAC4B,SAAL,KAAmB,MAApC,EAA4C;QACxC;QACA,IAAG5B,IAAI,CAACmC,aAAL,IAAsB,YAAzB,EAAuC;UACnC,IAAK+F,eAAe,GAAC1E,mBAAmB,CAACxD,IAAI,CAACsB,SAAL,GAAeO,QAAhB,EAA0B7B,IAAI,CAACyD,2BAA/B,CAAnB,GAAgFsE,GAArG;UACAE,oBAAoB,GAAK,CAACjI,IAAI,CAACsB,SAAL,GAAeO,QAAhB,IAA4BkG,GAA7B,GAAoCG,eAA5D;QACD,CAHH,MAGS;UACLD,oBAAoB,GAAGjI,IAAI,CAACmC,aAAL,IAAsB,YAAtB,GAAqCnC,IAAI,CAACsB,SAAL,GAAiBH,eAAtD,GAAyEnB,IAAI,CAACsB,SAAL,GAAiByG,GAAlB,GAAyB5G,eAAxH;QACD;;QAED,IAAGnB,IAAI,CAACmC,aAAL,IAAsB,YAAzB,EAAuC;UACrCL,QAAQ,GAAG1C,eAAe,CAACY,IAAI,CAACsB,SAAL,GAAeH,eAAhB,EAAiCnB,IAAI,CAACjB,QAAtC,CAA1B;QACH,CAFC,MAEG;UACH+C,QAAQ,GAAG1C,eAAe,CAAC6I,oBAAD,EAAuBjI,IAAI,CAACjB,QAA5B,CAA1B;QACD,CAbuC,CAcxC;;;QACAiB,IAAI,CAAC,UAAD,CAAJ,GAAmBA,IAAI,CAACmC,aAAL,IAAsB,YAAtB,GAAqCL,QAAQ,GAAGiG,GAAhD,GAAsDjG,QAAzE;QAAkF;QAClF9B,IAAI,CAAC,gBAAD,CAAJ,GAAyBiI,oBAAzB;MACH;;MACDlG,YAAY,GAAG/B,IAAf;MACA;IACJ;;IACA,KAAK,CAAL;MACI,IAAIA,IAAI,CAAC8F,IAAL,IAAa9F,IAAI,CAAC4B,SAAL,KAAmB,MAApC,EAA4C;QACxC;QACA,IAAG5B,IAAI,CAACmC,aAAL,IAAsB,YAAzB,EAAuC;UACnC,IAAK+F,eAAe,GAAC1E,mBAAmB,CAACxD,IAAI,CAACsB,SAAL,GAAeO,QAAhB,EAA0B7B,IAAI,CAACyD,2BAA/B,CAAnB,GAAgFsE,GAArG;UACAE,oBAAoB,GAAK,CAACjI,IAAI,CAACsB,SAAL,GAAeO,QAAhB,IAA4BkG,GAA7B,GAAoCG,eAA5D;QACD,CAHH,MAGS;UACLD,oBAAoB,GAAGjI,IAAI,CAACmC,aAAL,IAAsB,YAAtB,GAAqCnC,IAAI,CAACsB,SAAL,GAAiBH,eAAtD,GAAyEnB,IAAI,CAACsB,SAAL,GAAiByG,GAAlB,GAAyB5G,eAAxH;QACD;;QACHtD,KAAK,GAAGmF,gBAAgB,CAACiF,oBAAD,EAAuB,CAAvB,EAA0BjI,IAAI,CAACjB,QAA/B,CAAxB;;QACA,IAAGiB,IAAI,CAACmC,aAAL,IAAsB,YAAzB,EAAuC;UACnCN,QAAQ,GAAGzC,eAAe,CAACY,IAAI,CAACsB,SAAL,GAAeH,eAAhB,EAAiCnB,IAAI,CAACjB,QAAtC,CAA1B;QACH,CAFD,MAEK;UACD8C,QAAQ,GAAGzC,eAAe,CAAC6I,oBAAD,EAAuBjI,IAAI,CAACjB,QAA5B,CAA1B;QACH,CAbuC,CAcxC;;;QACAiB,IAAI,CAAC,UAAD,CAAJ,GAAmBA,IAAI,CAACmC,aAAL,IAAsB,YAAtB,GAAqCN,QAAQ,GAAGkG,GAAhD,GAAsDlG,QAAzE;QACA7B,IAAI,CAAC,gBAAD,CAAJ,GAAyBiI,oBAAzB;MACH;;MACDlG,YAAY,GAAG/B,IAAf;MACA;IACJ;;IACA;MACI,IAAIA,IAAI,CAAC8F,IAAL,IAAa9F,IAAI,CAAC4B,SAAL,KAAmB,MAApC,EAA4C;QACxC,IAAG5B,IAAI,CAACmC,aAAL,IAAsB,YAAzB,EAAuC;UACnC,IAAK+F,eAAe,GAAC1E,mBAAmB,CAACxD,IAAI,CAACsB,SAAL,GAAeO,QAAhB,EAA0B7B,IAAI,CAACyD,2BAA/B,CAAnB,GAAgFsE,GAArG;UACAE,oBAAoB,GAAK,CAACjI,IAAI,CAACsB,SAAL,GAAeO,QAAhB,IAA4BkG,GAA7B,GAAoCG,eAA5D;QACD,CAHH,MAGS;UACTD,oBAAoB,GAAGjI,IAAI,CAACmC,aAAL,IAAsB,YAAtB,GAAqCnC,IAAI,CAACsB,SAAL,GAAiBH,eAAtD,GAAyEnB,IAAI,CAACsB,SAAL,GAAiByG,GAAlB,GAAyB5G,eAAxH;QACG;;QACD,IAAGnB,IAAI,CAACmC,aAAL,IAAsB,YAAzB,EAAuC;UACrCL,QAAQ,GAAG1C,eAAe,CAACY,IAAI,CAACsB,SAAL,GAAeH,eAAhB,EAAiCnB,IAAI,CAACjB,QAAtC,CAA1B;QACH,CAFC,MAEG;UACD+C,QAAQ,GAAG1C,eAAe,CAAC6I,oBAAD,EAAuBjI,IAAI,CAACjB,QAA5B,CAA1B;QACH,CAXuC,CAYxC;;;QACAiB,IAAI,CAAC,UAAD,CAAJ,GAAmBA,IAAI,CAACmC,aAAL,IAAsB,YAAtB,GAAqCL,QAAQ,GAAGiG,GAAhD,GAAsDjG,QAAzE;QACA9B,IAAI,CAAC,gBAAD,CAAJ,GAAyBiI,oBAAzB;MACH;;MACDlG,YAAY,GAAG/B,IAAf;MACA;EArLR;;EAuLA,OAAO+B,YAAP;AACH,CAtMM;AAwMP,OAAO,MAAM2B,UAAU,GAAG;EACtBZ,gBADsB;EACJJ,mBADI;EACiBO,iBADjB;EACoCD,gBADpC;EACsDpF,eADtD;EACuEwB,eADvE;EACwFmB,eADxF;EACyG8C,iBADzG;EAC4HpC,cAD5H;EAC4I2B,SAD5I;EACuJwB,aADvJ;EACsKrD,wBADtK;EACgMjB,yBADhM;EAC2NT,WAD3N;EAEtB2F,0BAFsB;EAEMmB;AAFN,CAAnB;AAIP,eAAezC,UAAf"},"metadata":{},"sourceType":"module"}